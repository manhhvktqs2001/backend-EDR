2025-06-19 19:46:02,198 - __main__ - INFO - üöÄ EDR Agent Communication Server - Startup Initiated
2025-06-19 19:46:02,215 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 19:46:02,215 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 19:46:04,603 - app.database - INFO - üîó Initializing database connection to: MANH/EDR_System
2025-06-19 19:46:04,713 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-19 19:46:04,714 - __main__ - INFO - üóÑÔ∏è Testing database connection...
2025-06-19 19:46:04,714 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-19 19:46:04,881 - sqlalchemy.engine.Engine - INFO - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-19 19:46:04,881 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-19 19:46:04,883 - sqlalchemy.engine.Engine - INFO - SELECT schema_name()
2025-06-19 19:46:04,884 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ()
2025-06-19 19:46:04,906 - sqlalchemy.engine.Engine - INFO - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-19 19:46:04,906 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ()
2025-06-19 19:46:04,910 - sqlalchemy.engine.Engine - INFO - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-19 19:46:04,910 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2025-06-19 19:46:05,215 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,215 - sqlalchemy.engine.Engine - INFO - SELECT 1 as test, GETDATE() as server_time
2025-06-19 19:46:05,216 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ()
2025-06-19 19:46:05,217 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 19:46:05,217 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:46:05,219 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,219 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,219 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ()
2025-06-19 19:46:05,220 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name
                
2025-06-19 19:46:05,221 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ()
2025-06-19 19:46:05,231 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,232 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,232 - sqlalchemy.engine.Engine - INFO - [cached since 0.01343s ago] ()
2025-06-19 19:46:05,233 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,233 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ('Agents', 'dbo')
2025-06-19 19:46:05,254 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,256 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,257 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,257 - sqlalchemy.engine.Engine - INFO - [cached since 0.03827s ago] ()
2025-06-19 19:46:05,258 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:46:05,259 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ()
2025-06-19 19:46:05,284 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,286 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,286 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,286 - sqlalchemy.engine.Engine - INFO - [cached since 0.06757s ago] ()
2025-06-19 19:46:05,287 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,288 - sqlalchemy.engine.Engine - INFO - [cached since 0.05458s ago] ('Events', 'dbo')
2025-06-19 19:46:05,301 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,303 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,303 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,303 - sqlalchemy.engine.Engine - INFO - [cached since 0.08447s ago] ()
2025-06-19 19:46:05,304 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:46:05,304 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-06-19 19:46:05,321 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,325 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,326 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,327 - sqlalchemy.engine.Engine - INFO - [cached since 0.1083s ago] ()
2025-06-19 19:46:05,330 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,331 - sqlalchemy.engine.Engine - INFO - [cached since 0.09748s ago] ('Alerts', 'dbo')
2025-06-19 19:46:05,332 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,334 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,335 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,335 - sqlalchemy.engine.Engine - INFO - [cached since 0.1164s ago] ()
2025-06-19 19:46:05,336 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:46:05,337 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] ()
2025-06-19 19:46:05,341 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,342 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,343 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,343 - sqlalchemy.engine.Engine - INFO - [cached since 0.1241s ago] ()
2025-06-19 19:46:05,344 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,344 - sqlalchemy.engine.Engine - INFO - [cached since 0.1112s ago] ('Threats', 'dbo')
2025-06-19 19:46:05,355 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,356 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,357 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,357 - sqlalchemy.engine.Engine - INFO - [cached since 0.1381s ago] ()
2025-06-19 19:46:05,358 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:46:05,358 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ()
2025-06-19 19:46:05,361 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,362 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,363 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,363 - sqlalchemy.engine.Engine - INFO - [cached since 0.1445s ago] ()
2025-06-19 19:46:05,364 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,365 - sqlalchemy.engine.Engine - INFO - [cached since 0.1315s ago] ('DetectionRules', 'dbo')
2025-06-19 19:46:05,375 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,377 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,378 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,378 - sqlalchemy.engine.Engine - INFO - [cached since 0.159s ago] ()
2025-06-19 19:46:05,379 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:46:05,379 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2025-06-19 19:46:05,382 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,383 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,384 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,384 - sqlalchemy.engine.Engine - INFO - [cached since 0.1652s ago] ()
2025-06-19 19:46:05,385 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,386 - sqlalchemy.engine.Engine - INFO - [cached since 0.1524s ago] ('SystemConfig', 'dbo')
2025-06-19 19:46:05,398 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,399 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,399 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,400 - sqlalchemy.engine.Engine - INFO - [cached since 0.1809s ago] ()
2025-06-19 19:46:05,400 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:46:05,401 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-06-19 19:46:05,403 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,404 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,405 - sqlalchemy.engine.Engine - INFO - [cached since 0.1858s ago] ()
2025-06-19 19:46:05,406 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,406 - sqlalchemy.engine.Engine - INFO - [cached since 0.1729s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:46:05,407 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,408 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,409 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,409 - sqlalchemy.engine.Engine - INFO - [cached since 0.1899s ago] ()
2025-06-19 19:46:05,410 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:46:05,410 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-06-19 19:46:05,412 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,413 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 19:46:05,413 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ()
2025-06-19 19:46:05,428 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,429 - app.database - INFO - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-19 19:46:05,429 - app.database - INFO - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-19 19:46:05,430 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,430 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,430 - sqlalchemy.engine.Engine - INFO - [cached since 0.2116s ago] ()
2025-06-19 19:46:05,431 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,432 - sqlalchemy.engine.Engine - INFO - [cached since 0.1985s ago] ('Agents', 'dbo')
2025-06-19 19:46:05,449 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,450 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,451 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,451 - sqlalchemy.engine.Engine - INFO - [cached since 0.232s ago] ()
2025-06-19 19:46:05,451 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,452 - sqlalchemy.engine.Engine - INFO - [cached since 0.2187s ago] ('Events', 'dbo')
2025-06-19 19:46:05,452 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,453 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,454 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,454 - sqlalchemy.engine.Engine - INFO - [cached since 0.2349s ago] ()
2025-06-19 19:46:05,454 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,455 - sqlalchemy.engine.Engine - INFO - [cached since 0.2217s ago] ('Alerts', 'dbo')
2025-06-19 19:46:05,456 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,457 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,458 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,458 - sqlalchemy.engine.Engine - INFO - [cached since 0.2392s ago] ()
2025-06-19 19:46:05,459 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,459 - sqlalchemy.engine.Engine - INFO - [cached since 0.2264s ago] ('Threats', 'dbo')
2025-06-19 19:46:05,476 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,477 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,477 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,478 - sqlalchemy.engine.Engine - INFO - [cached since 0.2587s ago] ()
2025-06-19 19:46:05,478 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,479 - sqlalchemy.engine.Engine - INFO - [cached since 0.2456s ago] ('DetectionRules', 'dbo')
2025-06-19 19:46:05,490 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,491 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,492 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,492 - sqlalchemy.engine.Engine - INFO - [cached since 0.2731s ago] ()
2025-06-19 19:46:05,493 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,493 - sqlalchemy.engine.Engine - INFO - [cached since 0.26s ago] ('SystemConfig', 'dbo')
2025-06-19 19:46:05,507 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,508 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,509 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,509 - sqlalchemy.engine.Engine - INFO - [cached since 0.2901s ago] ()
2025-06-19 19:46:05,510 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,510 - sqlalchemy.engine.Engine - INFO - [cached since 0.2771s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:46:05,511 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,511 - app.database - INFO - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-19 19:46:05,512 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,512 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,513 - sqlalchemy.engine.Engine - INFO - [cached since 0.2938s ago] ()
2025-06-19 19:46:05,513 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:46:05,514 - sqlalchemy.engine.Engine - INFO - [cached since 0.2555s ago] ()
2025-06-19 19:46:05,516 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,517 - app.database - INFO - üìä Agents: 0 records
2025-06-19 19:46:05,518 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,518 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,518 - sqlalchemy.engine.Engine - INFO - [cached since 0.2996s ago] ()
2025-06-19 19:46:05,519 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:46:05,519 - sqlalchemy.engine.Engine - INFO - [cached since 0.2153s ago] ()
2025-06-19 19:46:05,525 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,526 - app.database - INFO - üìä Events: 0 records
2025-06-19 19:46:05,527 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,527 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,527 - sqlalchemy.engine.Engine - INFO - [cached since 0.3082s ago] ()
2025-06-19 19:46:05,528 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:46:05,528 - sqlalchemy.engine.Engine - INFO - [cached since 0.1916s ago] ()
2025-06-19 19:46:05,531 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,531 - app.database - INFO - üìä Alerts: 0 records
2025-06-19 19:46:05,532 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,533 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,533 - sqlalchemy.engine.Engine - INFO - [cached since 0.314s ago] ()
2025-06-19 19:46:05,534 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:46:05,534 - sqlalchemy.engine.Engine - INFO - [cached since 0.1759s ago] ()
2025-06-19 19:46:05,535 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,536 - app.database - INFO - üìä Threats: 12 records
2025-06-19 19:46:05,536 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,537 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,537 - sqlalchemy.engine.Engine - INFO - [cached since 0.3181s ago] ()
2025-06-19 19:46:05,538 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:46:05,538 - sqlalchemy.engine.Engine - INFO - [cached since 0.1589s ago] ()
2025-06-19 19:46:05,540 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,540 - app.database - INFO - üìä DetectionRules: 7 records
2025-06-19 19:46:05,541 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,542 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,542 - sqlalchemy.engine.Engine - INFO - [cached since 0.323s ago] ()
2025-06-19 19:46:05,542 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:46:05,543 - sqlalchemy.engine.Engine - INFO - [cached since 0.1424s ago] ()
2025-06-19 19:46:05,544 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,545 - app.database - INFO - üìä SystemConfig: 10 records
2025-06-19 19:46:05,546 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,546 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,546 - sqlalchemy.engine.Engine - INFO - [cached since 0.3275s ago] ()
2025-06-19 19:46:05,547 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:46:05,547 - sqlalchemy.engine.Engine - INFO - [cached since 0.1377s ago] ()
2025-06-19 19:46:05,549 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,550 - app.database - INFO - üìä AgentConfigs: 0 records
2025-06-19 19:46:05,550 - app.database - INFO - üìà Total EDR records: 29
2025-06-19 19:46:05,550 - __main__ - INFO - ‚úÖ Database connection successful
2025-06-19 19:46:05,551 - __main__ - INFO - ‚úÖ Environment check completed successfully
2025-06-19 19:46:05,551 - __main__ - INFO - üìä Retrieving database information...
2025-06-19 19:46:05,551 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,552 - sqlalchemy.engine.Engine - INFO - SELECT 1 as test, GETDATE() as server_time
2025-06-19 19:46:05,552 - sqlalchemy.engine.Engine - INFO - [cached since 0.3367s ago] ()
2025-06-19 19:46:05,552 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 19:46:05,553 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:46:05,553 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,554 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,554 - sqlalchemy.engine.Engine - INFO - [cached since 0.3349s ago] ()
2025-06-19 19:46:05,555 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name
                
2025-06-19 19:46:05,555 - sqlalchemy.engine.Engine - INFO - [cached since 0.3351s ago] ()
2025-06-19 19:46:05,557 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,558 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,558 - sqlalchemy.engine.Engine - INFO - [cached since 0.3391s ago] ()
2025-06-19 19:46:05,559 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,560 - sqlalchemy.engine.Engine - INFO - [cached since 0.3266s ago] ('Agents', 'dbo')
2025-06-19 19:46:05,576 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,577 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,577 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,578 - sqlalchemy.engine.Engine - INFO - [cached since 0.3588s ago] ()
2025-06-19 19:46:05,578 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:46:05,579 - sqlalchemy.engine.Engine - INFO - [cached since 0.3203s ago] ()
2025-06-19 19:46:05,580 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,582 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,582 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,582 - sqlalchemy.engine.Engine - INFO - [cached since 0.3633s ago] ()
2025-06-19 19:46:05,583 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,583 - sqlalchemy.engine.Engine - INFO - [cached since 0.35s ago] ('Events', 'dbo')
2025-06-19 19:46:05,584 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,585 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,585 - sqlalchemy.engine.Engine - INFO - [cached since 0.3661s ago] ()
2025-06-19 19:46:05,586 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:46:05,586 - sqlalchemy.engine.Engine - INFO - [cached since 0.2818s ago] ()
2025-06-19 19:46:05,589 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,590 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,590 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,591 - sqlalchemy.engine.Engine - INFO - [cached since 0.3718s ago] ()
2025-06-19 19:46:05,592 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,592 - sqlalchemy.engine.Engine - INFO - [cached since 0.3589s ago] ('Alerts', 'dbo')
2025-06-19 19:46:05,593 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,594 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,594 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,594 - sqlalchemy.engine.Engine - INFO - [cached since 0.3752s ago] ()
2025-06-19 19:46:05,595 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:46:05,595 - sqlalchemy.engine.Engine - INFO - [cached since 0.2587s ago] ()
2025-06-19 19:46:05,595 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,596 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,597 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,597 - sqlalchemy.engine.Engine - INFO - [cached since 0.3782s ago] ()
2025-06-19 19:46:05,598 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,598 - sqlalchemy.engine.Engine - INFO - [cached since 0.365s ago] ('Threats', 'dbo')
2025-06-19 19:46:05,609 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,610 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,611 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,611 - sqlalchemy.engine.Engine - INFO - [cached since 0.3919s ago] ()
2025-06-19 19:46:05,611 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:46:05,612 - sqlalchemy.engine.Engine - INFO - [cached since 0.2538s ago] ()
2025-06-19 19:46:05,612 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,613 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,613 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,613 - sqlalchemy.engine.Engine - INFO - [cached since 0.3945s ago] ()
2025-06-19 19:46:05,614 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,614 - sqlalchemy.engine.Engine - INFO - [cached since 0.3812s ago] ('DetectionRules', 'dbo')
2025-06-19 19:46:05,623 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,624 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,625 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,625 - sqlalchemy.engine.Engine - INFO - [cached since 0.4061s ago] ()
2025-06-19 19:46:05,626 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:46:05,626 - sqlalchemy.engine.Engine - INFO - [cached since 0.247s ago] ()
2025-06-19 19:46:05,626 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,628 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,628 - sqlalchemy.engine.Engine - INFO - [cached since 0.4089s ago] ()
2025-06-19 19:46:05,628 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,629 - sqlalchemy.engine.Engine - INFO - [cached since 0.3956s ago] ('SystemConfig', 'dbo')
2025-06-19 19:46:05,629 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,630 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,630 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,631 - sqlalchemy.engine.Engine - INFO - [cached since 0.4118s ago] ()
2025-06-19 19:46:05,631 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:46:05,631 - sqlalchemy.engine.Engine - INFO - [cached since 0.231s ago] ()
2025-06-19 19:46:05,633 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,634 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,634 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,634 - sqlalchemy.engine.Engine - INFO - [cached since 0.4153s ago] ()
2025-06-19 19:46:05,635 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,635 - sqlalchemy.engine.Engine - INFO - [cached since 0.402s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:46:05,636 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,636 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,637 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,637 - sqlalchemy.engine.Engine - INFO - [cached since 0.4181s ago] ()
2025-06-19 19:46:05,638 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:46:05,638 - sqlalchemy.engine.Engine - INFO - [cached since 0.2283s ago] ()
2025-06-19 19:46:05,639 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,640 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 19:46:05,640 - sqlalchemy.engine.Engine - INFO - [cached since 0.2274s ago] ()
2025-06-19 19:46:05,650 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,651 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,651 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,652 - sqlalchemy.engine.Engine - INFO - [cached since 0.4328s ago] ()
2025-06-19 19:46:05,652 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,652 - sqlalchemy.engine.Engine - INFO - [cached since 0.4194s ago] ('Agents', 'dbo')
2025-06-19 19:46:05,665 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,666 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,667 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,667 - sqlalchemy.engine.Engine - INFO - [cached since 0.448s ago] ()
2025-06-19 19:46:05,667 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:46:05,668 - sqlalchemy.engine.Engine - INFO - [cached since 0.4094s ago] ()
2025-06-19 19:46:05,670 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,672 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,672 - sqlalchemy.engine.Engine - INFO - [cached since 0.4532s ago] ()
2025-06-19 19:46:05,673 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,673 - sqlalchemy.engine.Engine - INFO - [cached since 0.4402s ago] ('Events', 'dbo')
2025-06-19 19:46:05,674 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,676 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,676 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,676 - sqlalchemy.engine.Engine - INFO - [cached since 0.4575s ago] ()
2025-06-19 19:46:05,677 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:46:05,677 - sqlalchemy.engine.Engine - INFO - [cached since 0.3734s ago] ()
2025-06-19 19:46:05,683 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,684 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,685 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,685 - sqlalchemy.engine.Engine - INFO - [cached since 0.4661s ago] ()
2025-06-19 19:46:05,686 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,686 - sqlalchemy.engine.Engine - INFO - [cached since 0.4529s ago] ('Alerts', 'dbo')
2025-06-19 19:46:05,687 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,688 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,688 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,688 - sqlalchemy.engine.Engine - INFO - [cached since 0.4692s ago] ()
2025-06-19 19:46:05,689 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:46:05,689 - sqlalchemy.engine.Engine - INFO - [cached since 0.3525s ago] ()
2025-06-19 19:46:05,692 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,693 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,694 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,694 - sqlalchemy.engine.Engine - INFO - [cached since 0.475s ago] ()
2025-06-19 19:46:05,695 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,695 - sqlalchemy.engine.Engine - INFO - [cached since 0.462s ago] ('Threats', 'dbo')
2025-06-19 19:46:05,712 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,714 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,714 - sqlalchemy.engine.Engine - INFO - [cached since 0.4953s ago] ()
2025-06-19 19:46:05,715 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:46:05,715 - sqlalchemy.engine.Engine - INFO - [cached since 0.3571s ago] ()
2025-06-19 19:46:05,717 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,719 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,719 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,719 - sqlalchemy.engine.Engine - INFO - [cached since 0.5005s ago] ()
2025-06-19 19:46:05,720 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,721 - sqlalchemy.engine.Engine - INFO - [cached since 0.4874s ago] ('DetectionRules', 'dbo')
2025-06-19 19:46:05,735 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,736 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,737 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,737 - sqlalchemy.engine.Engine - INFO - [cached since 0.5181s ago] ()
2025-06-19 19:46:05,738 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:46:05,738 - sqlalchemy.engine.Engine - INFO - [cached since 0.3591s ago] ()
2025-06-19 19:46:05,741 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,742 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,743 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,743 - sqlalchemy.engine.Engine - INFO - [cached since 0.524s ago] ()
2025-06-19 19:46:05,744 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,744 - sqlalchemy.engine.Engine - INFO - [cached since 0.5108s ago] ('SystemConfig', 'dbo')
2025-06-19 19:46:05,758 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,760 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,761 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,761 - sqlalchemy.engine.Engine - INFO - [cached since 0.5421s ago] ()
2025-06-19 19:46:05,762 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:46:05,762 - sqlalchemy.engine.Engine - INFO - [cached since 0.3616s ago] ()
2025-06-19 19:46:05,764 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,765 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,766 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,766 - sqlalchemy.engine.Engine - INFO - [cached since 0.5474s ago] ()
2025-06-19 19:46:05,768 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,768 - sqlalchemy.engine.Engine - INFO - [cached since 0.5349s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:46:05,769 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,770 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,770 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,771 - sqlalchemy.engine.Engine - INFO - [cached since 0.5518s ago] ()
2025-06-19 19:46:05,771 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:46:05,772 - sqlalchemy.engine.Engine - INFO - [cached since 0.362s ago] ()
2025-06-19 19:46:05,774 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,775 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,777 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,778 - sqlalchemy.engine.Engine - INFO - [cached since 0.5587s ago] ()
2025-06-19 19:46:05,779 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Agents 
                    WHERE LastHeartbeat >= DATEADD(minute, -10, GETDATE())
                    AND Status = 'Active'
                
2025-06-19 19:46:05,779 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ()
2025-06-19 19:46:05,784 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Events 
                    WHERE CreatedAt >= DATEADD(hour, -1, GETDATE())
                
2025-06-19 19:46:05,785 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] ()
2025-06-19 19:46:05,790 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                
2025-06-19 19:46:05,791 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] ()
2025-06-19 19:46:05,796 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                    AND Severity IN ('High', 'Critical')
                
2025-06-19 19:46:05,797 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] ()
2025-06-19 19:46:05,804 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM DetectionRules 
                    WHERE IsActive = 1
                
2025-06-19 19:46:05,805 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ()
2025-06-19 19:46:05,809 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Threats 
                    WHERE IsActive = 1
                
2025-06-19 19:46:05,810 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ()
2025-06-19 19:46:05,813 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,814 - app.database - INFO - ‚úÖ Database health check passed in 262ms
2025-06-19 19:46:05,814 - __main__ - INFO - ‚úÖ Database connected: EDR_System on Manh
2025-06-19 19:46:05,814 - __main__ - INFO - ‚è±Ô∏è Response time: 262ms
2025-06-19 19:46:05,814 - __main__ - INFO - üìä Agents: 0 records
2025-06-19 19:46:05,814 - __main__ - INFO - üìä Events: 0 records
2025-06-19 19:46:05,815 - __main__ - INFO - üìä Alerts: 0 records
2025-06-19 19:46:05,815 - __main__ - INFO - üìä Threats: 12 records
2025-06-19 19:46:05,815 - __main__ - INFO - üìä DetectionRules: 7 records
2025-06-19 19:46:05,815 - __main__ - INFO - üìä SystemConfig: 10 records
2025-06-19 19:46:05,815 - __main__ - INFO - üìä AgentConfigs: 0 records
2025-06-19 19:46:05,816 - __main__ - INFO - üîÑ Active agents (last 10min): 0
2025-06-19 19:46:05,816 - __main__ - INFO - üìà Events (last hour): 0
2025-06-19 19:46:05,817 - __main__ - INFO - üö® Open alerts: 0
2025-06-19 19:46:05,817 - __main__ - INFO - üõ°Ô∏è Active detection rules: 7
2025-06-19 19:46:05,817 - __main__ - INFO - üîç Active threat indicators: 12
2025-06-19 19:46:05,945 - __main__ - INFO - üß™ Testing database schema compliance...
2025-06-19 19:46:05,946 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,946 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,946 - sqlalchemy.engine.Engine - INFO - [cached since 0.7273s ago] ()
2025-06-19 19:46:05,957 - sqlalchemy.engine.Engine - INFO - INSERT INTO [Agents] ([AgentID], [HostName], [IPAddress], [MACAddress], [OperatingSystem], [OSVersion], [Architecture], [Domain], [AgentVersion], [InstallPath], [Status], [LastHeartbeat], [FirstSeen], [CPUUsage], [MemoryUsage], [DiskUsage], [NetworkLatency], [MonitoringEnabled], [CreatedAt], [UpdatedAt]) OUTPUT inserted.[LastHeartbeat], inserted.[FirstSeen], inserted.[CreatedAt], inserted.[UpdatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate(), getdate(), ?, ?, ?, ?, ?, getdate(), getdate())
2025-06-19 19:46:05,958 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] (UUID('8ae8af8d-2ac4-43d2-9114-9a1d3bd4f143'), 'TEST-SCHEMA-001', '192.168.20.200', None, 'Windows 11 Pro', None, None, None, '1.0.0', None, 'Active', 0.0, 0.0, 0.0, 0, 1)
2025-06-19 19:46:05,972 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,973 - __main__ - INFO - ‚úÖ Agent test successful: 8ae8af8d-2ac4-43d2-9114-9a1d3bd4f143
2025-06-19 19:46:05,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,980 - sqlalchemy.engine.Engine - INFO - INSERT INTO [Events] ([AgentID], [EventType], [EventAction], [EventTimestamp], [Severity], [ProcessID], [ProcessName], [ProcessPath], [CommandLine], [ParentPID], [ParentProcessName], [ProcessUser], [ProcessHash], [FilePath], [FileName], [FileSize], [FileHash], [FileExtension], [FileOperation], [SourceIP], [DestinationIP], [SourcePort], [DestinationPort], [Protocol], [Direction], [RegistryKey], [RegistryValueName], [RegistryValueData], [RegistryOperation], [LoginUser], [LoginType], [LoginResult], [ThreatLevel], [RiskScore], [Analyzed], [AnalyzedAt], [RawEventData], [CreatedAt]) OUTPUT inserted.[EventID], inserted.[CreatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate())
2025-06-19 19:46:05,980 - sqlalchemy.engine.Engine - INFO - [generated in 0.00099s] ('8ae8af8d-2ac4-43d2-9114-9a1d3bd4f143', 'Process', 'Create', datetime.datetime(2025, 6, 19, 19, 46, 5, 973939), 'Info', 9999, 'test.exe', None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, 'None', 0, 0, None, None)
2025-06-19 19:46:06,028 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:46:06,029 - app.database - ERROR - üí• SQLAlchemy error: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The target table 'Events' of the DML statement cannot have any enabled triggers if the statement contains an OUTPUT clause without INTO clause. (334) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
[SQL: INSERT INTO [Events] ([AgentID], [EventType], [EventAction], [EventTimestamp], [Severity], [ProcessID], [ProcessName], [ProcessPath], [CommandLine], [ParentPID], [ParentProcessName], [ProcessUser], [ProcessHash], [FilePath], [FileName], [FileSize], [FileHash], [FileExtension], [FileOperation], [SourceIP], [DestinationIP], [SourcePort], [DestinationPort], [Protocol], [Direction], [RegistryKey], [RegistryValueName], [RegistryValueData], [RegistryOperation], [LoginUser], [LoginType], [LoginResult], [ThreatLevel], [RiskScore], [Analyzed], [AnalyzedAt], [RawEventData], [CreatedAt]) OUTPUT inserted.[EventID], inserted.[CreatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate())]
[parameters: ('8ae8af8d-2ac4-43d2-9114-9a1d3bd4f143', 'Process', 'Create', datetime.datetime(2025, 6, 19, 19, 46, 5, 973939), 'Info', 9999, 'test.exe', None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, 'None', 0, 0, None, None)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-19 19:46:06,030 - __main__ - ERROR - ‚ùå Database schema test failed: Database error: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The target table 'Events' of the DML statement cannot have any enabled triggers if the statement contains an OUTPUT clause without INTO clause. (334) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
[SQL: INSERT INTO [Events] ([AgentID], [EventType], [EventAction], [EventTimestamp], [Severity], [ProcessID], [ProcessName], [ProcessPath], [CommandLine], [ParentPID], [ParentProcessName], [ProcessUser], [ProcessHash], [FilePath], [FileName], [FileSize], [FileHash], [FileExtension], [FileOperation], [SourceIP], [DestinationIP], [SourcePort], [DestinationPort], [Protocol], [Direction], [RegistryKey], [RegistryValueName], [RegistryValueData], [RegistryOperation], [LoginUser], [LoginType], [LoginResult], [ThreatLevel], [RiskScore], [Analyzed], [AnalyzedAt], [RawEventData], [CreatedAt]) OUTPUT inserted.[EventID], inserted.[CreatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate())]
[parameters: ('8ae8af8d-2ac4-43d2-9114-9a1d3bd4f143', 'Process', 'Create', datetime.datetime(2025, 6, 19, 19, 46, 5, 973939), 'Info', 9999, 'test.exe', None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, 'None', 0, 0, None, None)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-19 19:46:06,030 - __main__ - ERROR - ‚ùå Database schema test failed - cannot start server
2025-06-19 19:46:06,031 - app.database - INFO - üîÑ Shutting down database connections...
2025-06-19 19:46:06,031 - app.database - INFO - üßπ Database engine disposed successfully
2025-06-19 19:46:06,031 - app.database - INFO - üßπ Database cleanup completed
2025-06-19 19:46:06,032 - app.database - INFO - ‚úÖ Database shutdown completed
