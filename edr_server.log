2025-06-19 19:46:02,198 - __main__ - INFO - üöÄ EDR Agent Communication Server - Startup Initiated
2025-06-19 19:46:02,215 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 19:46:02,215 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 19:46:04,603 - app.database - INFO - üîó Initializing database connection to: MANH/EDR_System
2025-06-19 19:46:04,713 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-19 19:46:04,714 - __main__ - INFO - üóÑÔ∏è Testing database connection...
2025-06-19 19:46:04,714 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-19 19:46:04,881 - sqlalchemy.engine.Engine - INFO - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-19 19:46:04,881 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-19 19:46:04,883 - sqlalchemy.engine.Engine - INFO - SELECT schema_name()
2025-06-19 19:46:04,884 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ()
2025-06-19 19:46:04,906 - sqlalchemy.engine.Engine - INFO - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-19 19:46:04,906 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ()
2025-06-19 19:46:04,910 - sqlalchemy.engine.Engine - INFO - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-19 19:46:04,910 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2025-06-19 19:46:05,215 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,215 - sqlalchemy.engine.Engine - INFO - SELECT 1 as test, GETDATE() as server_time
2025-06-19 19:46:05,216 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ()
2025-06-19 19:46:05,217 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 19:46:05,217 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:46:05,219 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,219 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,219 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ()
2025-06-19 19:46:05,220 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name
                
2025-06-19 19:46:05,221 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ()
2025-06-19 19:46:05,231 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,232 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,232 - sqlalchemy.engine.Engine - INFO - [cached since 0.01343s ago] ()
2025-06-19 19:46:05,233 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,233 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ('Agents', 'dbo')
2025-06-19 19:46:05,254 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,256 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,257 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,257 - sqlalchemy.engine.Engine - INFO - [cached since 0.03827s ago] ()
2025-06-19 19:46:05,258 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:46:05,259 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ()
2025-06-19 19:46:05,284 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,286 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,286 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,286 - sqlalchemy.engine.Engine - INFO - [cached since 0.06757s ago] ()
2025-06-19 19:46:05,287 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,288 - sqlalchemy.engine.Engine - INFO - [cached since 0.05458s ago] ('Events', 'dbo')
2025-06-19 19:46:05,301 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,303 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,303 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,303 - sqlalchemy.engine.Engine - INFO - [cached since 0.08447s ago] ()
2025-06-19 19:46:05,304 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:46:05,304 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-06-19 19:46:05,321 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,325 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,326 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,327 - sqlalchemy.engine.Engine - INFO - [cached since 0.1083s ago] ()
2025-06-19 19:46:05,330 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,331 - sqlalchemy.engine.Engine - INFO - [cached since 0.09748s ago] ('Alerts', 'dbo')
2025-06-19 19:46:05,332 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,334 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,335 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,335 - sqlalchemy.engine.Engine - INFO - [cached since 0.1164s ago] ()
2025-06-19 19:46:05,336 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:46:05,337 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] ()
2025-06-19 19:46:05,341 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,342 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,343 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,343 - sqlalchemy.engine.Engine - INFO - [cached since 0.1241s ago] ()
2025-06-19 19:46:05,344 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,344 - sqlalchemy.engine.Engine - INFO - [cached since 0.1112s ago] ('Threats', 'dbo')
2025-06-19 19:46:05,355 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,356 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,357 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,357 - sqlalchemy.engine.Engine - INFO - [cached since 0.1381s ago] ()
2025-06-19 19:46:05,358 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:46:05,358 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ()
2025-06-19 19:46:05,361 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,362 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,363 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,363 - sqlalchemy.engine.Engine - INFO - [cached since 0.1445s ago] ()
2025-06-19 19:46:05,364 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,365 - sqlalchemy.engine.Engine - INFO - [cached since 0.1315s ago] ('DetectionRules', 'dbo')
2025-06-19 19:46:05,375 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,377 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,378 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,378 - sqlalchemy.engine.Engine - INFO - [cached since 0.159s ago] ()
2025-06-19 19:46:05,379 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:46:05,379 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2025-06-19 19:46:05,382 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,383 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,384 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,384 - sqlalchemy.engine.Engine - INFO - [cached since 0.1652s ago] ()
2025-06-19 19:46:05,385 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,386 - sqlalchemy.engine.Engine - INFO - [cached since 0.1524s ago] ('SystemConfig', 'dbo')
2025-06-19 19:46:05,398 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,399 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,399 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,400 - sqlalchemy.engine.Engine - INFO - [cached since 0.1809s ago] ()
2025-06-19 19:46:05,400 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:46:05,401 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-06-19 19:46:05,403 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,404 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,405 - sqlalchemy.engine.Engine - INFO - [cached since 0.1858s ago] ()
2025-06-19 19:46:05,406 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,406 - sqlalchemy.engine.Engine - INFO - [cached since 0.1729s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:46:05,407 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,408 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,409 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,409 - sqlalchemy.engine.Engine - INFO - [cached since 0.1899s ago] ()
2025-06-19 19:46:05,410 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:46:05,410 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-06-19 19:46:05,412 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,413 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 19:46:05,413 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ()
2025-06-19 19:46:05,428 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,429 - app.database - INFO - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-19 19:46:05,429 - app.database - INFO - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-19 19:46:05,430 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,430 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,430 - sqlalchemy.engine.Engine - INFO - [cached since 0.2116s ago] ()
2025-06-19 19:46:05,431 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,432 - sqlalchemy.engine.Engine - INFO - [cached since 0.1985s ago] ('Agents', 'dbo')
2025-06-19 19:46:05,449 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,450 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,451 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,451 - sqlalchemy.engine.Engine - INFO - [cached since 0.232s ago] ()
2025-06-19 19:46:05,451 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,452 - sqlalchemy.engine.Engine - INFO - [cached since 0.2187s ago] ('Events', 'dbo')
2025-06-19 19:46:05,452 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,453 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,454 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,454 - sqlalchemy.engine.Engine - INFO - [cached since 0.2349s ago] ()
2025-06-19 19:46:05,454 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,455 - sqlalchemy.engine.Engine - INFO - [cached since 0.2217s ago] ('Alerts', 'dbo')
2025-06-19 19:46:05,456 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,457 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,458 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,458 - sqlalchemy.engine.Engine - INFO - [cached since 0.2392s ago] ()
2025-06-19 19:46:05,459 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,459 - sqlalchemy.engine.Engine - INFO - [cached since 0.2264s ago] ('Threats', 'dbo')
2025-06-19 19:46:05,476 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,477 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,477 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,478 - sqlalchemy.engine.Engine - INFO - [cached since 0.2587s ago] ()
2025-06-19 19:46:05,478 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,479 - sqlalchemy.engine.Engine - INFO - [cached since 0.2456s ago] ('DetectionRules', 'dbo')
2025-06-19 19:46:05,490 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,491 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,492 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,492 - sqlalchemy.engine.Engine - INFO - [cached since 0.2731s ago] ()
2025-06-19 19:46:05,493 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,493 - sqlalchemy.engine.Engine - INFO - [cached since 0.26s ago] ('SystemConfig', 'dbo')
2025-06-19 19:46:05,507 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,508 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,509 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,509 - sqlalchemy.engine.Engine - INFO - [cached since 0.2901s ago] ()
2025-06-19 19:46:05,510 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,510 - sqlalchemy.engine.Engine - INFO - [cached since 0.2771s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:46:05,511 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,511 - app.database - INFO - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-19 19:46:05,512 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,512 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,513 - sqlalchemy.engine.Engine - INFO - [cached since 0.2938s ago] ()
2025-06-19 19:46:05,513 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:46:05,514 - sqlalchemy.engine.Engine - INFO - [cached since 0.2555s ago] ()
2025-06-19 19:46:05,516 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,517 - app.database - INFO - üìä Agents: 0 records
2025-06-19 19:46:05,518 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,518 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,518 - sqlalchemy.engine.Engine - INFO - [cached since 0.2996s ago] ()
2025-06-19 19:46:05,519 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:46:05,519 - sqlalchemy.engine.Engine - INFO - [cached since 0.2153s ago] ()
2025-06-19 19:46:05,525 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,526 - app.database - INFO - üìä Events: 0 records
2025-06-19 19:46:05,527 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,527 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,527 - sqlalchemy.engine.Engine - INFO - [cached since 0.3082s ago] ()
2025-06-19 19:46:05,528 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:46:05,528 - sqlalchemy.engine.Engine - INFO - [cached since 0.1916s ago] ()
2025-06-19 19:46:05,531 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,531 - app.database - INFO - üìä Alerts: 0 records
2025-06-19 19:46:05,532 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,533 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,533 - sqlalchemy.engine.Engine - INFO - [cached since 0.314s ago] ()
2025-06-19 19:46:05,534 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:46:05,534 - sqlalchemy.engine.Engine - INFO - [cached since 0.1759s ago] ()
2025-06-19 19:46:05,535 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,536 - app.database - INFO - üìä Threats: 12 records
2025-06-19 19:46:05,536 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,537 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,537 - sqlalchemy.engine.Engine - INFO - [cached since 0.3181s ago] ()
2025-06-19 19:46:05,538 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:46:05,538 - sqlalchemy.engine.Engine - INFO - [cached since 0.1589s ago] ()
2025-06-19 19:46:05,540 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,540 - app.database - INFO - üìä DetectionRules: 7 records
2025-06-19 19:46:05,541 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,542 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,542 - sqlalchemy.engine.Engine - INFO - [cached since 0.323s ago] ()
2025-06-19 19:46:05,542 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:46:05,543 - sqlalchemy.engine.Engine - INFO - [cached since 0.1424s ago] ()
2025-06-19 19:46:05,544 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,545 - app.database - INFO - üìä SystemConfig: 10 records
2025-06-19 19:46:05,546 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,546 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,546 - sqlalchemy.engine.Engine - INFO - [cached since 0.3275s ago] ()
2025-06-19 19:46:05,547 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:46:05,547 - sqlalchemy.engine.Engine - INFO - [cached since 0.1377s ago] ()
2025-06-19 19:46:05,549 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,550 - app.database - INFO - üìä AgentConfigs: 0 records
2025-06-19 19:46:05,550 - app.database - INFO - üìà Total EDR records: 29
2025-06-19 19:46:05,550 - __main__ - INFO - ‚úÖ Database connection successful
2025-06-19 19:46:05,551 - __main__ - INFO - ‚úÖ Environment check completed successfully
2025-06-19 19:46:05,551 - __main__ - INFO - üìä Retrieving database information...
2025-06-19 19:46:05,551 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,552 - sqlalchemy.engine.Engine - INFO - SELECT 1 as test, GETDATE() as server_time
2025-06-19 19:46:05,552 - sqlalchemy.engine.Engine - INFO - [cached since 0.3367s ago] ()
2025-06-19 19:46:05,552 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 19:46:05,553 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:46:05,553 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,554 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,554 - sqlalchemy.engine.Engine - INFO - [cached since 0.3349s ago] ()
2025-06-19 19:46:05,555 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name
                
2025-06-19 19:46:05,555 - sqlalchemy.engine.Engine - INFO - [cached since 0.3351s ago] ()
2025-06-19 19:46:05,557 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,558 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,558 - sqlalchemy.engine.Engine - INFO - [cached since 0.3391s ago] ()
2025-06-19 19:46:05,559 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,560 - sqlalchemy.engine.Engine - INFO - [cached since 0.3266s ago] ('Agents', 'dbo')
2025-06-19 19:46:05,576 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,577 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,577 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,578 - sqlalchemy.engine.Engine - INFO - [cached since 0.3588s ago] ()
2025-06-19 19:46:05,578 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:46:05,579 - sqlalchemy.engine.Engine - INFO - [cached since 0.3203s ago] ()
2025-06-19 19:46:05,580 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,582 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,582 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,582 - sqlalchemy.engine.Engine - INFO - [cached since 0.3633s ago] ()
2025-06-19 19:46:05,583 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,583 - sqlalchemy.engine.Engine - INFO - [cached since 0.35s ago] ('Events', 'dbo')
2025-06-19 19:46:05,584 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,585 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,585 - sqlalchemy.engine.Engine - INFO - [cached since 0.3661s ago] ()
2025-06-19 19:46:05,586 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:46:05,586 - sqlalchemy.engine.Engine - INFO - [cached since 0.2818s ago] ()
2025-06-19 19:46:05,589 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,590 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,590 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,591 - sqlalchemy.engine.Engine - INFO - [cached since 0.3718s ago] ()
2025-06-19 19:46:05,592 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,592 - sqlalchemy.engine.Engine - INFO - [cached since 0.3589s ago] ('Alerts', 'dbo')
2025-06-19 19:46:05,593 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,594 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,594 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,594 - sqlalchemy.engine.Engine - INFO - [cached since 0.3752s ago] ()
2025-06-19 19:46:05,595 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:46:05,595 - sqlalchemy.engine.Engine - INFO - [cached since 0.2587s ago] ()
2025-06-19 19:46:05,595 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,596 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,597 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,597 - sqlalchemy.engine.Engine - INFO - [cached since 0.3782s ago] ()
2025-06-19 19:46:05,598 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,598 - sqlalchemy.engine.Engine - INFO - [cached since 0.365s ago] ('Threats', 'dbo')
2025-06-19 19:46:05,609 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,610 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,611 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,611 - sqlalchemy.engine.Engine - INFO - [cached since 0.3919s ago] ()
2025-06-19 19:46:05,611 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:46:05,612 - sqlalchemy.engine.Engine - INFO - [cached since 0.2538s ago] ()
2025-06-19 19:46:05,612 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,613 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,613 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,613 - sqlalchemy.engine.Engine - INFO - [cached since 0.3945s ago] ()
2025-06-19 19:46:05,614 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,614 - sqlalchemy.engine.Engine - INFO - [cached since 0.3812s ago] ('DetectionRules', 'dbo')
2025-06-19 19:46:05,623 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,624 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,625 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,625 - sqlalchemy.engine.Engine - INFO - [cached since 0.4061s ago] ()
2025-06-19 19:46:05,626 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:46:05,626 - sqlalchemy.engine.Engine - INFO - [cached since 0.247s ago] ()
2025-06-19 19:46:05,626 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,628 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,628 - sqlalchemy.engine.Engine - INFO - [cached since 0.4089s ago] ()
2025-06-19 19:46:05,628 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,629 - sqlalchemy.engine.Engine - INFO - [cached since 0.3956s ago] ('SystemConfig', 'dbo')
2025-06-19 19:46:05,629 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,630 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,630 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,631 - sqlalchemy.engine.Engine - INFO - [cached since 0.4118s ago] ()
2025-06-19 19:46:05,631 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:46:05,631 - sqlalchemy.engine.Engine - INFO - [cached since 0.231s ago] ()
2025-06-19 19:46:05,633 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,634 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,634 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,634 - sqlalchemy.engine.Engine - INFO - [cached since 0.4153s ago] ()
2025-06-19 19:46:05,635 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,635 - sqlalchemy.engine.Engine - INFO - [cached since 0.402s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:46:05,636 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,636 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,637 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,637 - sqlalchemy.engine.Engine - INFO - [cached since 0.4181s ago] ()
2025-06-19 19:46:05,638 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:46:05,638 - sqlalchemy.engine.Engine - INFO - [cached since 0.2283s ago] ()
2025-06-19 19:46:05,639 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,640 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 19:46:05,640 - sqlalchemy.engine.Engine - INFO - [cached since 0.2274s ago] ()
2025-06-19 19:46:05,650 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,651 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,651 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,652 - sqlalchemy.engine.Engine - INFO - [cached since 0.4328s ago] ()
2025-06-19 19:46:05,652 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,652 - sqlalchemy.engine.Engine - INFO - [cached since 0.4194s ago] ('Agents', 'dbo')
2025-06-19 19:46:05,665 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,666 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,667 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,667 - sqlalchemy.engine.Engine - INFO - [cached since 0.448s ago] ()
2025-06-19 19:46:05,667 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:46:05,668 - sqlalchemy.engine.Engine - INFO - [cached since 0.4094s ago] ()
2025-06-19 19:46:05,670 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,672 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,672 - sqlalchemy.engine.Engine - INFO - [cached since 0.4532s ago] ()
2025-06-19 19:46:05,673 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,673 - sqlalchemy.engine.Engine - INFO - [cached since 0.4402s ago] ('Events', 'dbo')
2025-06-19 19:46:05,674 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,676 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,676 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,676 - sqlalchemy.engine.Engine - INFO - [cached since 0.4575s ago] ()
2025-06-19 19:46:05,677 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:46:05,677 - sqlalchemy.engine.Engine - INFO - [cached since 0.3734s ago] ()
2025-06-19 19:46:05,683 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,684 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,685 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,685 - sqlalchemy.engine.Engine - INFO - [cached since 0.4661s ago] ()
2025-06-19 19:46:05,686 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,686 - sqlalchemy.engine.Engine - INFO - [cached since 0.4529s ago] ('Alerts', 'dbo')
2025-06-19 19:46:05,687 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,688 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,688 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,688 - sqlalchemy.engine.Engine - INFO - [cached since 0.4692s ago] ()
2025-06-19 19:46:05,689 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:46:05,689 - sqlalchemy.engine.Engine - INFO - [cached since 0.3525s ago] ()
2025-06-19 19:46:05,692 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,693 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,694 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,694 - sqlalchemy.engine.Engine - INFO - [cached since 0.475s ago] ()
2025-06-19 19:46:05,695 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,695 - sqlalchemy.engine.Engine - INFO - [cached since 0.462s ago] ('Threats', 'dbo')
2025-06-19 19:46:05,712 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,714 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,714 - sqlalchemy.engine.Engine - INFO - [cached since 0.4953s ago] ()
2025-06-19 19:46:05,715 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:46:05,715 - sqlalchemy.engine.Engine - INFO - [cached since 0.3571s ago] ()
2025-06-19 19:46:05,717 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,719 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,719 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,719 - sqlalchemy.engine.Engine - INFO - [cached since 0.5005s ago] ()
2025-06-19 19:46:05,720 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,721 - sqlalchemy.engine.Engine - INFO - [cached since 0.4874s ago] ('DetectionRules', 'dbo')
2025-06-19 19:46:05,735 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,736 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,737 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,737 - sqlalchemy.engine.Engine - INFO - [cached since 0.5181s ago] ()
2025-06-19 19:46:05,738 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:46:05,738 - sqlalchemy.engine.Engine - INFO - [cached since 0.3591s ago] ()
2025-06-19 19:46:05,741 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,742 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,743 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,743 - sqlalchemy.engine.Engine - INFO - [cached since 0.524s ago] ()
2025-06-19 19:46:05,744 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,744 - sqlalchemy.engine.Engine - INFO - [cached since 0.5108s ago] ('SystemConfig', 'dbo')
2025-06-19 19:46:05,758 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,760 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,761 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,761 - sqlalchemy.engine.Engine - INFO - [cached since 0.5421s ago] ()
2025-06-19 19:46:05,762 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:46:05,762 - sqlalchemy.engine.Engine - INFO - [cached since 0.3616s ago] ()
2025-06-19 19:46:05,764 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,765 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,766 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,766 - sqlalchemy.engine.Engine - INFO - [cached since 0.5474s ago] ()
2025-06-19 19:46:05,768 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:46:05,768 - sqlalchemy.engine.Engine - INFO - [cached since 0.5349s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:46:05,769 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,770 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,770 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,771 - sqlalchemy.engine.Engine - INFO - [cached since 0.5518s ago] ()
2025-06-19 19:46:05,771 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:46:05,772 - sqlalchemy.engine.Engine - INFO - [cached since 0.362s ago] ()
2025-06-19 19:46:05,774 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,775 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,777 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,778 - sqlalchemy.engine.Engine - INFO - [cached since 0.5587s ago] ()
2025-06-19 19:46:05,779 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Agents 
                    WHERE LastHeartbeat >= DATEADD(minute, -10, GETDATE())
                    AND Status = 'Active'
                
2025-06-19 19:46:05,779 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ()
2025-06-19 19:46:05,784 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Events 
                    WHERE CreatedAt >= DATEADD(hour, -1, GETDATE())
                
2025-06-19 19:46:05,785 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] ()
2025-06-19 19:46:05,790 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                
2025-06-19 19:46:05,791 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] ()
2025-06-19 19:46:05,796 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                    AND Severity IN ('High', 'Critical')
                
2025-06-19 19:46:05,797 - sqlalchemy.engine.Engine - INFO - [generated in 0.00069s] ()
2025-06-19 19:46:05,804 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM DetectionRules 
                    WHERE IsActive = 1
                
2025-06-19 19:46:05,805 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] ()
2025-06-19 19:46:05,809 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Threats 
                    WHERE IsActive = 1
                
2025-06-19 19:46:05,810 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ()
2025-06-19 19:46:05,813 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,814 - app.database - INFO - ‚úÖ Database health check passed in 262ms
2025-06-19 19:46:05,814 - __main__ - INFO - ‚úÖ Database connected: EDR_System on Manh
2025-06-19 19:46:05,814 - __main__ - INFO - ‚è±Ô∏è Response time: 262ms
2025-06-19 19:46:05,814 - __main__ - INFO - üìä Agents: 0 records
2025-06-19 19:46:05,814 - __main__ - INFO - üìä Events: 0 records
2025-06-19 19:46:05,815 - __main__ - INFO - üìä Alerts: 0 records
2025-06-19 19:46:05,815 - __main__ - INFO - üìä Threats: 12 records
2025-06-19 19:46:05,815 - __main__ - INFO - üìä DetectionRules: 7 records
2025-06-19 19:46:05,815 - __main__ - INFO - üìä SystemConfig: 10 records
2025-06-19 19:46:05,815 - __main__ - INFO - üìä AgentConfigs: 0 records
2025-06-19 19:46:05,816 - __main__ - INFO - üîÑ Active agents (last 10min): 0
2025-06-19 19:46:05,816 - __main__ - INFO - üìà Events (last hour): 0
2025-06-19 19:46:05,817 - __main__ - INFO - üö® Open alerts: 0
2025-06-19 19:46:05,817 - __main__ - INFO - üõ°Ô∏è Active detection rules: 7
2025-06-19 19:46:05,817 - __main__ - INFO - üîç Active threat indicators: 12
2025-06-19 19:46:05,945 - __main__ - INFO - üß™ Testing database schema compliance...
2025-06-19 19:46:05,946 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,946 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:46:05,946 - sqlalchemy.engine.Engine - INFO - [cached since 0.7273s ago] ()
2025-06-19 19:46:05,957 - sqlalchemy.engine.Engine - INFO - INSERT INTO [Agents] ([AgentID], [HostName], [IPAddress], [MACAddress], [OperatingSystem], [OSVersion], [Architecture], [Domain], [AgentVersion], [InstallPath], [Status], [LastHeartbeat], [FirstSeen], [CPUUsage], [MemoryUsage], [DiskUsage], [NetworkLatency], [MonitoringEnabled], [CreatedAt], [UpdatedAt]) OUTPUT inserted.[LastHeartbeat], inserted.[FirstSeen], inserted.[CreatedAt], inserted.[UpdatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate(), getdate(), ?, ?, ?, ?, ?, getdate(), getdate())
2025-06-19 19:46:05,958 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] (UUID('8ae8af8d-2ac4-43d2-9114-9a1d3bd4f143'), 'TEST-SCHEMA-001', '192.168.20.200', None, 'Windows 11 Pro', None, None, None, '1.0.0', None, 'Active', 0.0, 0.0, 0.0, 0, 1)
2025-06-19 19:46:05,972 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:46:05,973 - __main__ - INFO - ‚úÖ Agent test successful: 8ae8af8d-2ac4-43d2-9114-9a1d3bd4f143
2025-06-19 19:46:05,974 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:46:05,980 - sqlalchemy.engine.Engine - INFO - INSERT INTO [Events] ([AgentID], [EventType], [EventAction], [EventTimestamp], [Severity], [ProcessID], [ProcessName], [ProcessPath], [CommandLine], [ParentPID], [ParentProcessName], [ProcessUser], [ProcessHash], [FilePath], [FileName], [FileSize], [FileHash], [FileExtension], [FileOperation], [SourceIP], [DestinationIP], [SourcePort], [DestinationPort], [Protocol], [Direction], [RegistryKey], [RegistryValueName], [RegistryValueData], [RegistryOperation], [LoginUser], [LoginType], [LoginResult], [ThreatLevel], [RiskScore], [Analyzed], [AnalyzedAt], [RawEventData], [CreatedAt]) OUTPUT inserted.[EventID], inserted.[CreatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate())
2025-06-19 19:46:05,980 - sqlalchemy.engine.Engine - INFO - [generated in 0.00099s] ('8ae8af8d-2ac4-43d2-9114-9a1d3bd4f143', 'Process', 'Create', datetime.datetime(2025, 6, 19, 19, 46, 5, 973939), 'Info', 9999, 'test.exe', None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, 'None', 0, 0, None, None)
2025-06-19 19:46:06,028 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:46:06,029 - app.database - ERROR - üí• SQLAlchemy error: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The target table 'Events' of the DML statement cannot have any enabled triggers if the statement contains an OUTPUT clause without INTO clause. (334) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
[SQL: INSERT INTO [Events] ([AgentID], [EventType], [EventAction], [EventTimestamp], [Severity], [ProcessID], [ProcessName], [ProcessPath], [CommandLine], [ParentPID], [ParentProcessName], [ProcessUser], [ProcessHash], [FilePath], [FileName], [FileSize], [FileHash], [FileExtension], [FileOperation], [SourceIP], [DestinationIP], [SourcePort], [DestinationPort], [Protocol], [Direction], [RegistryKey], [RegistryValueName], [RegistryValueData], [RegistryOperation], [LoginUser], [LoginType], [LoginResult], [ThreatLevel], [RiskScore], [Analyzed], [AnalyzedAt], [RawEventData], [CreatedAt]) OUTPUT inserted.[EventID], inserted.[CreatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate())]
[parameters: ('8ae8af8d-2ac4-43d2-9114-9a1d3bd4f143', 'Process', 'Create', datetime.datetime(2025, 6, 19, 19, 46, 5, 973939), 'Info', 9999, 'test.exe', None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, 'None', 0, 0, None, None)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-19 19:46:06,030 - __main__ - ERROR - ‚ùå Database schema test failed: Database error: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The target table 'Events' of the DML statement cannot have any enabled triggers if the statement contains an OUTPUT clause without INTO clause. (334) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
[SQL: INSERT INTO [Events] ([AgentID], [EventType], [EventAction], [EventTimestamp], [Severity], [ProcessID], [ProcessName], [ProcessPath], [CommandLine], [ParentPID], [ParentProcessName], [ProcessUser], [ProcessHash], [FilePath], [FileName], [FileSize], [FileHash], [FileExtension], [FileOperation], [SourceIP], [DestinationIP], [SourcePort], [DestinationPort], [Protocol], [Direction], [RegistryKey], [RegistryValueName], [RegistryValueData], [RegistryOperation], [LoginUser], [LoginType], [LoginResult], [ThreatLevel], [RiskScore], [Analyzed], [AnalyzedAt], [RawEventData], [CreatedAt]) OUTPUT inserted.[EventID], inserted.[CreatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate())]
[parameters: ('8ae8af8d-2ac4-43d2-9114-9a1d3bd4f143', 'Process', 'Create', datetime.datetime(2025, 6, 19, 19, 46, 5, 973939), 'Info', 9999, 'test.exe', None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, 'None', 0, 0, None, None)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-19 19:46:06,030 - __main__ - ERROR - ‚ùå Database schema test failed - cannot start server
2025-06-19 19:46:06,031 - app.database - INFO - üîÑ Shutting down database connections...
2025-06-19 19:46:06,031 - app.database - INFO - üßπ Database engine disposed successfully
2025-06-19 19:46:06,031 - app.database - INFO - üßπ Database cleanup completed
2025-06-19 19:46:06,032 - app.database - INFO - ‚úÖ Database shutdown completed
2025-06-19 19:51:28,313 - __main__ - INFO - üöÄ EDR Agent Communication Server - Startup Initiated
2025-06-19 19:51:28,316 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 19:51:28,316 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 19:51:28,650 - app.database - INFO - üîó Initializing database connection to: MANH/EDR_System
2025-06-19 19:51:28,671 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-19 19:51:28,672 - __main__ - INFO - üóÑÔ∏è Testing database connection...
2025-06-19 19:51:28,672 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-19 19:51:28,735 - sqlalchemy.engine.Engine - INFO - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-19 19:51:28,735 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-19 19:51:28,737 - sqlalchemy.engine.Engine - INFO - SELECT schema_name()
2025-06-19 19:51:28,737 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ()
2025-06-19 19:51:28,749 - sqlalchemy.engine.Engine - INFO - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-19 19:51:28,749 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ()
2025-06-19 19:51:28,750 - sqlalchemy.engine.Engine - INFO - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-19 19:51:28,751 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ()
2025-06-19 19:51:28,791 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,791 - sqlalchemy.engine.Engine - INFO - SELECT 1 as test, GETDATE() as server_time
2025-06-19 19:51:28,792 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] ()
2025-06-19 19:51:28,792 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 19:51:28,793 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:51:28,794 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,794 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,794 - sqlalchemy.engine.Engine - INFO - [generated in 0.00021s] ()
2025-06-19 19:51:28,794 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name
                
2025-06-19 19:51:28,795 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-06-19 19:51:28,801 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,801 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,801 - sqlalchemy.engine.Engine - INFO - [cached since 0.007662s ago] ()
2025-06-19 19:51:28,802 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,803 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ('Agents', 'dbo')
2025-06-19 19:51:28,812 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,813 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,814 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,814 - sqlalchemy.engine.Engine - INFO - [cached since 0.02023s ago] ()
2025-06-19 19:51:28,815 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:51:28,815 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ()
2025-06-19 19:51:28,817 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,817 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,818 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,818 - sqlalchemy.engine.Engine - INFO - [cached since 0.02416s ago] ()
2025-06-19 19:51:28,819 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,819 - sqlalchemy.engine.Engine - INFO - [cached since 0.01657s ago] ('Events', 'dbo')
2025-06-19 19:51:28,819 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,820 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,820 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,820 - sqlalchemy.engine.Engine - INFO - [cached since 0.02666s ago] ()
2025-06-19 19:51:28,821 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:51:28,821 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-06-19 19:51:28,825 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,826 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,826 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,826 - sqlalchemy.engine.Engine - INFO - [cached since 0.03271s ago] ()
2025-06-19 19:51:28,827 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,828 - sqlalchemy.engine.Engine - INFO - [cached since 0.02519s ago] ('Alerts', 'dbo')
2025-06-19 19:51:28,828 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,829 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,829 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,829 - sqlalchemy.engine.Engine - INFO - [cached since 0.03528s ago] ()
2025-06-19 19:51:28,829 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:51:28,830 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ()
2025-06-19 19:51:28,831 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,832 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,833 - sqlalchemy.engine.Engine - INFO - [cached since 0.0388s ago] ()
2025-06-19 19:51:28,833 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,833 - sqlalchemy.engine.Engine - INFO - [cached since 0.03097s ago] ('Threats', 'dbo')
2025-06-19 19:51:28,841 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,843 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,843 - sqlalchemy.engine.Engine - INFO - [cached since 0.04951s ago] ()
2025-06-19 19:51:28,844 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:51:28,844 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ()
2025-06-19 19:51:28,845 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,846 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,846 - sqlalchemy.engine.Engine - INFO - [cached since 0.05242s ago] ()
2025-06-19 19:51:28,847 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,847 - sqlalchemy.engine.Engine - INFO - [cached since 0.04462s ago] ('DetectionRules', 'dbo')
2025-06-19 19:51:28,854 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,855 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,856 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,856 - sqlalchemy.engine.Engine - INFO - [cached since 0.06228s ago] ()
2025-06-19 19:51:28,857 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:51:28,857 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-06-19 19:51:28,858 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,859 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,859 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,859 - sqlalchemy.engine.Engine - INFO - [cached since 0.06542s ago] ()
2025-06-19 19:51:28,860 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,860 - sqlalchemy.engine.Engine - INFO - [cached since 0.05764s ago] ('SystemConfig', 'dbo')
2025-06-19 19:51:28,868 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,870 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,870 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,870 - sqlalchemy.engine.Engine - INFO - [cached since 0.07638s ago] ()
2025-06-19 19:51:28,871 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:51:28,871 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ()
2025-06-19 19:51:28,873 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,873 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,874 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,874 - sqlalchemy.engine.Engine - INFO - [cached since 0.08021s ago] ()
2025-06-19 19:51:28,875 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,875 - sqlalchemy.engine.Engine - INFO - [cached since 0.07256s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:51:28,875 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,876 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,876 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,877 - sqlalchemy.engine.Engine - INFO - [cached since 0.0828s ago] ()
2025-06-19 19:51:28,877 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:51:28,877 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ()
2025-06-19 19:51:28,879 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,879 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 19:51:28,880 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ()
2025-06-19 19:51:28,886 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,887 - app.database - INFO - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-19 19:51:28,887 - app.database - INFO - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-19 19:51:28,888 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,888 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,888 - sqlalchemy.engine.Engine - INFO - [cached since 0.09437s ago] ()
2025-06-19 19:51:28,889 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,889 - sqlalchemy.engine.Engine - INFO - [cached since 0.08671s ago] ('Agents', 'dbo')
2025-06-19 19:51:28,889 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,890 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,890 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,891 - sqlalchemy.engine.Engine - INFO - [cached since 0.09691s ago] ()
2025-06-19 19:51:28,891 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,892 - sqlalchemy.engine.Engine - INFO - [cached since 0.08918s ago] ('Events', 'dbo')
2025-06-19 19:51:28,892 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,893 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,893 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,893 - sqlalchemy.engine.Engine - INFO - [cached since 0.09921s ago] ()
2025-06-19 19:51:28,893 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,894 - sqlalchemy.engine.Engine - INFO - [cached since 0.09129s ago] ('Alerts', 'dbo')
2025-06-19 19:51:28,894 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,895 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,895 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,895 - sqlalchemy.engine.Engine - INFO - [cached since 0.1016s ago] ()
2025-06-19 19:51:28,896 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,896 - sqlalchemy.engine.Engine - INFO - [cached since 0.09382s ago] ('Threats', 'dbo')
2025-06-19 19:51:28,897 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,897 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,898 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,898 - sqlalchemy.engine.Engine - INFO - [cached since 0.1039s ago] ()
2025-06-19 19:51:28,898 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,898 - sqlalchemy.engine.Engine - INFO - [cached since 0.09599s ago] ('DetectionRules', 'dbo')
2025-06-19 19:51:28,899 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,899 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,900 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,900 - sqlalchemy.engine.Engine - INFO - [cached since 0.1061s ago] ()
2025-06-19 19:51:28,900 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,901 - sqlalchemy.engine.Engine - INFO - [cached since 0.09831s ago] ('SystemConfig', 'dbo')
2025-06-19 19:51:28,901 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,902 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,902 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,902 - sqlalchemy.engine.Engine - INFO - [cached since 0.1083s ago] ()
2025-06-19 19:51:28,903 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,903 - sqlalchemy.engine.Engine - INFO - [cached since 0.1006s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:51:28,903 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,904 - app.database - INFO - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-19 19:51:28,904 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,905 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,905 - sqlalchemy.engine.Engine - INFO - [cached since 0.1111s ago] ()
2025-06-19 19:51:28,905 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:51:28,906 - sqlalchemy.engine.Engine - INFO - [cached since 0.09109s ago] ()
2025-06-19 19:51:28,906 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,906 - app.database - INFO - üìä Agents: 1 records
2025-06-19 19:51:28,907 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,907 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,907 - sqlalchemy.engine.Engine - INFO - [cached since 0.1135s ago] ()
2025-06-19 19:51:28,908 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:51:28,908 - sqlalchemy.engine.Engine - INFO - [cached since 0.08699s ago] ()
2025-06-19 19:51:28,908 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,908 - app.database - INFO - üìä Events: 0 records
2025-06-19 19:51:28,909 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,909 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,909 - sqlalchemy.engine.Engine - INFO - [cached since 0.1154s ago] ()
2025-06-19 19:51:28,909 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:51:28,910 - sqlalchemy.engine.Engine - INFO - [cached since 0.08025s ago] ()
2025-06-19 19:51:28,910 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,911 - app.database - INFO - üìä Alerts: 0 records
2025-06-19 19:51:28,911 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,911 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,911 - sqlalchemy.engine.Engine - INFO - [cached since 0.1176s ago] ()
2025-06-19 19:51:28,912 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:51:28,912 - sqlalchemy.engine.Engine - INFO - [cached since 0.06821s ago] ()
2025-06-19 19:51:28,912 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,913 - app.database - INFO - üìä Threats: 12 records
2025-06-19 19:51:28,913 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,913 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,913 - sqlalchemy.engine.Engine - INFO - [cached since 0.1197s ago] ()
2025-06-19 19:51:28,914 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:51:28,914 - sqlalchemy.engine.Engine - INFO - [cached since 0.05751s ago] ()
2025-06-19 19:51:28,915 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,915 - app.database - INFO - üìä DetectionRules: 7 records
2025-06-19 19:51:28,915 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,916 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,916 - sqlalchemy.engine.Engine - INFO - [cached since 0.1221s ago] ()
2025-06-19 19:51:28,916 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:51:28,917 - sqlalchemy.engine.Engine - INFO - [cached since 0.04575s ago] ()
2025-06-19 19:51:28,917 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,917 - app.database - INFO - üìä SystemConfig: 10 records
2025-06-19 19:51:28,918 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,918 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,918 - sqlalchemy.engine.Engine - INFO - [cached since 0.1245s ago] ()
2025-06-19 19:51:28,919 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:51:28,919 - sqlalchemy.engine.Engine - INFO - [cached since 0.04187s ago] ()
2025-06-19 19:51:28,919 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,920 - app.database - INFO - üìä AgentConfigs: 0 records
2025-06-19 19:51:28,920 - app.database - INFO - üìà Total EDR records: 30
2025-06-19 19:51:28,920 - __main__ - INFO - ‚úÖ Database connection successful
2025-06-19 19:51:28,920 - __main__ - INFO - ‚úÖ Environment check completed successfully
2025-06-19 19:51:28,920 - __main__ - INFO - üìä Retrieving database information...
2025-06-19 19:51:28,921 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,921 - sqlalchemy.engine.Engine - INFO - SELECT 1 as test, GETDATE() as server_time
2025-06-19 19:51:28,921 - sqlalchemy.engine.Engine - INFO - [cached since 0.1306s ago] ()
2025-06-19 19:51:28,922 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 19:51:28,922 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:51:28,923 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,923 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,923 - sqlalchemy.engine.Engine - INFO - [cached since 0.1293s ago] ()
2025-06-19 19:51:28,923 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name
                
2025-06-19 19:51:28,924 - sqlalchemy.engine.Engine - INFO - [cached since 0.1294s ago] ()
2025-06-19 19:51:28,925 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,925 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,925 - sqlalchemy.engine.Engine - INFO - [cached since 0.1315s ago] ()
2025-06-19 19:51:28,926 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,926 - sqlalchemy.engine.Engine - INFO - [cached since 0.1238s ago] ('Agents', 'dbo')
2025-06-19 19:51:28,927 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,927 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,928 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,928 - sqlalchemy.engine.Engine - INFO - [cached since 0.134s ago] ()
2025-06-19 19:51:28,928 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:51:28,928 - sqlalchemy.engine.Engine - INFO - [cached since 0.1138s ago] ()
2025-06-19 19:51:28,929 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,929 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,929 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,930 - sqlalchemy.engine.Engine - INFO - [cached since 0.1359s ago] ()
2025-06-19 19:51:28,930 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,930 - sqlalchemy.engine.Engine - INFO - [cached since 0.1281s ago] ('Events', 'dbo')
2025-06-19 19:51:28,931 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,932 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,932 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,932 - sqlalchemy.engine.Engine - INFO - [cached since 0.1382s ago] ()
2025-06-19 19:51:28,932 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:51:28,933 - sqlalchemy.engine.Engine - INFO - [cached since 0.1119s ago] ()
2025-06-19 19:51:28,933 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,934 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,934 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,934 - sqlalchemy.engine.Engine - INFO - [cached since 0.1402s ago] ()
2025-06-19 19:51:28,934 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,935 - sqlalchemy.engine.Engine - INFO - [cached since 0.1325s ago] ('Alerts', 'dbo')
2025-06-19 19:51:28,935 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,936 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,936 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,937 - sqlalchemy.engine.Engine - INFO - [cached since 0.1428s ago] ()
2025-06-19 19:51:28,937 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:51:28,938 - sqlalchemy.engine.Engine - INFO - [cached since 0.1085s ago] ()
2025-06-19 19:51:28,939 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,942 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,942 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,942 - sqlalchemy.engine.Engine - INFO - [cached since 0.1487s ago] ()
2025-06-19 19:51:28,943 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,944 - sqlalchemy.engine.Engine - INFO - [cached since 0.1412s ago] ('Threats', 'dbo')
2025-06-19 19:51:28,944 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,945 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,946 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,946 - sqlalchemy.engine.Engine - INFO - [cached since 0.1522s ago] ()
2025-06-19 19:51:28,947 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:51:28,947 - sqlalchemy.engine.Engine - INFO - [cached since 0.1033s ago] ()
2025-06-19 19:51:28,948 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,949 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,949 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,949 - sqlalchemy.engine.Engine - INFO - [cached since 0.1555s ago] ()
2025-06-19 19:51:28,950 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,950 - sqlalchemy.engine.Engine - INFO - [cached since 0.1481s ago] ('DetectionRules', 'dbo')
2025-06-19 19:51:28,951 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,952 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,953 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,953 - sqlalchemy.engine.Engine - INFO - [cached since 0.1594s ago] ()
2025-06-19 19:51:28,954 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:51:28,954 - sqlalchemy.engine.Engine - INFO - [cached since 0.09777s ago] ()
2025-06-19 19:51:28,955 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,957 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,957 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,958 - sqlalchemy.engine.Engine - INFO - [cached since 0.1639s ago] ()
2025-06-19 19:51:28,959 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,959 - sqlalchemy.engine.Engine - INFO - [cached since 0.1566s ago] ('SystemConfig', 'dbo')
2025-06-19 19:51:28,960 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,960 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,961 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,961 - sqlalchemy.engine.Engine - INFO - [cached since 0.1674s ago] ()
2025-06-19 19:51:28,962 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:51:28,962 - sqlalchemy.engine.Engine - INFO - [cached since 0.09127s ago] ()
2025-06-19 19:51:28,963 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,963 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,964 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,964 - sqlalchemy.engine.Engine - INFO - [cached since 0.1703s ago] ()
2025-06-19 19:51:28,965 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,965 - sqlalchemy.engine.Engine - INFO - [cached since 0.1628s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:51:28,966 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,967 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,967 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,967 - sqlalchemy.engine.Engine - INFO - [cached since 0.1733s ago] ()
2025-06-19 19:51:28,967 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:51:28,968 - sqlalchemy.engine.Engine - INFO - [cached since 0.09064s ago] ()
2025-06-19 19:51:28,968 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,969 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 19:51:28,969 - sqlalchemy.engine.Engine - INFO - [cached since 0.0897s ago] ()
2025-06-19 19:51:28,970 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,970 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,971 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,971 - sqlalchemy.engine.Engine - INFO - [cached since 0.177s ago] ()
2025-06-19 19:51:28,971 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,971 - sqlalchemy.engine.Engine - INFO - [cached since 0.1691s ago] ('Agents', 'dbo')
2025-06-19 19:51:28,972 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,973 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,973 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,973 - sqlalchemy.engine.Engine - INFO - [cached since 0.1796s ago] ()
2025-06-19 19:51:28,974 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:51:28,974 - sqlalchemy.engine.Engine - INFO - [cached since 0.1599s ago] ()
2025-06-19 19:51:28,975 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,976 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,977 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,977 - sqlalchemy.engine.Engine - INFO - [cached since 0.1834s ago] ()
2025-06-19 19:51:28,978 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,979 - sqlalchemy.engine.Engine - INFO - [cached since 0.1764s ago] ('Events', 'dbo')
2025-06-19 19:51:28,979 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,980 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,980 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,980 - sqlalchemy.engine.Engine - INFO - [cached since 0.1867s ago] ()
2025-06-19 19:51:28,981 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:51:28,981 - sqlalchemy.engine.Engine - INFO - [cached since 0.1601s ago] ()
2025-06-19 19:51:28,981 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,982 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,982 - sqlalchemy.engine.Engine - INFO - [cached since 0.1887s ago] ()
2025-06-19 19:51:28,983 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,983 - sqlalchemy.engine.Engine - INFO - [cached since 0.1808s ago] ('Alerts', 'dbo')
2025-06-19 19:51:28,984 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,984 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,985 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,985 - sqlalchemy.engine.Engine - INFO - [cached since 0.1912s ago] ()
2025-06-19 19:51:28,986 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:51:28,986 - sqlalchemy.engine.Engine - INFO - [cached since 0.1564s ago] ()
2025-06-19 19:51:28,986 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,987 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,987 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,987 - sqlalchemy.engine.Engine - INFO - [cached since 0.1936s ago] ()
2025-06-19 19:51:28,988 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,988 - sqlalchemy.engine.Engine - INFO - [cached since 0.1859s ago] ('Threats', 'dbo')
2025-06-19 19:51:28,989 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,989 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,990 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,990 - sqlalchemy.engine.Engine - INFO - [cached since 0.1961s ago] ()
2025-06-19 19:51:28,990 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:51:28,990 - sqlalchemy.engine.Engine - INFO - [cached since 0.1468s ago] ()
2025-06-19 19:51:28,991 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,991 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,992 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,992 - sqlalchemy.engine.Engine - INFO - [cached since 0.1981s ago] ()
2025-06-19 19:51:28,992 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,992 - sqlalchemy.engine.Engine - INFO - [cached since 0.1901s ago] ('DetectionRules', 'dbo')
2025-06-19 19:51:28,993 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,993 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,994 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,994 - sqlalchemy.engine.Engine - INFO - [cached since 0.2s ago] ()
2025-06-19 19:51:28,994 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:51:28,994 - sqlalchemy.engine.Engine - INFO - [cached since 0.1378s ago] ()
2025-06-19 19:51:28,995 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,995 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,995 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,996 - sqlalchemy.engine.Engine - INFO - [cached since 0.2019s ago] ()
2025-06-19 19:51:28,996 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:28,996 - sqlalchemy.engine.Engine - INFO - [cached since 0.194s ago] ('SystemConfig', 'dbo')
2025-06-19 19:51:28,997 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:28,997 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:28,998 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:28,998 - sqlalchemy.engine.Engine - INFO - [cached since 0.204s ago] ()
2025-06-19 19:51:28,998 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:51:28,999 - sqlalchemy.engine.Engine - INFO - [cached since 0.1277s ago] ()
2025-06-19 19:51:28,999 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:29,000 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:29,000 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:29,000 - sqlalchemy.engine.Engine - INFO - [cached since 0.2063s ago] ()
2025-06-19 19:51:29,001 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:51:29,001 - sqlalchemy.engine.Engine - INFO - [cached since 0.1985s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:51:29,001 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:29,002 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:29,002 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:29,002 - sqlalchemy.engine.Engine - INFO - [cached since 0.2085s ago] ()
2025-06-19 19:51:29,003 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:51:29,003 - sqlalchemy.engine.Engine - INFO - [cached since 0.1259s ago] ()
2025-06-19 19:51:29,003 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:29,004 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:29,005 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:29,005 - sqlalchemy.engine.Engine - INFO - [cached since 0.211s ago] ()
2025-06-19 19:51:29,005 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Agents 
                    WHERE LastHeartbeat >= DATEADD(minute, -10, GETDATE())
                    AND Status = 'Active'
                
2025-06-19 19:51:29,006 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ()
2025-06-19 19:51:29,013 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Events 
                    WHERE CreatedAt >= DATEADD(hour, -1, GETDATE())
                
2025-06-19 19:51:29,014 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ()
2025-06-19 19:51:29,015 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                
2025-06-19 19:51:29,016 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] ()
2025-06-19 19:51:29,017 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                    AND Severity IN ('High', 'Critical')
                
2025-06-19 19:51:29,017 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2025-06-19 19:51:29,020 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM DetectionRules 
                    WHERE IsActive = 1
                
2025-06-19 19:51:29,020 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2025-06-19 19:51:29,022 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Threats 
                    WHERE IsActive = 1
                
2025-06-19 19:51:29,022 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ()
2025-06-19 19:51:29,023 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:51:29,023 - app.database - INFO - ‚úÖ Database health check passed in 102ms
2025-06-19 19:51:29,024 - __main__ - INFO - ‚úÖ Database connected: EDR_System on Manh
2025-06-19 19:51:29,024 - __main__ - INFO - ‚è±Ô∏è Response time: 102ms
2025-06-19 19:51:29,024 - __main__ - INFO - üìä Agents: 1 records
2025-06-19 19:51:29,024 - __main__ - INFO - üìä Events: 0 records
2025-06-19 19:51:29,024 - __main__ - INFO - üìä Alerts: 0 records
2025-06-19 19:51:29,024 - __main__ - INFO - üìä Threats: 12 records
2025-06-19 19:51:29,024 - __main__ - INFO - üìä DetectionRules: 7 records
2025-06-19 19:51:29,024 - __main__ - INFO - üìä SystemConfig: 10 records
2025-06-19 19:51:29,025 - __main__ - INFO - üìä AgentConfigs: 0 records
2025-06-19 19:51:29,025 - __main__ - INFO - üîÑ Active agents (last 10min): 1
2025-06-19 19:51:29,025 - __main__ - INFO - üìà Events (last hour): 0
2025-06-19 19:51:29,025 - __main__ - INFO - üö® Open alerts: 0
2025-06-19 19:51:29,025 - __main__ - INFO - üõ°Ô∏è Active detection rules: 7
2025-06-19 19:51:29,025 - __main__ - INFO - üîç Active threat indicators: 12
2025-06-19 19:51:29,053 - __main__ - INFO - üß™ Testing database schema compliance...
2025-06-19 19:51:29,053 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:51:29,054 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:51:29,054 - sqlalchemy.engine.Engine - INFO - [cached since 0.2603s ago] ()
2025-06-19 19:51:29,062 - sqlalchemy.engine.Engine - INFO - INSERT INTO [Agents] ([AgentID], [HostName], [IPAddress], [MACAddress], [OperatingSystem], [OSVersion], [Architecture], [Domain], [AgentVersion], [InstallPath], [Status], [LastHeartbeat], [FirstSeen], [CPUUsage], [MemoryUsage], [DiskUsage], [NetworkLatency], [MonitoringEnabled], [CreatedAt], [UpdatedAt]) OUTPUT inserted.[LastHeartbeat], inserted.[FirstSeen], inserted.[CreatedAt], inserted.[UpdatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate(), getdate(), ?, ?, ?, ?, ?, getdate(), getdate())
2025-06-19 19:51:29,062 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] (UUID('a2b788c8-5e84-45ef-a526-36c1b63d74cb'), 'TEST-SCHEMA-001', '192.168.20.200', None, 'Windows 11 Pro', None, None, None, '1.0.0', None, 'Active', 0.0, 0.0, 0.0, 0, 1)
2025-06-19 19:51:29,076 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:51:29,076 - app.database - ERROR - üîí Database integrity error: (pyodbc.IntegrityError) ('23000', "[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Violation of UNIQUE KEY constraint 'UK_Agents_HostName'. Cannot insert duplicate key in object 'dbo.Agents'. The duplicate key value is (TEST-SCHEMA-001). (2627) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)")
[SQL: INSERT INTO [Agents] ([AgentID], [HostName], [IPAddress], [MACAddress], [OperatingSystem], [OSVersion], [Architecture], [Domain], [AgentVersion], [InstallPath], [Status], [LastHeartbeat], [FirstSeen], [CPUUsage], [MemoryUsage], [DiskUsage], [NetworkLatency], [MonitoringEnabled], [CreatedAt], [UpdatedAt]) OUTPUT inserted.[LastHeartbeat], inserted.[FirstSeen], inserted.[CreatedAt], inserted.[UpdatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate(), getdate(), ?, ?, ?, ?, ?, getdate(), getdate())]
[parameters: (UUID('a2b788c8-5e84-45ef-a526-36c1b63d74cb'), 'TEST-SCHEMA-001', '192.168.20.200', None, 'Windows 11 Pro', None, None, None, '1.0.0', None, 'Active', 0.0, 0.0, 0.0, 0, 1)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-19 19:51:29,077 - __main__ - ERROR - ‚ùå Database schema test failed: Data integrity violation: (pyodbc.IntegrityError) ('23000', "[23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Violation of UNIQUE KEY constraint 'UK_Agents_HostName'. Cannot insert duplicate key in object 'dbo.Agents'. The duplicate key value is (TEST-SCHEMA-001). (2627) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]The statement has been terminated. (3621)")
[SQL: INSERT INTO [Agents] ([AgentID], [HostName], [IPAddress], [MACAddress], [OperatingSystem], [OSVersion], [Architecture], [Domain], [AgentVersion], [InstallPath], [Status], [LastHeartbeat], [FirstSeen], [CPUUsage], [MemoryUsage], [DiskUsage], [NetworkLatency], [MonitoringEnabled], [CreatedAt], [UpdatedAt]) OUTPUT inserted.[LastHeartbeat], inserted.[FirstSeen], inserted.[CreatedAt], inserted.[UpdatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate(), getdate(), ?, ?, ?, ?, ?, getdate(), getdate())]
[parameters: (UUID('a2b788c8-5e84-45ef-a526-36c1b63d74cb'), 'TEST-SCHEMA-001', '192.168.20.200', None, 'Windows 11 Pro', None, None, None, '1.0.0', None, 'Active', 0.0, 0.0, 0.0, 0, 1)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-19 19:51:29,077 - __main__ - ERROR - ‚ùå Database schema test failed - cannot start server
2025-06-19 19:51:29,077 - app.database - INFO - üîÑ Shutting down database connections...
2025-06-19 19:51:29,078 - app.database - INFO - üßπ Database engine disposed successfully
2025-06-19 19:51:29,078 - app.database - INFO - üßπ Database cleanup completed
2025-06-19 19:51:29,078 - app.database - INFO - ‚úÖ Database shutdown completed
2025-06-19 19:54:16,267 - __main__ - INFO - üöÄ EDR Agent Communication Server - Startup Initiated
2025-06-19 19:54:16,270 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 19:54:16,270 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 19:54:16,523 - app.database - INFO - üîó Initializing database connection to: MANH/EDR_System
2025-06-19 19:54:16,538 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-19 19:54:16,539 - __main__ - INFO - üóÑÔ∏è Testing database connection...
2025-06-19 19:54:16,539 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-19 19:54:16,597 - sqlalchemy.engine.Engine - INFO - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-19 19:54:16,597 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-19 19:54:16,598 - sqlalchemy.engine.Engine - INFO - SELECT schema_name()
2025-06-19 19:54:16,598 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ()
2025-06-19 19:54:16,608 - sqlalchemy.engine.Engine - INFO - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-19 19:54:16,608 - sqlalchemy.engine.Engine - INFO - [generated in 0.00057s] ()
2025-06-19 19:54:16,609 - sqlalchemy.engine.Engine - INFO - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-19 19:54:16,609 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ()
2025-06-19 19:54:16,649 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,650 - sqlalchemy.engine.Engine - INFO - SELECT 1 as test, GETDATE() as server_time
2025-06-19 19:54:16,650 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] ()
2025-06-19 19:54:16,650 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 19:54:16,651 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:54:16,652 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,652 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,652 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] ()
2025-06-19 19:54:16,653 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name
                
2025-06-19 19:54:16,653 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ()
2025-06-19 19:54:16,659 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,660 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,660 - sqlalchemy.engine.Engine - INFO - [cached since 0.007869s ago] ()
2025-06-19 19:54:16,661 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,661 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ('Agents', 'dbo')
2025-06-19 19:54:16,670 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,671 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,671 - sqlalchemy.engine.Engine - INFO - [cached since 0.01935s ago] ()
2025-06-19 19:54:16,672 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:54:16,672 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ()
2025-06-19 19:54:16,673 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,674 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,674 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,674 - sqlalchemy.engine.Engine - INFO - [cached since 0.02231s ago] ()
2025-06-19 19:54:16,675 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,675 - sqlalchemy.engine.Engine - INFO - [cached since 0.01437s ago] ('Events', 'dbo')
2025-06-19 19:54:16,676 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,676 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,676 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,677 - sqlalchemy.engine.Engine - INFO - [cached since 0.02452s ago] ()
2025-06-19 19:54:16,677 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:54:16,677 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ()
2025-06-19 19:54:16,679 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,680 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,680 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,680 - sqlalchemy.engine.Engine - INFO - [cached since 0.02823s ago] ()
2025-06-19 19:54:16,681 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,681 - sqlalchemy.engine.Engine - INFO - [cached since 0.02026s ago] ('Alerts', 'dbo')
2025-06-19 19:54:16,682 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,682 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,682 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,683 - sqlalchemy.engine.Engine - INFO - [cached since 0.0305s ago] ()
2025-06-19 19:54:16,683 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:54:16,683 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-06-19 19:54:16,684 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,685 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,685 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,686 - sqlalchemy.engine.Engine - INFO - [cached since 0.03348s ago] ()
2025-06-19 19:54:16,686 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,686 - sqlalchemy.engine.Engine - INFO - [cached since 0.02561s ago] ('Threats', 'dbo')
2025-06-19 19:54:16,693 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,695 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,695 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,695 - sqlalchemy.engine.Engine - INFO - [cached since 0.04318s ago] ()
2025-06-19 19:54:16,696 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:54:16,696 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ()
2025-06-19 19:54:16,698 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,698 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,699 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,699 - sqlalchemy.engine.Engine - INFO - [cached since 0.04669s ago] ()
2025-06-19 19:54:16,699 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,700 - sqlalchemy.engine.Engine - INFO - [cached since 0.0388s ago] ('DetectionRules', 'dbo')
2025-06-19 19:54:16,711 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,712 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,712 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,713 - sqlalchemy.engine.Engine - INFO - [cached since 0.0606s ago] ()
2025-06-19 19:54:16,713 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:54:16,714 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ()
2025-06-19 19:54:16,716 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,717 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,717 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,718 - sqlalchemy.engine.Engine - INFO - [cached since 0.06555s ago] ()
2025-06-19 19:54:16,718 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,719 - sqlalchemy.engine.Engine - INFO - [cached since 0.05794s ago] ('SystemConfig', 'dbo')
2025-06-19 19:54:16,729 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,731 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,731 - sqlalchemy.engine.Engine - INFO - [cached since 0.07887s ago] ()
2025-06-19 19:54:16,732 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:54:16,732 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ()
2025-06-19 19:54:16,734 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,735 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,735 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,736 - sqlalchemy.engine.Engine - INFO - [cached since 0.08361s ago] ()
2025-06-19 19:54:16,737 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,737 - sqlalchemy.engine.Engine - INFO - [cached since 0.07621s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:54:16,738 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,739 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,739 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,739 - sqlalchemy.engine.Engine - INFO - [cached since 0.08684s ago] ()
2025-06-19 19:54:16,739 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:54:16,740 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] ()
2025-06-19 19:54:16,741 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,741 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 19:54:16,742 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] ()
2025-06-19 19:54:16,750 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,751 - app.database - INFO - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-19 19:54:16,751 - app.database - INFO - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-19 19:54:16,752 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,752 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,752 - sqlalchemy.engine.Engine - INFO - [cached since 0.1003s ago] ()
2025-06-19 19:54:16,753 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,753 - sqlalchemy.engine.Engine - INFO - [cached since 0.09265s ago] ('Agents', 'dbo')
2025-06-19 19:54:16,754 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,755 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,755 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,755 - sqlalchemy.engine.Engine - INFO - [cached since 0.1033s ago] ()
2025-06-19 19:54:16,756 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,756 - sqlalchemy.engine.Engine - INFO - [cached since 0.09527s ago] ('Events', 'dbo')
2025-06-19 19:54:16,757 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,758 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,758 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,758 - sqlalchemy.engine.Engine - INFO - [cached since 0.1063s ago] ()
2025-06-19 19:54:16,759 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,759 - sqlalchemy.engine.Engine - INFO - [cached since 0.09851s ago] ('Alerts', 'dbo')
2025-06-19 19:54:16,761 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,762 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,762 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,763 - sqlalchemy.engine.Engine - INFO - [cached since 0.1106s ago] ()
2025-06-19 19:54:16,763 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,764 - sqlalchemy.engine.Engine - INFO - [cached since 0.1029s ago] ('Threats', 'dbo')
2025-06-19 19:54:16,764 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,765 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,766 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,766 - sqlalchemy.engine.Engine - INFO - [cached since 0.1138s ago] ()
2025-06-19 19:54:16,767 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,767 - sqlalchemy.engine.Engine - INFO - [cached since 0.106s ago] ('DetectionRules', 'dbo')
2025-06-19 19:54:16,768 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,769 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,769 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,769 - sqlalchemy.engine.Engine - INFO - [cached since 0.117s ago] ()
2025-06-19 19:54:16,770 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,770 - sqlalchemy.engine.Engine - INFO - [cached since 0.1093s ago] ('SystemConfig', 'dbo')
2025-06-19 19:54:16,771 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,772 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,772 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,773 - sqlalchemy.engine.Engine - INFO - [cached since 0.1204s ago] ()
2025-06-19 19:54:16,773 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,773 - sqlalchemy.engine.Engine - INFO - [cached since 0.1126s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:54:16,774 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,774 - app.database - INFO - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-19 19:54:16,775 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,775 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,776 - sqlalchemy.engine.Engine - INFO - [cached since 0.1236s ago] ()
2025-06-19 19:54:16,776 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:54:16,777 - sqlalchemy.engine.Engine - INFO - [cached since 0.1047s ago] ()
2025-06-19 19:54:16,777 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,778 - app.database - INFO - üìä Agents: 0 records
2025-06-19 19:54:16,778 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,779 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,779 - sqlalchemy.engine.Engine - INFO - [cached since 0.127s ago] ()
2025-06-19 19:54:16,780 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:54:16,780 - sqlalchemy.engine.Engine - INFO - [cached since 0.1032s ago] ()
2025-06-19 19:54:16,781 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,782 - app.database - INFO - üìä Events: 0 records
2025-06-19 19:54:16,782 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,783 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,783 - sqlalchemy.engine.Engine - INFO - [cached since 0.131s ago] ()
2025-06-19 19:54:16,784 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:54:16,784 - sqlalchemy.engine.Engine - INFO - [cached since 0.1011s ago] ()
2025-06-19 19:54:16,785 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,785 - app.database - INFO - üìä Alerts: 0 records
2025-06-19 19:54:16,786 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,786 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,786 - sqlalchemy.engine.Engine - INFO - [cached since 0.1342s ago] ()
2025-06-19 19:54:16,787 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:54:16,787 - sqlalchemy.engine.Engine - INFO - [cached since 0.09127s ago] ()
2025-06-19 19:54:16,788 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,788 - app.database - INFO - üìä Threats: 12 records
2025-06-19 19:54:16,788 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,789 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,789 - sqlalchemy.engine.Engine - INFO - [cached since 0.1369s ago] ()
2025-06-19 19:54:16,789 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:54:16,790 - sqlalchemy.engine.Engine - INFO - [cached since 0.07616s ago] ()
2025-06-19 19:54:16,790 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,791 - app.database - INFO - üìä DetectionRules: 7 records
2025-06-19 19:54:16,791 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,791 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,791 - sqlalchemy.engine.Engine - INFO - [cached since 0.1393s ago] ()
2025-06-19 19:54:16,792 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:54:16,792 - sqlalchemy.engine.Engine - INFO - [cached since 0.06025s ago] ()
2025-06-19 19:54:16,792 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,793 - app.database - INFO - üìä SystemConfig: 10 records
2025-06-19 19:54:16,793 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,794 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,794 - sqlalchemy.engine.Engine - INFO - [cached since 0.1418s ago] ()
2025-06-19 19:54:16,794 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:54:16,795 - sqlalchemy.engine.Engine - INFO - [cached since 0.05526s ago] ()
2025-06-19 19:54:16,795 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,795 - app.database - INFO - üìä AgentConfigs: 0 records
2025-06-19 19:54:16,796 - app.database - INFO - üìà Total EDR records: 29
2025-06-19 19:54:16,796 - __main__ - INFO - ‚úÖ Database connection successful
2025-06-19 19:54:16,796 - __main__ - INFO - ‚úÖ Environment check completed successfully
2025-06-19 19:54:16,796 - __main__ - INFO - üìä Retrieving database information...
2025-06-19 19:54:16,796 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,796 - sqlalchemy.engine.Engine - INFO - SELECT 1 as test, GETDATE() as server_time
2025-06-19 19:54:16,797 - sqlalchemy.engine.Engine - INFO - [cached since 0.1477s ago] ()
2025-06-19 19:54:16,797 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 19:54:16,797 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 19:54:16,798 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,798 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,798 - sqlalchemy.engine.Engine - INFO - [cached since 0.1462s ago] ()
2025-06-19 19:54:16,799 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name
                
2025-06-19 19:54:16,799 - sqlalchemy.engine.Engine - INFO - [cached since 0.1464s ago] ()
2025-06-19 19:54:16,801 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,802 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,802 - sqlalchemy.engine.Engine - INFO - [cached since 0.1497s ago] ()
2025-06-19 19:54:16,803 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,803 - sqlalchemy.engine.Engine - INFO - [cached since 0.142s ago] ('Agents', 'dbo')
2025-06-19 19:54:16,804 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,804 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,805 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,805 - sqlalchemy.engine.Engine - INFO - [cached since 0.1529s ago] ()
2025-06-19 19:54:16,805 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:54:16,806 - sqlalchemy.engine.Engine - INFO - [cached since 0.1337s ago] ()
2025-06-19 19:54:16,806 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,807 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,807 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,807 - sqlalchemy.engine.Engine - INFO - [cached since 0.1549s ago] ()
2025-06-19 19:54:16,807 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,808 - sqlalchemy.engine.Engine - INFO - [cached since 0.1468s ago] ('Events', 'dbo')
2025-06-19 19:54:16,808 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,809 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,809 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,809 - sqlalchemy.engine.Engine - INFO - [cached since 0.1573s ago] ()
2025-06-19 19:54:16,810 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:54:16,810 - sqlalchemy.engine.Engine - INFO - [cached since 0.1329s ago] ()
2025-06-19 19:54:16,810 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,811 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,811 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,811 - sqlalchemy.engine.Engine - INFO - [cached since 0.1592s ago] ()
2025-06-19 19:54:16,812 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,812 - sqlalchemy.engine.Engine - INFO - [cached since 0.1512s ago] ('Alerts', 'dbo')
2025-06-19 19:54:16,813 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,813 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,813 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,814 - sqlalchemy.engine.Engine - INFO - [cached since 0.1615s ago] ()
2025-06-19 19:54:16,814 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:54:16,814 - sqlalchemy.engine.Engine - INFO - [cached since 0.1313s ago] ()
2025-06-19 19:54:16,815 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,815 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,816 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,816 - sqlalchemy.engine.Engine - INFO - [cached since 0.1636s ago] ()
2025-06-19 19:54:16,816 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,816 - sqlalchemy.engine.Engine - INFO - [cached since 0.1556s ago] ('Threats', 'dbo')
2025-06-19 19:54:16,817 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,818 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,818 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,818 - sqlalchemy.engine.Engine - INFO - [cached since 0.1662s ago] ()
2025-06-19 19:54:16,819 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:54:16,819 - sqlalchemy.engine.Engine - INFO - [cached since 0.1232s ago] ()
2025-06-19 19:54:16,819 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,820 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,820 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,820 - sqlalchemy.engine.Engine - INFO - [cached since 0.1683s ago] ()
2025-06-19 19:54:16,821 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,821 - sqlalchemy.engine.Engine - INFO - [cached since 0.1603s ago] ('DetectionRules', 'dbo')
2025-06-19 19:54:16,822 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,822 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,822 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,823 - sqlalchemy.engine.Engine - INFO - [cached since 0.1705s ago] ()
2025-06-19 19:54:16,823 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:54:16,823 - sqlalchemy.engine.Engine - INFO - [cached since 0.1099s ago] ()
2025-06-19 19:54:16,824 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,824 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,825 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,825 - sqlalchemy.engine.Engine - INFO - [cached since 0.1726s ago] ()
2025-06-19 19:54:16,825 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,825 - sqlalchemy.engine.Engine - INFO - [cached since 0.1646s ago] ('SystemConfig', 'dbo')
2025-06-19 19:54:16,826 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,827 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,827 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,827 - sqlalchemy.engine.Engine - INFO - [cached since 0.1752s ago] ()
2025-06-19 19:54:16,828 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:54:16,828 - sqlalchemy.engine.Engine - INFO - [cached since 0.09627s ago] ()
2025-06-19 19:54:16,828 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,829 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,829 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,829 - sqlalchemy.engine.Engine - INFO - [cached since 0.1772s ago] ()
2025-06-19 19:54:16,830 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,830 - sqlalchemy.engine.Engine - INFO - [cached since 0.1691s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:54:16,830 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,831 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,831 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,831 - sqlalchemy.engine.Engine - INFO - [cached since 0.1791s ago] ()
2025-06-19 19:54:16,832 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:54:16,832 - sqlalchemy.engine.Engine - INFO - [cached since 0.0924s ago] ()
2025-06-19 19:54:16,832 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,833 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 19:54:16,833 - sqlalchemy.engine.Engine - INFO - [cached since 0.09171s ago] ()
2025-06-19 19:54:16,833 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,834 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,834 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,834 - sqlalchemy.engine.Engine - INFO - [cached since 0.1823s ago] ()
2025-06-19 19:54:16,835 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,835 - sqlalchemy.engine.Engine - INFO - [cached since 0.1743s ago] ('Agents', 'dbo')
2025-06-19 19:54:16,836 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,836 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,837 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,837 - sqlalchemy.engine.Engine - INFO - [cached since 0.1847s ago] ()
2025-06-19 19:54:16,837 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 19:54:16,837 - sqlalchemy.engine.Engine - INFO - [cached since 0.1654s ago] ()
2025-06-19 19:54:16,838 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,838 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,839 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,839 - sqlalchemy.engine.Engine - INFO - [cached since 0.1868s ago] ()
2025-06-19 19:54:16,839 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,840 - sqlalchemy.engine.Engine - INFO - [cached since 0.1788s ago] ('Events', 'dbo')
2025-06-19 19:54:16,840 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,841 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,841 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,842 - sqlalchemy.engine.Engine - INFO - [cached since 0.1894s ago] ()
2025-06-19 19:54:16,842 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 19:54:16,842 - sqlalchemy.engine.Engine - INFO - [cached since 0.1651s ago] ()
2025-06-19 19:54:16,843 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,843 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,844 - sqlalchemy.engine.Engine - INFO - [cached since 0.1914s ago] ()
2025-06-19 19:54:16,844 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,844 - sqlalchemy.engine.Engine - INFO - [cached since 0.1835s ago] ('Alerts', 'dbo')
2025-06-19 19:54:16,845 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,846 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,846 - sqlalchemy.engine.Engine - INFO - [cached since 0.1939s ago] ()
2025-06-19 19:54:16,846 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 19:54:16,847 - sqlalchemy.engine.Engine - INFO - [cached since 0.1636s ago] ()
2025-06-19 19:54:16,847 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,848 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,848 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,848 - sqlalchemy.engine.Engine - INFO - [cached since 0.1959s ago] ()
2025-06-19 19:54:16,849 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,849 - sqlalchemy.engine.Engine - INFO - [cached since 0.188s ago] ('Threats', 'dbo')
2025-06-19 19:54:16,849 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,850 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,850 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,850 - sqlalchemy.engine.Engine - INFO - [cached since 0.1982s ago] ()
2025-06-19 19:54:16,851 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 19:54:16,851 - sqlalchemy.engine.Engine - INFO - [cached since 0.1555s ago] ()
2025-06-19 19:54:16,852 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,852 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,853 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,853 - sqlalchemy.engine.Engine - INFO - [cached since 0.2007s ago] ()
2025-06-19 19:54:16,854 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,854 - sqlalchemy.engine.Engine - INFO - [cached since 0.1929s ago] ('DetectionRules', 'dbo')
2025-06-19 19:54:16,854 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,855 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,855 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,856 - sqlalchemy.engine.Engine - INFO - [cached since 0.2035s ago] ()
2025-06-19 19:54:16,856 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 19:54:16,856 - sqlalchemy.engine.Engine - INFO - [cached since 0.1428s ago] ()
2025-06-19 19:54:16,857 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,857 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,858 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,858 - sqlalchemy.engine.Engine - INFO - [cached since 0.2056s ago] ()
2025-06-19 19:54:16,858 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,858 - sqlalchemy.engine.Engine - INFO - [cached since 0.1976s ago] ('SystemConfig', 'dbo')
2025-06-19 19:54:16,859 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,859 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,860 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,860 - sqlalchemy.engine.Engine - INFO - [cached since 0.2077s ago] ()
2025-06-19 19:54:16,860 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 19:54:16,860 - sqlalchemy.engine.Engine - INFO - [cached since 0.1286s ago] ()
2025-06-19 19:54:16,861 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,861 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,862 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,862 - sqlalchemy.engine.Engine - INFO - [cached since 0.2097s ago] ()
2025-06-19 19:54:16,862 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 19:54:16,863 - sqlalchemy.engine.Engine - INFO - [cached since 0.2018s ago] ('AgentConfigs', 'dbo')
2025-06-19 19:54:16,863 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,864 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,864 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,864 - sqlalchemy.engine.Engine - INFO - [cached since 0.2121s ago] ()
2025-06-19 19:54:16,865 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 19:54:16,865 - sqlalchemy.engine.Engine - INFO - [cached since 0.1254s ago] ()
2025-06-19 19:54:16,865 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,866 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,866 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,866 - sqlalchemy.engine.Engine - INFO - [cached since 0.2141s ago] ()
2025-06-19 19:54:16,867 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Agents 
                    WHERE LastHeartbeat >= DATEADD(minute, -10, GETDATE())
                    AND Status = 'Active'
                
2025-06-19 19:54:16,867 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ()
2025-06-19 19:54:16,869 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Events 
                    WHERE CreatedAt >= DATEADD(hour, -1, GETDATE())
                
2025-06-19 19:54:16,869 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ()
2025-06-19 19:54:16,872 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                
2025-06-19 19:54:16,872 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ()
2025-06-19 19:54:16,874 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                    AND Severity IN ('High', 'Critical')
                
2025-06-19 19:54:16,874 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-06-19 19:54:16,877 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM DetectionRules 
                    WHERE IsActive = 1
                
2025-06-19 19:54:16,878 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ()
2025-06-19 19:54:16,879 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Threats 
                    WHERE IsActive = 1
                
2025-06-19 19:54:16,879 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ()
2025-06-19 19:54:16,881 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,881 - app.database - INFO - ‚úÖ Database health check passed in 85ms
2025-06-19 19:54:16,881 - __main__ - INFO - ‚úÖ Database connected: EDR_System on Manh
2025-06-19 19:54:16,881 - __main__ - INFO - ‚è±Ô∏è Response time: 85ms
2025-06-19 19:54:16,882 - __main__ - INFO - üìä Agents: 0 records
2025-06-19 19:54:16,882 - __main__ - INFO - üìä Events: 0 records
2025-06-19 19:54:16,882 - __main__ - INFO - üìä Alerts: 0 records
2025-06-19 19:54:16,882 - __main__ - INFO - üìä Threats: 12 records
2025-06-19 19:54:16,882 - __main__ - INFO - üìä DetectionRules: 7 records
2025-06-19 19:54:16,882 - __main__ - INFO - üìä SystemConfig: 10 records
2025-06-19 19:54:16,882 - __main__ - INFO - üìä AgentConfigs: 0 records
2025-06-19 19:54:16,882 - __main__ - INFO - üîÑ Active agents (last 10min): 0
2025-06-19 19:54:16,883 - __main__ - INFO - üìà Events (last hour): 0
2025-06-19 19:54:16,883 - __main__ - INFO - üö® Open alerts: 0
2025-06-19 19:54:16,883 - __main__ - INFO - üõ°Ô∏è Active detection rules: 7
2025-06-19 19:54:16,883 - __main__ - INFO - üîç Active threat indicators: 12
2025-06-19 19:54:16,902 - __main__ - INFO - üß™ Testing database schema compliance...
2025-06-19 19:54:16,903 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,903 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 19:54:16,903 - sqlalchemy.engine.Engine - INFO - [cached since 0.2512s ago] ()
2025-06-19 19:54:16,913 - sqlalchemy.engine.Engine - INFO - SELECT [Agents].[AgentID] AS [Agents_AgentID], [Agents].[HostName] AS [Agents_HostName], [Agents].[IPAddress] AS [Agents_IPAddress], [Agents].[MACAddress] AS [Agents_MACAddress], [Agents].[OperatingSystem] AS [Agents_OperatingSystem], [Agents].[OSVersion] AS [Agents_OSVersion], [Agents].[Architecture] AS [Agents_Architecture], [Agents].[Domain] AS [Agents_Domain], [Agents].[AgentVersion] AS [Agents_AgentVersion], [Agents].[InstallPath] AS [Agents_InstallPath], [Agents].[Status] AS [Agents_Status], [Agents].[LastHeartbeat] AS [Agents_LastHeartbeat], [Agents].[FirstSeen] AS [Agents_FirstSeen], [Agents].[CPUUsage] AS [Agents_CPUUsage], [Agents].[MemoryUsage] AS [Agents_MemoryUsage], [Agents].[DiskUsage] AS [Agents_DiskUsage], [Agents].[NetworkLatency] AS [Agents_NetworkLatency], [Agents].[MonitoringEnabled] AS [Agents_MonitoringEnabled], [Agents].[CreatedAt] AS [Agents_CreatedAt], [Agents].[UpdatedAt] AS [Agents_UpdatedAt] 
FROM [Agents] 
WHERE [Agents].[HostName] LIKE ?
2025-06-19 19:54:16,914 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] ('TEST-SCHEMA-%',)
2025-06-19 19:54:16,919 - sqlalchemy.engine.Engine - INFO - INSERT INTO [Agents] ([AgentID], [HostName], [IPAddress], [MACAddress], [OperatingSystem], [OSVersion], [Architecture], [Domain], [AgentVersion], [InstallPath], [Status], [LastHeartbeat], [FirstSeen], [CPUUsage], [MemoryUsage], [DiskUsage], [NetworkLatency], [MonitoringEnabled], [CreatedAt], [UpdatedAt]) OUTPUT inserted.[LastHeartbeat], inserted.[FirstSeen], inserted.[CreatedAt], inserted.[UpdatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate(), getdate(), ?, ?, ?, ?, ?, getdate(), getdate())
2025-06-19 19:54:16,920 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] (UUID('138f09e4-abfb-47d7-8ec6-665920d62602'), 'TEST-SCHEMA-1750337656-bec31e52', '192.168.20.200', None, 'Windows 11 Pro', None, None, None, '1.0.0', None, 'Active', 0.0, 0.0, 0.0, 0, 1)
2025-06-19 19:54:16,924 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,925 - __main__ - INFO - ‚úÖ Agent test successful: 138f09e4-abfb-47d7-8ec6-665920d62602
2025-06-19 19:54:16,925 - __main__ - INFO - ‚úÖ Test hostname: TEST-SCHEMA-1750337656-bec31e52
2025-06-19 19:54:16,926 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 19:54:16,927 - sqlalchemy.engine.Engine - INFO - DELETE FROM [Agents] WHERE [Agents].[AgentID] = ?
2025-06-19 19:54:16,928 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] (UUID('138f09e4-abfb-47d7-8ec6-665920d62602'),)
2025-06-19 19:54:16,936 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 19:54:16,937 - __main__ - INFO - üßπ Test agent cleaned up
2025-06-19 19:54:16,937 - __main__ - INFO - ‚úÖ Database schema test completed successfully
2025-06-19 19:54:16,937 - __main__ - INFO - ‚ö†Ô∏è Event table testing skipped due to trigger compatibility
2025-06-19 19:54:16,937 - __main__ - INFO - üéØ Final startup preparations...
2025-06-19 19:54:16,937 - __main__ - INFO - üåê Server will bind to: 192.168.20.85:5000
2025-06-19 19:54:16,938 - __main__ - INFO - üîÑ Reload mode: Enabled
2025-06-19 19:54:16,938 - __main__ - INFO - üêõ Debug mode: Enabled
2025-06-19 19:54:16,938 - __main__ - INFO - üîß IMPORTANT NOTES:
2025-06-19 19:54:16,938 - __main__ - INFO -    ‚Ä¢ Trigger issues have been resolved
2025-06-19 19:54:16,938 - __main__ - INFO -    ‚Ä¢ Server should start successfully now
2025-06-19 19:54:16,938 - __main__ - INFO -    ‚Ä¢ Check /docs for API documentation once server starts
2025-06-19 19:54:16,938 - __main__ - INFO -    ‚Ä¢ Check /health for system status
2025-06-19 19:54:16,938 - __main__ - INFO - üöÄ Starting EDR Agent Communication Server...
2025-06-19 20:06:02,014 - app.database - INFO - üîÑ Shutting down database connections...
2025-06-19 20:06:02,016 - app.database - INFO - üßπ Database engine disposed successfully
2025-06-19 20:06:02,017 - app.database - INFO - üßπ Database cleanup completed
2025-06-19 20:06:02,017 - app.database - INFO - ‚úÖ Database shutdown completed
2025-06-19 20:06:04,812 - __main__ - INFO - üöÄ EDR Agent Communication Server - Network Production Startup
2025-06-19 20:06:04,815 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 20:06:04,816 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 20:06:04,816 - __main__ - INFO - üåê Testing network connectivity to SQL Server: MANH
2025-06-19 20:06:06,865 - __main__ - ERROR - ‚ùå Cannot connect to SQL Server at MANH:1433
2025-06-19 20:06:06,865 - __main__ - ERROR - üí° Possible issues:
2025-06-19 20:06:06,866 - __main__ - ERROR -    ‚Ä¢ SQL Server is not running
2025-06-19 20:06:06,866 - __main__ - ERROR -    ‚Ä¢ Firewall is blocking the connection
2025-06-19 20:06:06,866 - __main__ - ERROR -    ‚Ä¢ Wrong server address or port
2025-06-19 20:06:06,866 - __main__ - ERROR -    ‚Ä¢ Network connectivity issues
2025-06-19 20:06:06,866 - __main__ - ERROR - ‚ùå Environment check failed - cannot start server
2025-06-19 20:06:06,866 - __main__ - ERROR - üí° Please check:
2025-06-19 20:06:06,867 - __main__ - ERROR -    ‚Ä¢ SQL Server is running and accessible
2025-06-19 20:06:06,867 - __main__ - ERROR -    ‚Ä¢ Network connectivity to database server
2025-06-19 20:06:06,867 - __main__ - ERROR -    ‚Ä¢ Firewall settings
2025-06-19 20:06:06,867 - __main__ - ERROR -    ‚Ä¢ Database exists and permissions are correct
2025-06-19 20:09:52,063 - __main__ - INFO - üöÄ EDR Agent Communication Server - Network Production Startup
2025-06-19 20:09:52,075 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 20:09:52,075 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 20:09:52,075 - __main__ - INFO - üåê Testing network connectivity to SQL Server: MANH
2025-06-19 20:09:54,103 - __main__ - ERROR - ‚ùå Cannot connect to SQL Server at MANH:1433
2025-06-19 20:09:54,103 - __main__ - ERROR - üí° Possible issues:
2025-06-19 20:09:54,104 - __main__ - ERROR -    ‚Ä¢ SQL Server is not running
2025-06-19 20:09:54,104 - __main__ - ERROR -    ‚Ä¢ Firewall is blocking the connection
2025-06-19 20:09:54,104 - __main__ - ERROR -    ‚Ä¢ Wrong server address or port
2025-06-19 20:09:54,104 - __main__ - ERROR -    ‚Ä¢ Network connectivity issues
2025-06-19 20:09:54,105 - __main__ - ERROR - ‚ùå Environment check failed - cannot start server
2025-06-19 20:09:54,105 - __main__ - ERROR - üí° Please check:
2025-06-19 20:09:54,105 - __main__ - ERROR -    ‚Ä¢ SQL Server is running and accessible
2025-06-19 20:09:54,105 - __main__ - ERROR -    ‚Ä¢ Network connectivity to database server
2025-06-19 20:09:54,105 - __main__ - ERROR -    ‚Ä¢ Firewall settings
2025-06-19 20:09:54,105 - __main__ - ERROR -    ‚Ä¢ Database exists and permissions are correct
2025-06-19 20:10:01,214 - __main__ - INFO - üöÄ EDR Agent Communication Server - Network Production Startup
2025-06-19 20:10:01,226 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 20:10:01,226 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 20:10:01,227 - __main__ - INFO - üåê Testing network connectivity to SQL Server: MANH
2025-06-19 20:10:03,292 - __main__ - ERROR - ‚ùå Cannot connect to SQL Server at MANH:1433
2025-06-19 20:10:03,293 - __main__ - ERROR - üí° Possible issues:
2025-06-19 20:10:03,293 - __main__ - ERROR -    ‚Ä¢ SQL Server is not running
2025-06-19 20:10:03,293 - __main__ - ERROR -    ‚Ä¢ Firewall is blocking the connection
2025-06-19 20:10:03,293 - __main__ - ERROR -    ‚Ä¢ Wrong server address or port
2025-06-19 20:10:03,294 - __main__ - ERROR -    ‚Ä¢ Network connectivity issues
2025-06-19 20:10:03,294 - __main__ - ERROR - ‚ùå Environment check failed - cannot start server
2025-06-19 20:10:03,294 - __main__ - ERROR - üí° Please check:
2025-06-19 20:10:03,294 - __main__ - ERROR -    ‚Ä¢ SQL Server is running and accessible
2025-06-19 20:10:03,294 - __main__ - ERROR -    ‚Ä¢ Network connectivity to database server
2025-06-19 20:10:03,294 - __main__ - ERROR -    ‚Ä¢ Firewall settings
2025-06-19 20:10:03,294 - __main__ - ERROR -    ‚Ä¢ Database exists and permissions are correct
2025-06-19 20:10:46,165 - __main__ - INFO - üöÄ EDR Agent Communication Server - Startup Initiated
2025-06-19 20:10:46,169 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 20:10:46,169 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 20:10:46,414 - app.database - INFO - üîó Initializing database connection to: MANH/EDR_System
2025-06-19 20:10:46,429 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-19 20:10:46,429 - __main__ - INFO - üóÑÔ∏è Testing database connection...
2025-06-19 20:10:46,429 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-19 20:10:46,488 - sqlalchemy.engine.Engine - INFO - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-19 20:10:46,488 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-19 20:10:46,489 - sqlalchemy.engine.Engine - INFO - SELECT schema_name()
2025-06-19 20:10:46,490 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ()
2025-06-19 20:10:46,500 - sqlalchemy.engine.Engine - INFO - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-19 20:10:46,500 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ()
2025-06-19 20:10:46,501 - sqlalchemy.engine.Engine - INFO - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-19 20:10:46,501 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ()
2025-06-19 20:10:46,544 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,544 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            1 as test, 
                            GETDATE() as server_time,
                            @@VERSION as version,
                            @@SERVERNAME as server_name,
                            DB_NAME() as database_name
                    
2025-06-19 20:10:46,545 - sqlalchemy.engine.Engine - INFO - [generated in 0.00082s] ()
2025-06-19 20:10:46,545 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/5)
2025-06-19 20:10:46,545 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 20:10:46,546 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,547 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,547 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] ()
2025-06-19 20:10:46,548 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name,
                        @@CONNECTIONS as total_connections,
                        @@CPU_BUSY as cpu_busy,
                        @@IDLE as idle_time
                
2025-06-19 20:10:46,548 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ()
2025-06-19 20:10:46,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,555 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,555 - sqlalchemy.engine.Engine - INFO - [cached since 0.008103s ago] ()
2025-06-19 20:10:46,555 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,556 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('Agents', 'dbo')
2025-06-19 20:10:46,566 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,567 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,568 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,568 - sqlalchemy.engine.Engine - INFO - [cached since 0.02111s ago] ()
2025-06-19 20:10:46,568 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:10:46,569 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ()
2025-06-19 20:10:46,570 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,571 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,572 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,572 - sqlalchemy.engine.Engine - INFO - [cached since 0.02522s ago] ()
2025-06-19 20:10:46,572 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,573 - sqlalchemy.engine.Engine - INFO - [cached since 0.01731s ago] ('Events', 'dbo')
2025-06-19 20:10:46,573 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,574 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,575 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,575 - sqlalchemy.engine.Engine - INFO - [cached since 0.02833s ago] ()
2025-06-19 20:10:46,576 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:10:46,576 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ()
2025-06-19 20:10:46,579 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,580 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,580 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,581 - sqlalchemy.engine.Engine - INFO - [cached since 0.03397s ago] ()
2025-06-19 20:10:46,581 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,582 - sqlalchemy.engine.Engine - INFO - [cached since 0.02613s ago] ('Alerts', 'dbo')
2025-06-19 20:10:46,582 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,583 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,583 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,583 - sqlalchemy.engine.Engine - INFO - [cached since 0.0366s ago] ()
2025-06-19 20:10:46,584 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:10:46,584 - sqlalchemy.engine.Engine - INFO - [generated in 0.00018s] ()
2025-06-19 20:10:46,586 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,587 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,587 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,587 - sqlalchemy.engine.Engine - INFO - [cached since 0.04047s ago] ()
2025-06-19 20:10:46,588 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,588 - sqlalchemy.engine.Engine - INFO - [cached since 0.03242s ago] ('Threats', 'dbo')
2025-06-19 20:10:46,596 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,598 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,598 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,598 - sqlalchemy.engine.Engine - INFO - [cached since 0.05176s ago] ()
2025-06-19 20:10:46,599 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:10:46,599 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ()
2025-06-19 20:10:46,601 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,601 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,602 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,602 - sqlalchemy.engine.Engine - INFO - [cached since 0.05522s ago] ()
2025-06-19 20:10:46,603 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,603 - sqlalchemy.engine.Engine - INFO - [cached since 0.04744s ago] ('DetectionRules', 'dbo')
2025-06-19 20:10:46,610 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,612 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,612 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,612 - sqlalchemy.engine.Engine - INFO - [cached since 0.06549s ago] ()
2025-06-19 20:10:46,613 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:10:46,613 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ()
2025-06-19 20:10:46,614 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,616 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,616 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,616 - sqlalchemy.engine.Engine - INFO - [cached since 0.06955s ago] ()
2025-06-19 20:10:46,617 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,617 - sqlalchemy.engine.Engine - INFO - [cached since 0.06173s ago] ('SystemConfig', 'dbo')
2025-06-19 20:10:46,626 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,627 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,627 - sqlalchemy.engine.Engine - INFO - [cached since 0.08072s ago] ()
2025-06-19 20:10:46,628 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:10:46,628 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-06-19 20:10:46,629 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,630 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,630 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,631 - sqlalchemy.engine.Engine - INFO - [cached since 0.08385s ago] ()
2025-06-19 20:10:46,631 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,631 - sqlalchemy.engine.Engine - INFO - [cached since 0.07581s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:10:46,632 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,632 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,633 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,633 - sqlalchemy.engine.Engine - INFO - [cached since 0.08599s ago] ()
2025-06-19 20:10:46,633 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:10:46,633 - sqlalchemy.engine.Engine - INFO - [generated in 0.00019s] ()
2025-06-19 20:10:46,635 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,636 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 20:10:46,636 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ()
2025-06-19 20:10:46,643 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,644 - app.database - INFO - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-19 20:10:46,644 - app.database - INFO - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-19 20:10:46,644 - app.database - INFO - üë§ Connection User: Manh\manhh
2025-06-19 20:10:46,644 - app.database - INFO - üñ•Ô∏è Host: MANH
2025-06-19 20:10:46,645 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,645 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,645 - sqlalchemy.engine.Engine - INFO - [cached since 0.09862s ago] ()
2025-06-19 20:10:46,646 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,646 - sqlalchemy.engine.Engine - INFO - [cached since 0.09056s ago] ('Agents', 'dbo')
2025-06-19 20:10:46,647 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,647 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,647 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,648 - sqlalchemy.engine.Engine - INFO - [cached since 0.1009s ago] ()
2025-06-19 20:10:46,648 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,648 - sqlalchemy.engine.Engine - INFO - [cached since 0.09291s ago] ('Events', 'dbo')
2025-06-19 20:10:46,649 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,649 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,650 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,650 - sqlalchemy.engine.Engine - INFO - [cached since 0.1032s ago] ()
2025-06-19 20:10:46,650 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,651 - sqlalchemy.engine.Engine - INFO - [cached since 0.09508s ago] ('Alerts', 'dbo')
2025-06-19 20:10:46,651 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,652 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,652 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,653 - sqlalchemy.engine.Engine - INFO - [cached since 0.1059s ago] ()
2025-06-19 20:10:46,653 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,654 - sqlalchemy.engine.Engine - INFO - [cached since 0.09811s ago] ('Threats', 'dbo')
2025-06-19 20:10:46,654 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,655 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,655 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,656 - sqlalchemy.engine.Engine - INFO - [cached since 0.109s ago] ()
2025-06-19 20:10:46,656 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,657 - sqlalchemy.engine.Engine - INFO - [cached since 0.1015s ago] ('DetectionRules', 'dbo')
2025-06-19 20:10:46,658 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,659 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,659 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,660 - sqlalchemy.engine.Engine - INFO - [cached since 0.113s ago] ()
2025-06-19 20:10:46,660 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,661 - sqlalchemy.engine.Engine - INFO - [cached since 0.1052s ago] ('SystemConfig', 'dbo')
2025-06-19 20:10:46,661 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,663 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,663 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,663 - sqlalchemy.engine.Engine - INFO - [cached since 0.1164s ago] ()
2025-06-19 20:10:46,664 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,664 - sqlalchemy.engine.Engine - INFO - [cached since 0.1087s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:10:46,665 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,665 - app.database - INFO - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-19 20:10:46,666 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,666 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,666 - sqlalchemy.engine.Engine - INFO - [cached since 0.1193s ago] ()
2025-06-19 20:10:46,666 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:10:46,667 - sqlalchemy.engine.Engine - INFO - [cached since 0.09819s ago] ()
2025-06-19 20:10:46,667 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,667 - app.database - INFO - üìä Agents: 0 records
2025-06-19 20:10:46,668 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,668 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,668 - sqlalchemy.engine.Engine - INFO - [cached since 0.1218s ago] ()
2025-06-19 20:10:46,669 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:10:46,669 - sqlalchemy.engine.Engine - INFO - [cached since 0.09364s ago] ()
2025-06-19 20:10:46,670 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,670 - app.database - INFO - üìä Events: 0 records
2025-06-19 20:10:46,671 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,671 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,671 - sqlalchemy.engine.Engine - INFO - [cached since 0.1247s ago] ()
2025-06-19 20:10:46,673 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:10:46,673 - sqlalchemy.engine.Engine - INFO - [cached since 0.08936s ago] ()
2025-06-19 20:10:46,674 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,674 - app.database - INFO - üìä Alerts: 0 records
2025-06-19 20:10:46,675 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,675 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,675 - sqlalchemy.engine.Engine - INFO - [cached since 0.1287s ago] ()
2025-06-19 20:10:46,676 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:10:46,676 - sqlalchemy.engine.Engine - INFO - [cached since 0.07703s ago] ()
2025-06-19 20:10:46,677 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,677 - app.database - INFO - üìä Threats: 12 records
2025-06-19 20:10:46,678 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,678 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,678 - sqlalchemy.engine.Engine - INFO - [cached since 0.1313s ago] ()
2025-06-19 20:10:46,678 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:10:46,679 - sqlalchemy.engine.Engine - INFO - [cached since 0.06596s ago] ()
2025-06-19 20:10:46,679 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,680 - app.database - INFO - üìä DetectionRules: 7 records
2025-06-19 20:10:46,680 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,680 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,681 - sqlalchemy.engine.Engine - INFO - [cached since 0.1339s ago] ()
2025-06-19 20:10:46,681 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:10:46,681 - sqlalchemy.engine.Engine - INFO - [cached since 0.05329s ago] ()
2025-06-19 20:10:46,682 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,682 - app.database - INFO - üìä SystemConfig: 10 records
2025-06-19 20:10:46,682 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,683 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,683 - sqlalchemy.engine.Engine - INFO - [cached since 0.1362s ago] ()
2025-06-19 20:10:46,683 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:10:46,684 - sqlalchemy.engine.Engine - INFO - [cached since 0.0505s ago] ()
2025-06-19 20:10:46,684 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,685 - app.database - INFO - üìä AgentConfigs: 0 records
2025-06-19 20:10:46,685 - app.database - INFO - üìà Total EDR records: 29
2025-06-19 20:10:46,685 - __main__ - INFO - ‚úÖ Database connection successful
2025-06-19 20:10:46,685 - __main__ - INFO - ‚úÖ Environment check completed successfully
2025-06-19 20:10:46,685 - __main__ - INFO - üìä Retrieving database information...
2025-06-19 20:10:46,686 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,686 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            1 as test, 
                            GETDATE() as server_time,
                            @@VERSION as version,
                            @@SERVERNAME as server_name,
                            DB_NAME() as database_name
                    
2025-06-19 20:10:46,686 - sqlalchemy.engine.Engine - INFO - [cached since 0.1426s ago] ()
2025-06-19 20:10:46,687 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/5)
2025-06-19 20:10:46,688 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 20:10:46,688 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,689 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,689 - sqlalchemy.engine.Engine - INFO - [cached since 0.1425s ago] ()
2025-06-19 20:10:46,690 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name,
                        @@CONNECTIONS as total_connections,
                        @@CPU_BUSY as cpu_busy,
                        @@IDLE as idle_time
                
2025-06-19 20:10:46,691 - sqlalchemy.engine.Engine - INFO - [cached since 0.1431s ago] ()
2025-06-19 20:10:46,692 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,692 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,692 - sqlalchemy.engine.Engine - INFO - [cached since 0.1456s ago] ()
2025-06-19 20:10:46,693 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,693 - sqlalchemy.engine.Engine - INFO - [cached since 0.1377s ago] ('Agents', 'dbo')
2025-06-19 20:10:46,694 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,695 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,695 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,695 - sqlalchemy.engine.Engine - INFO - [cached since 0.1483s ago] ()
2025-06-19 20:10:46,696 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:10:46,696 - sqlalchemy.engine.Engine - INFO - [cached since 0.1274s ago] ()
2025-06-19 20:10:46,696 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,697 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,697 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,697 - sqlalchemy.engine.Engine - INFO - [cached since 0.1507s ago] ()
2025-06-19 20:10:46,698 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,698 - sqlalchemy.engine.Engine - INFO - [cached since 0.1426s ago] ('Events', 'dbo')
2025-06-19 20:10:46,698 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,699 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,699 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,699 - sqlalchemy.engine.Engine - INFO - [cached since 0.1528s ago] ()
2025-06-19 20:10:46,700 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:10:46,700 - sqlalchemy.engine.Engine - INFO - [cached since 0.1245s ago] ()
2025-06-19 20:10:46,701 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,701 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,701 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,702 - sqlalchemy.engine.Engine - INFO - [cached since 0.155s ago] ()
2025-06-19 20:10:46,702 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,703 - sqlalchemy.engine.Engine - INFO - [cached since 0.1471s ago] ('Alerts', 'dbo')
2025-06-19 20:10:46,703 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,704 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,704 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,704 - sqlalchemy.engine.Engine - INFO - [cached since 0.1576s ago] ()
2025-06-19 20:10:46,705 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:10:46,705 - sqlalchemy.engine.Engine - INFO - [cached since 0.1213s ago] ()
2025-06-19 20:10:46,706 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,706 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,707 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,707 - sqlalchemy.engine.Engine - INFO - [cached since 0.1605s ago] ()
2025-06-19 20:10:46,708 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,708 - sqlalchemy.engine.Engine - INFO - [cached since 0.1526s ago] ('Threats', 'dbo')
2025-06-19 20:10:46,709 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,709 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,710 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,710 - sqlalchemy.engine.Engine - INFO - [cached since 0.1631s ago] ()
2025-06-19 20:10:46,710 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:10:46,711 - sqlalchemy.engine.Engine - INFO - [cached since 0.1114s ago] ()
2025-06-19 20:10:46,711 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,712 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,712 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,712 - sqlalchemy.engine.Engine - INFO - [cached since 0.1657s ago] ()
2025-06-19 20:10:46,713 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,713 - sqlalchemy.engine.Engine - INFO - [cached since 0.1579s ago] ('DetectionRules', 'dbo')
2025-06-19 20:10:46,714 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,715 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,715 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,715 - sqlalchemy.engine.Engine - INFO - [cached since 0.1687s ago] ()
2025-06-19 20:10:46,716 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:10:46,716 - sqlalchemy.engine.Engine - INFO - [cached since 0.1034s ago] ()
2025-06-19 20:10:46,717 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,717 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,717 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,718 - sqlalchemy.engine.Engine - INFO - [cached since 0.171s ago] ()
2025-06-19 20:10:46,718 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,718 - sqlalchemy.engine.Engine - INFO - [cached since 0.163s ago] ('SystemConfig', 'dbo')
2025-06-19 20:10:46,719 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,720 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,720 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,720 - sqlalchemy.engine.Engine - INFO - [cached since 0.1735s ago] ()
2025-06-19 20:10:46,721 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:10:46,721 - sqlalchemy.engine.Engine - INFO - [cached since 0.09313s ago] ()
2025-06-19 20:10:46,722 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,722 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,722 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,723 - sqlalchemy.engine.Engine - INFO - [cached since 0.1759s ago] ()
2025-06-19 20:10:46,723 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,723 - sqlalchemy.engine.Engine - INFO - [cached since 0.1679s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:10:46,724 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,725 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,725 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,725 - sqlalchemy.engine.Engine - INFO - [cached since 0.1782s ago] ()
2025-06-19 20:10:46,725 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:10:46,726 - sqlalchemy.engine.Engine - INFO - [cached since 0.09238s ago] ()
2025-06-19 20:10:46,726 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,726 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 20:10:46,726 - sqlalchemy.engine.Engine - INFO - [cached since 0.09092s ago] ()
2025-06-19 20:10:46,727 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,728 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,728 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,728 - sqlalchemy.engine.Engine - INFO - [cached since 0.1815s ago] ()
2025-06-19 20:10:46,729 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,729 - sqlalchemy.engine.Engine - INFO - [cached since 0.1735s ago] ('Agents', 'dbo')
2025-06-19 20:10:46,729 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,730 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,730 - sqlalchemy.engine.Engine - INFO - [cached since 0.1837s ago] ()
2025-06-19 20:10:46,731 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:10:46,731 - sqlalchemy.engine.Engine - INFO - [cached since 0.1626s ago] ()
2025-06-19 20:10:46,731 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,732 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,732 - sqlalchemy.engine.Engine - INFO - [cached since 0.1856s ago] ()
2025-06-19 20:10:46,733 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,733 - sqlalchemy.engine.Engine - INFO - [cached since 0.1778s ago] ('Events', 'dbo')
2025-06-19 20:10:46,734 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,734 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,735 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,735 - sqlalchemy.engine.Engine - INFO - [cached since 0.1882s ago] ()
2025-06-19 20:10:46,736 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:10:46,736 - sqlalchemy.engine.Engine - INFO - [cached since 0.1603s ago] ()
2025-06-19 20:10:46,736 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,737 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,737 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,738 - sqlalchemy.engine.Engine - INFO - [cached since 0.1909s ago] ()
2025-06-19 20:10:46,738 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,738 - sqlalchemy.engine.Engine - INFO - [cached since 0.1829s ago] ('Alerts', 'dbo')
2025-06-19 20:10:46,739 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,740 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,740 - sqlalchemy.engine.Engine - INFO - [cached since 0.1933s ago] ()
2025-06-19 20:10:46,741 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:10:46,741 - sqlalchemy.engine.Engine - INFO - [cached since 0.1569s ago] ()
2025-06-19 20:10:46,741 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,742 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,742 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,742 - sqlalchemy.engine.Engine - INFO - [cached since 0.1954s ago] ()
2025-06-19 20:10:46,743 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,743 - sqlalchemy.engine.Engine - INFO - [cached since 0.1875s ago] ('Threats', 'dbo')
2025-06-19 20:10:46,743 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,744 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,744 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,745 - sqlalchemy.engine.Engine - INFO - [cached since 0.1979s ago] ()
2025-06-19 20:10:46,745 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:10:46,745 - sqlalchemy.engine.Engine - INFO - [cached since 0.1461s ago] ()
2025-06-19 20:10:46,746 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,746 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,747 - sqlalchemy.engine.Engine - INFO - [cached since 0.1998s ago] ()
2025-06-19 20:10:46,747 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,747 - sqlalchemy.engine.Engine - INFO - [cached since 0.1918s ago] ('DetectionRules', 'dbo')
2025-06-19 20:10:46,748 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,748 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,749 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,749 - sqlalchemy.engine.Engine - INFO - [cached since 0.2023s ago] ()
2025-06-19 20:10:46,749 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:10:46,750 - sqlalchemy.engine.Engine - INFO - [cached since 0.137s ago] ()
2025-06-19 20:10:46,750 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,751 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,751 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,752 - sqlalchemy.engine.Engine - INFO - [cached since 0.2048s ago] ()
2025-06-19 20:10:46,752 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,752 - sqlalchemy.engine.Engine - INFO - [cached since 0.1969s ago] ('SystemConfig', 'dbo')
2025-06-19 20:10:46,753 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,754 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,754 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,755 - sqlalchemy.engine.Engine - INFO - [cached since 0.2079s ago] ()
2025-06-19 20:10:46,755 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:10:46,755 - sqlalchemy.engine.Engine - INFO - [cached since 0.1275s ago] ()
2025-06-19 20:10:46,756 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,757 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,757 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,757 - sqlalchemy.engine.Engine - INFO - [cached since 0.2104s ago] ()
2025-06-19 20:10:46,758 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:10:46,758 - sqlalchemy.engine.Engine - INFO - [cached since 0.2024s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:10:46,758 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,759 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,759 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,759 - sqlalchemy.engine.Engine - INFO - [cached since 0.2127s ago] ()
2025-06-19 20:10:46,760 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:10:46,760 - sqlalchemy.engine.Engine - INFO - [cached since 0.1269s ago] ()
2025-06-19 20:10:46,760 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,761 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,761 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,761 - sqlalchemy.engine.Engine - INFO - [cached since 0.2145s ago] ()
2025-06-19 20:10:46,762 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Agents 
                    WHERE LastHeartbeat >= DATEADD(minute, -10, GETDATE())
                    AND Status = 'Active'
                
2025-06-19 20:10:46,762 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-06-19 20:10:46,763 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Events 
                    WHERE CreatedAt >= DATEADD(hour, -1, GETDATE())
                
2025-06-19 20:10:46,764 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-06-19 20:10:46,765 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                
2025-06-19 20:10:46,765 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] ()
2025-06-19 20:10:46,766 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                    AND Severity IN ('High', 'Critical')
                
2025-06-19 20:10:46,767 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ()
2025-06-19 20:10:46,770 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM DetectionRules 
                    WHERE IsActive = 1
                
2025-06-19 20:10:46,771 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ()
2025-06-19 20:10:46,772 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Threats 
                    WHERE IsActive = 1
                
2025-06-19 20:10:46,773 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ()
2025-06-19 20:10:46,774 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,775 - app.database - INFO - ‚úÖ Database health check passed in 89ms
2025-06-19 20:10:46,775 - __main__ - INFO - ‚úÖ Database connected: EDR_System on Manh
2025-06-19 20:10:46,775 - __main__ - INFO - ‚è±Ô∏è Response time: 89ms
2025-06-19 20:10:46,775 - __main__ - INFO - üìä Agents: 0 records
2025-06-19 20:10:46,775 - __main__ - INFO - üìä Events: 0 records
2025-06-19 20:10:46,775 - __main__ - INFO - üìä Alerts: 0 records
2025-06-19 20:10:46,776 - __main__ - INFO - üìä Threats: 12 records
2025-06-19 20:10:46,776 - __main__ - INFO - üìä DetectionRules: 7 records
2025-06-19 20:10:46,776 - __main__ - INFO - üìä SystemConfig: 10 records
2025-06-19 20:10:46,776 - __main__ - INFO - üìä AgentConfigs: 0 records
2025-06-19 20:10:46,776 - __main__ - INFO - üîÑ Active agents (last 10min): 0
2025-06-19 20:10:46,777 - __main__ - INFO - üìà Events (last hour): 0
2025-06-19 20:10:46,777 - __main__ - INFO - üö® Open alerts: 0
2025-06-19 20:10:46,777 - __main__ - INFO - üõ°Ô∏è Active detection rules: 7
2025-06-19 20:10:46,777 - __main__ - INFO - üîç Active threat indicators: 12
2025-06-19 20:10:46,795 - __main__ - INFO - üß™ Testing database schema compliance...
2025-06-19 20:10:46,796 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,796 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:10:46,797 - sqlalchemy.engine.Engine - INFO - [cached since 0.2499s ago] ()
2025-06-19 20:10:46,805 - sqlalchemy.engine.Engine - INFO - SELECT [Agents].[AgentID] AS [Agents_AgentID], [Agents].[HostName] AS [Agents_HostName], [Agents].[IPAddress] AS [Agents_IPAddress], [Agents].[MACAddress] AS [Agents_MACAddress], [Agents].[OperatingSystem] AS [Agents_OperatingSystem], [Agents].[OSVersion] AS [Agents_OSVersion], [Agents].[Architecture] AS [Agents_Architecture], [Agents].[Domain] AS [Agents_Domain], [Agents].[AgentVersion] AS [Agents_AgentVersion], [Agents].[InstallPath] AS [Agents_InstallPath], [Agents].[Status] AS [Agents_Status], [Agents].[LastHeartbeat] AS [Agents_LastHeartbeat], [Agents].[FirstSeen] AS [Agents_FirstSeen], [Agents].[CPUUsage] AS [Agents_CPUUsage], [Agents].[MemoryUsage] AS [Agents_MemoryUsage], [Agents].[DiskUsage] AS [Agents_DiskUsage], [Agents].[NetworkLatency] AS [Agents_NetworkLatency], [Agents].[MonitoringEnabled] AS [Agents_MonitoringEnabled], [Agents].[CreatedAt] AS [Agents_CreatedAt], [Agents].[UpdatedAt] AS [Agents_UpdatedAt] 
FROM [Agents] 
WHERE [Agents].[HostName] LIKE ?
2025-06-19 20:10:46,805 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] ('TEST-SCHEMA-%',)
2025-06-19 20:10:46,811 - sqlalchemy.engine.Engine - INFO - INSERT INTO [Agents] ([AgentID], [HostName], [IPAddress], [MACAddress], [OperatingSystem], [OSVersion], [Architecture], [Domain], [AgentVersion], [InstallPath], [Status], [LastHeartbeat], [FirstSeen], [CPUUsage], [MemoryUsage], [DiskUsage], [NetworkLatency], [MonitoringEnabled], [CreatedAt], [UpdatedAt]) OUTPUT inserted.[LastHeartbeat], inserted.[FirstSeen], inserted.[CreatedAt], inserted.[UpdatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate(), getdate(), ?, ?, ?, ?, ?, getdate(), getdate())
2025-06-19 20:10:46,811 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] (UUID('b9e601d0-e5ad-4331-8f28-7d4f21254d46'), 'TEST-SCHEMA-1750338646-b08b7bfd', '192.168.20.200', None, 'Windows 11 Pro', None, None, None, '1.0.0', None, 'Active', 0.0, 0.0, 0.0, 0, 1)
2025-06-19 20:10:46,815 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,816 - __main__ - INFO - ‚úÖ Agent test successful: b9e601d0-e5ad-4331-8f28-7d4f21254d46
2025-06-19 20:10:46,817 - __main__ - INFO - ‚úÖ Test hostname: TEST-SCHEMA-1750338646-b08b7bfd
2025-06-19 20:10:46,817 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:10:46,818 - sqlalchemy.engine.Engine - INFO - DELETE FROM [Agents] WHERE [Agents].[AgentID] = ?
2025-06-19 20:10:46,818 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (UUID('b9e601d0-e5ad-4331-8f28-7d4f21254d46'),)
2025-06-19 20:10:46,827 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:10:46,827 - __main__ - INFO - üßπ Test agent cleaned up
2025-06-19 20:10:46,828 - __main__ - INFO - ‚úÖ Database schema test completed successfully
2025-06-19 20:10:46,828 - __main__ - INFO - ‚ö†Ô∏è Event table testing skipped due to trigger compatibility
2025-06-19 20:10:46,828 - __main__ - INFO - üéØ Final startup preparations...
2025-06-19 20:10:46,828 - __main__ - INFO - üåê Server will bind to: 192.168.20.85:5000
2025-06-19 20:10:46,829 - __main__ - INFO - üîÑ Reload mode: Enabled
2025-06-19 20:10:46,829 - __main__ - INFO - üêõ Debug mode: Enabled
2025-06-19 20:10:46,829 - __main__ - INFO - üîß IMPORTANT NOTES:
2025-06-19 20:10:46,829 - __main__ - INFO -    ‚Ä¢ Trigger issues have been resolved
2025-06-19 20:10:46,829 - __main__ - INFO -    ‚Ä¢ Server should start successfully now
2025-06-19 20:10:46,829 - __main__ - INFO -    ‚Ä¢ Check /docs for API documentation once server starts
2025-06-19 20:10:46,830 - __main__ - INFO -    ‚Ä¢ Check /health for system status
2025-06-19 20:10:46,830 - __main__ - INFO - üöÄ Starting EDR Agent Communication Server...
2025-06-19 20:12:20,380 - app.database - INFO - üîÑ Shutting down database connections...
2025-06-19 20:12:20,382 - app.database - INFO - üßπ Database engine disposed successfully
2025-06-19 20:12:20,382 - app.database - INFO - üßπ Database cleanup completed
2025-06-19 20:12:20,382 - app.database - INFO - ‚úÖ Database shutdown completed
2025-06-19 20:12:24,444 - __main__ - INFO - üöÄ EDR Agent Communication Server - Local SQL Startup
2025-06-19 20:12:24,448 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 20:12:24,449 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 20:12:24,449 - __main__ - INFO - üîç Checking SQL Server services...
2025-06-19 20:12:24,473 - __main__ - INFO - ‚úÖ MSSQLSERVER is running
2025-06-19 20:12:24,511 - __main__ - WARNING - ‚ö†Ô∏è SQLBrowser exists but not running
2025-06-19 20:12:24,511 - __main__ - INFO - ‚úÖ Found 1 running SQL Server service(s)
2025-06-19 20:12:24,511 - __main__ - INFO - üîç Testing local SQL Server connections...
2025-06-19 20:12:24,511 - __main__ - INFO - üîå Testing: localhost
2025-06-19 20:12:24,612 - __main__ - INFO - ‚úÖ SUCCESS! Connected to SQL Server via: localhost
2025-06-19 20:12:24,612 - __main__ - INFO -    SQL Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64) 
	Oct  8...
2025-06-19 20:12:24,613 - __main__ - INFO - ‚úÖ EDR_System database found
2025-06-19 20:12:24,613 - __main__ - INFO - üéØ Using SQL Server: localhost
2025-06-19 20:12:24,869 - app.database - INFO - üîó Initializing database connection to: MANH/EDR_System
2025-06-19 20:12:24,884 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-19 20:12:24,884 - __main__ - INFO - üóÑÔ∏è Initializing database...
2025-06-19 20:12:24,884 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-19 20:12:24,914 - sqlalchemy.engine.Engine - INFO - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-19 20:12:24,915 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-19 20:12:24,916 - sqlalchemy.engine.Engine - INFO - SELECT schema_name()
2025-06-19 20:12:24,916 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] ()
2025-06-19 20:12:24,927 - sqlalchemy.engine.Engine - INFO - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-19 20:12:24,928 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ()
2025-06-19 20:12:24,928 - sqlalchemy.engine.Engine - INFO - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-19 20:12:24,929 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ()
2025-06-19 20:12:24,979 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:24,979 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            1 as test, 
                            GETDATE() as server_time,
                            @@VERSION as version,
                            @@SERVERNAME as server_name,
                            DB_NAME() as database_name
                    
2025-06-19 20:12:24,980 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] ()
2025-06-19 20:12:24,980 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/5)
2025-06-19 20:12:24,980 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 20:12:24,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:24,982 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:24,982 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ()
2025-06-19 20:12:24,983 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name,
                        @@CONNECTIONS as total_connections,
                        @@CPU_BUSY as cpu_busy,
                        @@IDLE as idle_time
                
2025-06-19 20:12:24,983 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] ()
2025-06-19 20:12:24,990 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:24,991 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:24,991 - sqlalchemy.engine.Engine - INFO - [cached since 0.009123s ago] ()
2025-06-19 20:12:24,992 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:24,992 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ('Agents', 'dbo')
2025-06-19 20:12:25,005 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,007 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,008 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,008 - sqlalchemy.engine.Engine - INFO - [cached since 0.02605s ago] ()
2025-06-19 20:12:25,009 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:12:25,009 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-06-19 20:12:25,011 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,012 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,012 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,012 - sqlalchemy.engine.Engine - INFO - [cached since 0.03043s ago] ()
2025-06-19 20:12:25,013 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,013 - sqlalchemy.engine.Engine - INFO - [cached since 0.02138s ago] ('Events', 'dbo')
2025-06-19 20:12:25,014 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,016 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,016 - sqlalchemy.engine.Engine - INFO - [cached since 0.03387s ago] ()
2025-06-19 20:12:25,017 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:12:25,017 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] ()
2025-06-19 20:12:25,022 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,023 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,023 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,023 - sqlalchemy.engine.Engine - INFO - [cached since 0.04145s ago] ()
2025-06-19 20:12:25,024 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,024 - sqlalchemy.engine.Engine - INFO - [cached since 0.03232s ago] ('Alerts', 'dbo')
2025-06-19 20:12:25,025 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,026 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,026 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,026 - sqlalchemy.engine.Engine - INFO - [cached since 0.04432s ago] ()
2025-06-19 20:12:25,027 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:12:25,027 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] ()
2025-06-19 20:12:25,029 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,030 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,030 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,031 - sqlalchemy.engine.Engine - INFO - [cached since 0.0486s ago] ()
2025-06-19 20:12:25,032 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,032 - sqlalchemy.engine.Engine - INFO - [cached since 0.03982s ago] ('Threats', 'dbo')
2025-06-19 20:12:25,060 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,061 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,062 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,062 - sqlalchemy.engine.Engine - INFO - [cached since 0.07986s ago] ()
2025-06-19 20:12:25,063 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:12:25,063 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ()
2025-06-19 20:12:25,066 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,067 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,068 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,068 - sqlalchemy.engine.Engine - INFO - [cached since 0.08617s ago] ()
2025-06-19 20:12:25,069 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,070 - sqlalchemy.engine.Engine - INFO - [cached since 0.07779s ago] ('DetectionRules', 'dbo')
2025-06-19 20:12:25,087 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,088 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,089 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,089 - sqlalchemy.engine.Engine - INFO - [cached since 0.107s ago] ()
2025-06-19 20:12:25,090 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:12:25,090 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ()
2025-06-19 20:12:25,092 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,093 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,093 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,093 - sqlalchemy.engine.Engine - INFO - [cached since 0.1114s ago] ()
2025-06-19 20:12:25,094 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,095 - sqlalchemy.engine.Engine - INFO - [cached since 0.1027s ago] ('SystemConfig', 'dbo')
2025-06-19 20:12:25,109 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,110 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,111 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,111 - sqlalchemy.engine.Engine - INFO - [cached since 0.1287s ago] ()
2025-06-19 20:12:25,112 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:12:25,112 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ()
2025-06-19 20:12:25,114 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,116 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,116 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,117 - sqlalchemy.engine.Engine - INFO - [cached since 0.1346s ago] ()
2025-06-19 20:12:25,117 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,118 - sqlalchemy.engine.Engine - INFO - [cached since 0.1258s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:12:25,119 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,120 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,120 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,120 - sqlalchemy.engine.Engine - INFO - [cached since 0.1384s ago] ()
2025-06-19 20:12:25,121 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:12:25,121 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-06-19 20:12:25,123 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,124 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 20:12:25,125 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ()
2025-06-19 20:12:25,134 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,135 - app.database - INFO - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-19 20:12:25,135 - app.database - INFO - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-19 20:12:25,135 - app.database - INFO - üë§ Connection User: Manh\manhh
2025-06-19 20:12:25,135 - app.database - INFO - üñ•Ô∏è Host: MANH
2025-06-19 20:12:25,136 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,136 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,136 - sqlalchemy.engine.Engine - INFO - [cached since 0.1542s ago] ()
2025-06-19 20:12:25,137 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,137 - sqlalchemy.engine.Engine - INFO - [cached since 0.1451s ago] ('Agents', 'dbo')
2025-06-19 20:12:25,150 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,151 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,151 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,152 - sqlalchemy.engine.Engine - INFO - [cached since 0.1697s ago] ()
2025-06-19 20:12:25,152 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,153 - sqlalchemy.engine.Engine - INFO - [cached since 0.1605s ago] ('Events', 'dbo')
2025-06-19 20:12:25,153 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,154 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,154 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,154 - sqlalchemy.engine.Engine - INFO - [cached since 0.1722s ago] ()
2025-06-19 20:12:25,155 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,155 - sqlalchemy.engine.Engine - INFO - [cached since 0.1631s ago] ('Alerts', 'dbo')
2025-06-19 20:12:25,156 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,157 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,157 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,157 - sqlalchemy.engine.Engine - INFO - [cached since 0.1751s ago] ()
2025-06-19 20:12:25,158 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,158 - sqlalchemy.engine.Engine - INFO - [cached since 0.1661s ago] ('Threats', 'dbo')
2025-06-19 20:12:25,167 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,168 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,168 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,169 - sqlalchemy.engine.Engine - INFO - [cached since 0.1867s ago] ()
2025-06-19 20:12:25,169 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,170 - sqlalchemy.engine.Engine - INFO - [cached since 0.1775s ago] ('DetectionRules', 'dbo')
2025-06-19 20:12:25,209 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,210 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,210 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,210 - sqlalchemy.engine.Engine - INFO - [cached since 0.2283s ago] ()
2025-06-19 20:12:25,211 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,211 - sqlalchemy.engine.Engine - INFO - [cached since 0.2191s ago] ('SystemConfig', 'dbo')
2025-06-19 20:12:25,212 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,212 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,213 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,213 - sqlalchemy.engine.Engine - INFO - [cached since 0.2307s ago] ()
2025-06-19 20:12:25,213 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,213 - sqlalchemy.engine.Engine - INFO - [cached since 0.2214s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:12:25,214 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,214 - app.database - INFO - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-19 20:12:25,215 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,215 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,216 - sqlalchemy.engine.Engine - INFO - [cached since 0.2336s ago] ()
2025-06-19 20:12:25,216 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:12:25,216 - sqlalchemy.engine.Engine - INFO - [cached since 0.2077s ago] ()
2025-06-19 20:12:25,218 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,219 - app.database - INFO - üìä Agents: 0 records
2025-06-19 20:12:25,220 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,220 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,221 - sqlalchemy.engine.Engine - INFO - [cached since 0.2387s ago] ()
2025-06-19 20:12:25,221 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:12:25,222 - sqlalchemy.engine.Engine - INFO - [cached since 0.2051s ago] ()
2025-06-19 20:12:25,224 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,225 - app.database - INFO - üìä Events: 0 records
2025-06-19 20:12:25,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,226 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,227 - sqlalchemy.engine.Engine - INFO - [cached since 0.2445s ago] ()
2025-06-19 20:12:25,227 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:12:25,227 - sqlalchemy.engine.Engine - INFO - [cached since 0.2005s ago] ()
2025-06-19 20:12:25,229 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,230 - app.database - INFO - üìä Alerts: 0 records
2025-06-19 20:12:25,230 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,231 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,231 - sqlalchemy.engine.Engine - INFO - [cached since 0.249s ago] ()
2025-06-19 20:12:25,232 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:12:25,232 - sqlalchemy.engine.Engine - INFO - [cached since 0.1696s ago] ()
2025-06-19 20:12:25,234 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,235 - app.database - INFO - üìä Threats: 12 records
2025-06-19 20:12:25,235 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,236 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,236 - sqlalchemy.engine.Engine - INFO - [cached since 0.2539s ago] ()
2025-06-19 20:12:25,237 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:12:25,237 - sqlalchemy.engine.Engine - INFO - [cached since 0.1473s ago] ()
2025-06-19 20:12:25,239 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,239 - app.database - INFO - üìä DetectionRules: 7 records
2025-06-19 20:12:25,240 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,240 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,240 - sqlalchemy.engine.Engine - INFO - [cached since 0.2583s ago] ()
2025-06-19 20:12:25,241 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:12:25,241 - sqlalchemy.engine.Engine - INFO - [cached since 0.1299s ago] ()
2025-06-19 20:12:25,243 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,243 - app.database - INFO - üìä SystemConfig: 10 records
2025-06-19 20:12:25,244 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,244 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,245 - sqlalchemy.engine.Engine - INFO - [cached since 0.2626s ago] ()
2025-06-19 20:12:25,245 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:12:25,245 - sqlalchemy.engine.Engine - INFO - [cached since 0.1243s ago] ()
2025-06-19 20:12:25,247 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,247 - app.database - INFO - üìä AgentConfigs: 0 records
2025-06-19 20:12:25,247 - app.database - INFO - üìà Total EDR records: 29
2025-06-19 20:12:25,248 - __main__ - INFO - ‚úÖ Database connection successful
2025-06-19 20:12:25,248 - __main__ - INFO - ‚úÖ Environment check completed successfully
2025-06-19 20:12:25,248 - __main__ - INFO - üìä Retrieving database information...
2025-06-19 20:12:25,249 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,249 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            1 as test, 
                            GETDATE() as server_time,
                            @@VERSION as version,
                            @@SERVERNAME as server_name,
                            DB_NAME() as database_name
                    
2025-06-19 20:12:25,250 - sqlalchemy.engine.Engine - INFO - [cached since 0.2708s ago] ()
2025-06-19 20:12:25,251 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/5)
2025-06-19 20:12:25,251 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 20:12:25,252 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,252 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,252 - sqlalchemy.engine.Engine - INFO - [cached since 0.2703s ago] ()
2025-06-19 20:12:25,253 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name,
                        @@CONNECTIONS as total_connections,
                        @@CPU_BUSY as cpu_busy,
                        @@IDLE as idle_time
                
2025-06-19 20:12:25,253 - sqlalchemy.engine.Engine - INFO - [cached since 0.2703s ago] ()
2025-06-19 20:12:25,254 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,255 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,255 - sqlalchemy.engine.Engine - INFO - [cached since 0.2731s ago] ()
2025-06-19 20:12:25,256 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,256 - sqlalchemy.engine.Engine - INFO - [cached since 0.2642s ago] ('Agents', 'dbo')
2025-06-19 20:12:25,272 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,273 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,273 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,274 - sqlalchemy.engine.Engine - INFO - [cached since 0.2917s ago] ()
2025-06-19 20:12:25,274 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:12:25,274 - sqlalchemy.engine.Engine - INFO - [cached since 0.2657s ago] ()
2025-06-19 20:12:25,276 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,277 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,277 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,278 - sqlalchemy.engine.Engine - INFO - [cached since 0.2957s ago] ()
2025-06-19 20:12:25,278 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,279 - sqlalchemy.engine.Engine - INFO - [cached since 0.2867s ago] ('Events', 'dbo')
2025-06-19 20:12:25,279 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,280 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,281 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,281 - sqlalchemy.engine.Engine - INFO - [cached since 0.2989s ago] ()
2025-06-19 20:12:25,282 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:12:25,282 - sqlalchemy.engine.Engine - INFO - [cached since 0.2653s ago] ()
2025-06-19 20:12:25,286 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,287 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,288 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,289 - sqlalchemy.engine.Engine - INFO - [cached since 0.3065s ago] ()
2025-06-19 20:12:25,289 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,290 - sqlalchemy.engine.Engine - INFO - [cached since 0.2978s ago] ('Alerts', 'dbo')
2025-06-19 20:12:25,291 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,292 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,292 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,293 - sqlalchemy.engine.Engine - INFO - [cached since 0.3106s ago] ()
2025-06-19 20:12:25,293 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:12:25,294 - sqlalchemy.engine.Engine - INFO - [cached since 0.2668s ago] ()
2025-06-19 20:12:25,296 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,297 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,297 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,297 - sqlalchemy.engine.Engine - INFO - [cached since 0.3153s ago] ()
2025-06-19 20:12:25,298 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,299 - sqlalchemy.engine.Engine - INFO - [cached since 0.3065s ago] ('Threats', 'dbo')
2025-06-19 20:12:25,333 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,334 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,334 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,335 - sqlalchemy.engine.Engine - INFO - [cached since 0.3525s ago] ()
2025-06-19 20:12:25,335 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:12:25,335 - sqlalchemy.engine.Engine - INFO - [cached since 0.2727s ago] ()
2025-06-19 20:12:25,337 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,338 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,338 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,339 - sqlalchemy.engine.Engine - INFO - [cached since 0.3567s ago] ()
2025-06-19 20:12:25,340 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,340 - sqlalchemy.engine.Engine - INFO - [cached since 0.3478s ago] ('DetectionRules', 'dbo')
2025-06-19 20:12:25,355 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,357 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,357 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,359 - sqlalchemy.engine.Engine - INFO - [cached since 0.3768s ago] ()
2025-06-19 20:12:25,361 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:12:25,361 - sqlalchemy.engine.Engine - INFO - [cached since 0.2713s ago] ()
2025-06-19 20:12:25,364 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,366 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,366 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,367 - sqlalchemy.engine.Engine - INFO - [cached since 0.3847s ago] ()
2025-06-19 20:12:25,368 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,368 - sqlalchemy.engine.Engine - INFO - [cached since 0.376s ago] ('SystemConfig', 'dbo')
2025-06-19 20:12:25,383 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,385 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,385 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,385 - sqlalchemy.engine.Engine - INFO - [cached since 0.4032s ago] ()
2025-06-19 20:12:25,386 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:12:25,386 - sqlalchemy.engine.Engine - INFO - [cached since 0.2746s ago] ()
2025-06-19 20:12:25,389 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,391 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,393 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,393 - sqlalchemy.engine.Engine - INFO - [cached since 0.4109s ago] ()
2025-06-19 20:12:25,394 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,394 - sqlalchemy.engine.Engine - INFO - [cached since 0.4019s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:12:25,395 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,396 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,397 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,397 - sqlalchemy.engine.Engine - INFO - [cached since 0.4149s ago] ()
2025-06-19 20:12:25,397 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:12:25,398 - sqlalchemy.engine.Engine - INFO - [cached since 0.2765s ago] ()
2025-06-19 20:12:25,399 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,400 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 20:12:25,400 - sqlalchemy.engine.Engine - INFO - [cached since 0.2757s ago] ()
2025-06-19 20:12:25,408 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,409 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,410 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,410 - sqlalchemy.engine.Engine - INFO - [cached since 0.4278s ago] ()
2025-06-19 20:12:25,410 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,411 - sqlalchemy.engine.Engine - INFO - [cached since 0.4188s ago] ('Agents', 'dbo')
2025-06-19 20:12:25,421 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,422 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,423 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,423 - sqlalchemy.engine.Engine - INFO - [cached since 0.4409s ago] ()
2025-06-19 20:12:25,423 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:12:25,424 - sqlalchemy.engine.Engine - INFO - [cached since 0.4149s ago] ()
2025-06-19 20:12:25,425 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,426 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,427 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,427 - sqlalchemy.engine.Engine - INFO - [cached since 0.4448s ago] ()
2025-06-19 20:12:25,428 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,428 - sqlalchemy.engine.Engine - INFO - [cached since 0.4358s ago] ('Events', 'dbo')
2025-06-19 20:12:25,428 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,429 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,429 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,430 - sqlalchemy.engine.Engine - INFO - [cached since 0.4477s ago] ()
2025-06-19 20:12:25,430 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:12:25,430 - sqlalchemy.engine.Engine - INFO - [cached since 0.4139s ago] ()
2025-06-19 20:12:25,434 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,435 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,435 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,435 - sqlalchemy.engine.Engine - INFO - [cached since 0.4533s ago] ()
2025-06-19 20:12:25,436 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,436 - sqlalchemy.engine.Engine - INFO - [cached since 0.4443s ago] ('Alerts', 'dbo')
2025-06-19 20:12:25,438 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,439 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,439 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,439 - sqlalchemy.engine.Engine - INFO - [cached since 0.4573s ago] ()
2025-06-19 20:12:25,440 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:12:25,440 - sqlalchemy.engine.Engine - INFO - [cached since 0.4132s ago] ()
2025-06-19 20:12:25,442 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,443 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,443 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,443 - sqlalchemy.engine.Engine - INFO - [cached since 0.4612s ago] ()
2025-06-19 20:12:25,444 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,444 - sqlalchemy.engine.Engine - INFO - [cached since 0.4519s ago] ('Threats', 'dbo')
2025-06-19 20:12:25,453 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,454 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,454 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,455 - sqlalchemy.engine.Engine - INFO - [cached since 0.4726s ago] ()
2025-06-19 20:12:25,455 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:12:25,455 - sqlalchemy.engine.Engine - INFO - [cached since 0.3928s ago] ()
2025-06-19 20:12:25,457 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,458 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,458 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,458 - sqlalchemy.engine.Engine - INFO - [cached since 0.4761s ago] ()
2025-06-19 20:12:25,459 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,459 - sqlalchemy.engine.Engine - INFO - [cached since 0.4671s ago] ('DetectionRules', 'dbo')
2025-06-19 20:12:25,468 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,469 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,469 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,470 - sqlalchemy.engine.Engine - INFO - [cached since 0.4875s ago] ()
2025-06-19 20:12:25,470 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:12:25,470 - sqlalchemy.engine.Engine - INFO - [cached since 0.3808s ago] ()
2025-06-19 20:12:25,472 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,473 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,473 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,473 - sqlalchemy.engine.Engine - INFO - [cached since 0.4911s ago] ()
2025-06-19 20:12:25,474 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,474 - sqlalchemy.engine.Engine - INFO - [cached since 0.4819s ago] ('SystemConfig', 'dbo')
2025-06-19 20:12:25,474 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,475 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,476 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,476 - sqlalchemy.engine.Engine - INFO - [cached since 0.4939s ago] ()
2025-06-19 20:12:25,476 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:12:25,477 - sqlalchemy.engine.Engine - INFO - [cached since 0.3652s ago] ()
2025-06-19 20:12:25,477 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,478 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,478 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,478 - sqlalchemy.engine.Engine - INFO - [cached since 0.4963s ago] ()
2025-06-19 20:12:25,479 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:12:25,479 - sqlalchemy.engine.Engine - INFO - [cached since 0.4871s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:12:25,480 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,481 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,481 - sqlalchemy.engine.Engine - INFO - [cached since 0.4989s ago] ()
2025-06-19 20:12:25,482 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:12:25,482 - sqlalchemy.engine.Engine - INFO - [cached since 0.3607s ago] ()
2025-06-19 20:12:25,483 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,484 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,484 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,484 - sqlalchemy.engine.Engine - INFO - [cached since 0.5024s ago] ()
2025-06-19 20:12:25,485 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Agents 
                    WHERE LastHeartbeat >= DATEADD(minute, -10, GETDATE())
                    AND Status = 'Active'
                
2025-06-19 20:12:25,485 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] ()
2025-06-19 20:12:25,489 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Events 
                    WHERE CreatedAt >= DATEADD(hour, -1, GETDATE())
                
2025-06-19 20:12:25,489 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-06-19 20:12:25,492 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                
2025-06-19 20:12:25,492 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ()
2025-06-19 20:12:25,494 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                    AND Severity IN ('High', 'Critical')
                
2025-06-19 20:12:25,494 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ()
2025-06-19 20:12:25,499 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM DetectionRules 
                    WHERE IsActive = 1
                
2025-06-19 20:12:25,499 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] ()
2025-06-19 20:12:25,502 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Threats 
                    WHERE IsActive = 1
                
2025-06-19 20:12:25,502 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ()
2025-06-19 20:12:25,504 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,504 - app.database - INFO - ‚úÖ Database health check passed in 255ms
2025-06-19 20:12:25,504 - __main__ - INFO - ‚úÖ Database connected: EDR_System on Manh
2025-06-19 20:12:25,505 - __main__ - INFO - ‚è±Ô∏è Response time: 255ms
2025-06-19 20:12:25,505 - __main__ - INFO - üìä Agents: 0 records
2025-06-19 20:12:25,505 - __main__ - INFO - üìä Events: 0 records
2025-06-19 20:12:25,505 - __main__ - INFO - üìä Alerts: 0 records
2025-06-19 20:12:25,505 - __main__ - INFO - üìä Threats: 12 records
2025-06-19 20:12:25,505 - __main__ - INFO - üìä DetectionRules: 7 records
2025-06-19 20:12:25,506 - __main__ - INFO - üìä SystemConfig: 10 records
2025-06-19 20:12:25,506 - __main__ - INFO - üìä AgentConfigs: 0 records
2025-06-19 20:12:25,506 - __main__ - INFO - üîÑ Active agents (last 10min): 0
2025-06-19 20:12:25,506 - __main__ - INFO - üìà Events (last hour): 0
2025-06-19 20:12:25,506 - __main__ - INFO - üö® Open alerts: 0
2025-06-19 20:12:25,506 - __main__ - INFO - üõ°Ô∏è Active detection rules: 7
2025-06-19 20:12:25,506 - __main__ - INFO - üîç Active threat indicators: 12
2025-06-19 20:12:25,528 - __main__ - INFO - üß™ Testing database schema compliance...
2025-06-19 20:12:25,529 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,529 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:12:25,529 - sqlalchemy.engine.Engine - INFO - [cached since 0.5474s ago] ()
2025-06-19 20:12:25,540 - sqlalchemy.engine.Engine - INFO - SELECT [Agents].[AgentID] AS [Agents_AgentID], [Agents].[HostName] AS [Agents_HostName], [Agents].[IPAddress] AS [Agents_IPAddress], [Agents].[MACAddress] AS [Agents_MACAddress], [Agents].[OperatingSystem] AS [Agents_OperatingSystem], [Agents].[OSVersion] AS [Agents_OSVersion], [Agents].[Architecture] AS [Agents_Architecture], [Agents].[Domain] AS [Agents_Domain], [Agents].[AgentVersion] AS [Agents_AgentVersion], [Agents].[InstallPath] AS [Agents_InstallPath], [Agents].[Status] AS [Agents_Status], [Agents].[LastHeartbeat] AS [Agents_LastHeartbeat], [Agents].[FirstSeen] AS [Agents_FirstSeen], [Agents].[CPUUsage] AS [Agents_CPUUsage], [Agents].[MemoryUsage] AS [Agents_MemoryUsage], [Agents].[DiskUsage] AS [Agents_DiskUsage], [Agents].[NetworkLatency] AS [Agents_NetworkLatency], [Agents].[MonitoringEnabled] AS [Agents_MonitoringEnabled], [Agents].[CreatedAt] AS [Agents_CreatedAt], [Agents].[UpdatedAt] AS [Agents_UpdatedAt] 
FROM [Agents] 
WHERE [Agents].[HostName] LIKE ?
2025-06-19 20:12:25,541 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] ('TEST-SCHEMA-%',)
2025-06-19 20:12:25,548 - sqlalchemy.engine.Engine - INFO - INSERT INTO [Agents] ([AgentID], [HostName], [IPAddress], [MACAddress], [OperatingSystem], [OSVersion], [Architecture], [Domain], [AgentVersion], [InstallPath], [Status], [LastHeartbeat], [FirstSeen], [CPUUsage], [MemoryUsage], [DiskUsage], [NetworkLatency], [MonitoringEnabled], [CreatedAt], [UpdatedAt]) OUTPUT inserted.[LastHeartbeat], inserted.[FirstSeen], inserted.[CreatedAt], inserted.[UpdatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate(), getdate(), ?, ?, ?, ?, ?, getdate(), getdate())
2025-06-19 20:12:25,548 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] (UUID('a2691cd7-fd64-4ad7-bd31-26f19d5f4a90'), 'TEST-SCHEMA-1750338745-5e646ccb', '192.168.20.200', None, 'Windows 11 Pro', None, None, None, '1.0.0', None, 'Active', 0.0, 0.0, 0.0, 0, 1)
2025-06-19 20:12:25,555 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,556 - __main__ - INFO - ‚úÖ Agent test successful: a2691cd7-fd64-4ad7-bd31-26f19d5f4a90
2025-06-19 20:12:25,556 - __main__ - INFO - ‚úÖ Test hostname: TEST-SCHEMA-1750338745-5e646ccb
2025-06-19 20:12:25,557 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:12:25,558 - sqlalchemy.engine.Engine - INFO - DELETE FROM [Agents] WHERE [Agents].[AgentID] = ?
2025-06-19 20:12:25,558 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (UUID('a2691cd7-fd64-4ad7-bd31-26f19d5f4a90'),)
2025-06-19 20:12:25,572 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:12:25,575 - __main__ - INFO - üßπ Test agent cleaned up
2025-06-19 20:12:25,575 - __main__ - INFO - ‚úÖ Database schema test completed successfully
2025-06-19 20:12:25,576 - __main__ - INFO - üéØ Final startup preparations...
2025-06-19 20:12:25,576 - __main__ - INFO - üåê Server will bind to: 192.168.20.85:5000
2025-06-19 20:12:25,576 - __main__ - INFO - üîÑ Reload mode: Enabled
2025-06-19 20:12:25,576 - __main__ - INFO - üêõ Debug mode: Enabled
2025-06-19 20:12:25,576 - __main__ - INFO - üîß LOCAL SQL SERVER MODE:
2025-06-19 20:12:25,576 - __main__ - INFO -    ‚Ä¢ Connected to local SQL Server instance
2025-06-19 20:12:25,577 - __main__ - INFO -    ‚Ä¢ Using Windows Authentication
2025-06-19 20:12:25,577 - __main__ - INFO -    ‚Ä¢ EDR_System database ready
2025-06-19 20:12:25,577 - __main__ - INFO -    ‚Ä¢ All services operational
2025-06-19 20:12:25,577 - __main__ - INFO - üöÄ Starting EDR Agent Communication Server...
2025-06-19 20:14:24,902 - app.database - INFO - üîÑ Shutting down database connections...
2025-06-19 20:14:24,904 - app.database - INFO - üßπ Database engine disposed successfully
2025-06-19 20:14:24,904 - app.database - INFO - üßπ Database cleanup completed
2025-06-19 20:14:24,905 - app.database - INFO - ‚úÖ Database shutdown completed
2025-06-19 20:14:30,749 - __main__ - INFO - üöÄ EDR Agent Communication Server - Local SQL Startup
2025-06-19 20:14:30,753 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 20:14:30,753 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 20:14:30,754 - __main__ - INFO - üîç Checking SQL Server services...
2025-06-19 20:14:30,774 - __main__ - INFO - ‚úÖ MSSQLSERVER is running
2025-06-19 20:14:30,801 - __main__ - WARNING - ‚ö†Ô∏è SQLBrowser exists but not running
2025-06-19 20:14:30,802 - __main__ - INFO - ‚úÖ Found 1 running SQL Server service(s)
2025-06-19 20:14:30,802 - __main__ - INFO - üîç Testing local SQL Server connections...
2025-06-19 20:14:30,802 - __main__ - INFO - üîå Testing: localhost
2025-06-19 20:14:30,920 - __main__ - INFO - ‚úÖ SUCCESS! Connected to SQL Server via: localhost
2025-06-19 20:14:30,920 - __main__ - INFO -    SQL Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64) 
	Oct  8...
2025-06-19 20:14:30,920 - __main__ - INFO - ‚úÖ EDR_System database found
2025-06-19 20:14:30,921 - __main__ - INFO - üéØ Using SQL Server: localhost
2025-06-19 20:14:31,248 - app.database - INFO - üîó Initializing database connection to: MANH/EDR_System
2025-06-19 20:14:31,269 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-19 20:14:31,269 - __main__ - INFO - üóÑÔ∏è Initializing database...
2025-06-19 20:14:31,270 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-19 20:14:31,282 - sqlalchemy.engine.Engine - INFO - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-19 20:14:31,283 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-19 20:14:31,284 - sqlalchemy.engine.Engine - INFO - SELECT schema_name()
2025-06-19 20:14:31,285 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ()
2025-06-19 20:14:31,295 - sqlalchemy.engine.Engine - INFO - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-19 20:14:31,295 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] ()
2025-06-19 20:14:31,296 - sqlalchemy.engine.Engine - INFO - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-19 20:14:31,296 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ()
2025-06-19 20:14:31,354 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,354 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            1 as test, 
                            GETDATE() as server_time,
                            @@VERSION as version,
                            @@SERVERNAME as server_name,
                            DB_NAME() as database_name
                    
2025-06-19 20:14:31,355 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] ()
2025-06-19 20:14:31,355 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/5)
2025-06-19 20:14:31,356 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 20:14:31,357 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,357 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,358 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] ()
2025-06-19 20:14:31,358 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name,
                        @@CONNECTIONS as total_connections,
                        @@CPU_BUSY as cpu_busy,
                        @@IDLE as idle_time
                
2025-06-19 20:14:31,359 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ()
2025-06-19 20:14:31,365 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,366 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,366 - sqlalchemy.engine.Engine - INFO - [cached since 0.008439s ago] ()
2025-06-19 20:14:31,367 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,367 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ('Agents', 'dbo')
2025-06-19 20:14:31,379 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,380 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,380 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,381 - sqlalchemy.engine.Engine - INFO - [cached since 0.02321s ago] ()
2025-06-19 20:14:31,381 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:14:31,381 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ()
2025-06-19 20:14:31,383 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,384 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,384 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,385 - sqlalchemy.engine.Engine - INFO - [cached since 0.02741s ago] ()
2025-06-19 20:14:31,385 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,386 - sqlalchemy.engine.Engine - INFO - [cached since 0.01905s ago] ('Events', 'dbo')
2025-06-19 20:14:31,386 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,387 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,388 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,388 - sqlalchemy.engine.Engine - INFO - [cached since 0.03049s ago] ()
2025-06-19 20:14:31,389 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:14:31,389 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ()
2025-06-19 20:14:31,393 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,394 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,394 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,394 - sqlalchemy.engine.Engine - INFO - [cached since 0.03695s ago] ()
2025-06-19 20:14:31,395 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,395 - sqlalchemy.engine.Engine - INFO - [cached since 0.02859s ago] ('Alerts', 'dbo')
2025-06-19 20:14:31,396 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,397 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,397 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,397 - sqlalchemy.engine.Engine - INFO - [cached since 0.03989s ago] ()
2025-06-19 20:14:31,398 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:14:31,398 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ()
2025-06-19 20:14:31,400 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,401 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,401 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,401 - sqlalchemy.engine.Engine - INFO - [cached since 0.04396s ago] ()
2025-06-19 20:14:31,402 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,402 - sqlalchemy.engine.Engine - INFO - [cached since 0.0356s ago] ('Threats', 'dbo')
2025-06-19 20:14:31,413 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,414 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,414 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,414 - sqlalchemy.engine.Engine - INFO - [cached since 0.05702s ago] ()
2025-06-19 20:14:31,415 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:14:31,415 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] ()
2025-06-19 20:14:31,417 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,418 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,418 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,418 - sqlalchemy.engine.Engine - INFO - [cached since 0.06087s ago] ()
2025-06-19 20:14:31,419 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,419 - sqlalchemy.engine.Engine - INFO - [cached since 0.05265s ago] ('DetectionRules', 'dbo')
2025-06-19 20:14:31,430 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,432 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,432 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,432 - sqlalchemy.engine.Engine - INFO - [cached since 0.07501s ago] ()
2025-06-19 20:14:31,433 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:14:31,433 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ()
2025-06-19 20:14:31,435 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,437 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,437 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,437 - sqlalchemy.engine.Engine - INFO - [cached since 0.07997s ago] ()
2025-06-19 20:14:31,438 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,439 - sqlalchemy.engine.Engine - INFO - [cached since 0.07177s ago] ('SystemConfig', 'dbo')
2025-06-19 20:14:31,448 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,450 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,450 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,450 - sqlalchemy.engine.Engine - INFO - [cached since 0.09282s ago] ()
2025-06-19 20:14:31,451 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:14:31,451 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ()
2025-06-19 20:14:31,453 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,454 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,455 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,455 - sqlalchemy.engine.Engine - INFO - [cached since 0.09746s ago] ()
2025-06-19 20:14:31,456 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,456 - sqlalchemy.engine.Engine - INFO - [cached since 0.08937s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:14:31,457 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,458 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,458 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,458 - sqlalchemy.engine.Engine - INFO - [cached since 0.1009s ago] ()
2025-06-19 20:14:31,459 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:14:31,459 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ()
2025-06-19 20:14:31,461 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,462 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 20:14:31,462 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ()
2025-06-19 20:14:31,473 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,473 - app.database - INFO - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-19 20:14:31,474 - app.database - INFO - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-19 20:14:31,474 - app.database - INFO - üë§ Connection User: Manh\manhh
2025-06-19 20:14:31,474 - app.database - INFO - üñ•Ô∏è Host: MANH
2025-06-19 20:14:31,475 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,475 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,476 - sqlalchemy.engine.Engine - INFO - [cached since 0.1183s ago] ()
2025-06-19 20:14:31,476 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,477 - sqlalchemy.engine.Engine - INFO - [cached since 0.1101s ago] ('Agents', 'dbo')
2025-06-19 20:14:31,477 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,478 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,479 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,479 - sqlalchemy.engine.Engine - INFO - [cached since 0.1214s ago] ()
2025-06-19 20:14:31,479 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,480 - sqlalchemy.engine.Engine - INFO - [cached since 0.1131s ago] ('Events', 'dbo')
2025-06-19 20:14:31,481 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,481 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,482 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,482 - sqlalchemy.engine.Engine - INFO - [cached since 0.1247s ago] ()
2025-06-19 20:14:31,483 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,483 - sqlalchemy.engine.Engine - INFO - [cached since 0.1162s ago] ('Alerts', 'dbo')
2025-06-19 20:14:31,484 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,484 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,485 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,485 - sqlalchemy.engine.Engine - INFO - [cached since 0.1276s ago] ()
2025-06-19 20:14:31,486 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,486 - sqlalchemy.engine.Engine - INFO - [cached since 0.1191s ago] ('Threats', 'dbo')
2025-06-19 20:14:31,486 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,487 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,488 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,488 - sqlalchemy.engine.Engine - INFO - [cached since 0.1305s ago] ()
2025-06-19 20:14:31,489 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,489 - sqlalchemy.engine.Engine - INFO - [cached since 0.1222s ago] ('DetectionRules', 'dbo')
2025-06-19 20:14:31,490 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,491 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,491 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,491 - sqlalchemy.engine.Engine - INFO - [cached since 0.134s ago] ()
2025-06-19 20:14:31,492 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,493 - sqlalchemy.engine.Engine - INFO - [cached since 0.1258s ago] ('SystemConfig', 'dbo')
2025-06-19 20:14:31,493 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,494 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,494 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,495 - sqlalchemy.engine.Engine - INFO - [cached since 0.1372s ago] ()
2025-06-19 20:14:31,495 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,496 - sqlalchemy.engine.Engine - INFO - [cached since 0.1289s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:14:31,496 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,497 - app.database - INFO - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-19 20:14:31,497 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,498 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,498 - sqlalchemy.engine.Engine - INFO - [cached since 0.1405s ago] ()
2025-06-19 20:14:31,498 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:14:31,499 - sqlalchemy.engine.Engine - INFO - [cached since 0.1174s ago] ()
2025-06-19 20:14:31,499 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,500 - app.database - INFO - üìä Agents: 0 records
2025-06-19 20:14:31,500 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,500 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,501 - sqlalchemy.engine.Engine - INFO - [cached since 0.1433s ago] ()
2025-06-19 20:14:31,501 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:14:31,502 - sqlalchemy.engine.Engine - INFO - [cached since 0.113s ago] ()
2025-06-19 20:14:31,502 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,503 - app.database - INFO - üìä Events: 0 records
2025-06-19 20:14:31,504 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,504 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,504 - sqlalchemy.engine.Engine - INFO - [cached since 0.1468s ago] ()
2025-06-19 20:14:31,505 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:14:31,505 - sqlalchemy.engine.Engine - INFO - [cached since 0.1076s ago] ()
2025-06-19 20:14:31,506 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,506 - app.database - INFO - üìä Alerts: 0 records
2025-06-19 20:14:31,507 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,507 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,507 - sqlalchemy.engine.Engine - INFO - [cached since 0.15s ago] ()
2025-06-19 20:14:31,508 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:14:31,508 - sqlalchemy.engine.Engine - INFO - [cached since 0.09306s ago] ()
2025-06-19 20:14:31,508 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,509 - app.database - INFO - üìä Threats: 12 records
2025-06-19 20:14:31,509 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,510 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,510 - sqlalchemy.engine.Engine - INFO - [cached since 0.1525s ago] ()
2025-06-19 20:14:31,511 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:14:31,511 - sqlalchemy.engine.Engine - INFO - [cached since 0.07798s ago] ()
2025-06-19 20:14:31,517 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,519 - app.database - INFO - üìä DetectionRules: 7 records
2025-06-19 20:14:31,523 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,524 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,524 - sqlalchemy.engine.Engine - INFO - [cached since 0.1668s ago] ()
2025-06-19 20:14:31,525 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:14:31,526 - sqlalchemy.engine.Engine - INFO - [cached since 0.07555s ago] ()
2025-06-19 20:14:31,527 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,529 - app.database - INFO - üìä SystemConfig: 10 records
2025-06-19 20:14:31,530 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,530 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,531 - sqlalchemy.engine.Engine - INFO - [cached since 0.1734s ago] ()
2025-06-19 20:14:31,532 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:14:31,533 - sqlalchemy.engine.Engine - INFO - [cached since 0.07373s ago] ()
2025-06-19 20:14:31,534 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,536 - app.database - INFO - üìä AgentConfigs: 0 records
2025-06-19 20:14:31,536 - app.database - INFO - üìà Total EDR records: 29
2025-06-19 20:14:31,537 - __main__ - INFO - ‚úÖ Database connection successful
2025-06-19 20:14:31,540 - __main__ - INFO - ‚úÖ Environment check completed successfully
2025-06-19 20:14:31,541 - __main__ - INFO - üìä Retrieving database information...
2025-06-19 20:14:31,542 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,543 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            1 as test, 
                            GETDATE() as server_time,
                            @@VERSION as version,
                            @@SERVERNAME as server_name,
                            DB_NAME() as database_name
                    
2025-06-19 20:14:31,543 - sqlalchemy.engine.Engine - INFO - [cached since 0.1893s ago] ()
2025-06-19 20:14:31,544 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/5)
2025-06-19 20:14:31,544 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 20:14:31,545 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,546 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,546 - sqlalchemy.engine.Engine - INFO - [cached since 0.1885s ago] ()
2025-06-19 20:14:31,547 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name,
                        @@CONNECTIONS as total_connections,
                        @@CPU_BUSY as cpu_busy,
                        @@IDLE as idle_time
                
2025-06-19 20:14:31,547 - sqlalchemy.engine.Engine - INFO - [cached since 0.189s ago] ()
2025-06-19 20:14:31,549 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,549 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,549 - sqlalchemy.engine.Engine - INFO - [cached since 0.1921s ago] ()
2025-06-19 20:14:31,550 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,552 - sqlalchemy.engine.Engine - INFO - [cached since 0.1848s ago] ('Agents', 'dbo')
2025-06-19 20:14:31,554 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,558 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,558 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,559 - sqlalchemy.engine.Engine - INFO - [cached since 0.2013s ago] ()
2025-06-19 20:14:31,559 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:14:31,560 - sqlalchemy.engine.Engine - INFO - [cached since 0.1784s ago] ()
2025-06-19 20:14:31,560 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,561 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,561 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,561 - sqlalchemy.engine.Engine - INFO - [cached since 0.204s ago] ()
2025-06-19 20:14:31,562 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,562 - sqlalchemy.engine.Engine - INFO - [cached since 0.1955s ago] ('Events', 'dbo')
2025-06-19 20:14:31,563 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,564 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,564 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,564 - sqlalchemy.engine.Engine - INFO - [cached since 0.207s ago] ()
2025-06-19 20:14:31,565 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:14:31,565 - sqlalchemy.engine.Engine - INFO - [cached since 0.1767s ago] ()
2025-06-19 20:14:31,566 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,567 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,567 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,567 - sqlalchemy.engine.Engine - INFO - [cached since 0.2099s ago] ()
2025-06-19 20:14:31,568 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,568 - sqlalchemy.engine.Engine - INFO - [cached since 0.2017s ago] ('Alerts', 'dbo')
2025-06-19 20:14:31,569 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,570 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,571 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,571 - sqlalchemy.engine.Engine - INFO - [cached since 0.2136s ago] ()
2025-06-19 20:14:31,572 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:14:31,572 - sqlalchemy.engine.Engine - INFO - [cached since 0.174s ago] ()
2025-06-19 20:14:31,572 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,573 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,573 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,574 - sqlalchemy.engine.Engine - INFO - [cached since 0.2164s ago] ()
2025-06-19 20:14:31,574 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,575 - sqlalchemy.engine.Engine - INFO - [cached since 0.2079s ago] ('Threats', 'dbo')
2025-06-19 20:14:31,575 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,576 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,576 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,577 - sqlalchemy.engine.Engine - INFO - [cached since 0.2193s ago] ()
2025-06-19 20:14:31,577 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:14:31,578 - sqlalchemy.engine.Engine - INFO - [cached since 0.1625s ago] ()
2025-06-19 20:14:31,578 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,579 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,579 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,579 - sqlalchemy.engine.Engine - INFO - [cached since 0.2217s ago] ()
2025-06-19 20:14:31,580 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,580 - sqlalchemy.engine.Engine - INFO - [cached since 0.2131s ago] ('DetectionRules', 'dbo')
2025-06-19 20:14:31,580 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,581 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,581 - sqlalchemy.engine.Engine - INFO - [cached since 0.224s ago] ()
2025-06-19 20:14:31,582 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:14:31,582 - sqlalchemy.engine.Engine - INFO - [cached since 0.1491s ago] ()
2025-06-19 20:14:31,583 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,584 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,584 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,584 - sqlalchemy.engine.Engine - INFO - [cached since 0.2269s ago] ()
2025-06-19 20:14:31,585 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,585 - sqlalchemy.engine.Engine - INFO - [cached since 0.2185s ago] ('SystemConfig', 'dbo')
2025-06-19 20:14:31,586 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,587 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,588 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,588 - sqlalchemy.engine.Engine - INFO - [cached since 0.2306s ago] ()
2025-06-19 20:14:31,589 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:14:31,589 - sqlalchemy.engine.Engine - INFO - [cached since 0.138s ago] ()
2025-06-19 20:14:31,589 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,590 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,590 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,591 - sqlalchemy.engine.Engine - INFO - [cached since 0.2334s ago] ()
2025-06-19 20:14:31,591 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,592 - sqlalchemy.engine.Engine - INFO - [cached since 0.225s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:14:31,592 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,593 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,593 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,594 - sqlalchemy.engine.Engine - INFO - [cached since 0.2364s ago] ()
2025-06-19 20:14:31,594 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:14:31,595 - sqlalchemy.engine.Engine - INFO - [cached since 0.1356s ago] ()
2025-06-19 20:14:31,595 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,596 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 20:14:31,596 - sqlalchemy.engine.Engine - INFO - [cached since 0.1345s ago] ()
2025-06-19 20:14:31,597 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,598 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,598 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,598 - sqlalchemy.engine.Engine - INFO - [cached since 0.2409s ago] ()
2025-06-19 20:14:31,599 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,599 - sqlalchemy.engine.Engine - INFO - [cached since 0.2326s ago] ('Agents', 'dbo')
2025-06-19 20:14:31,600 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,601 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,601 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,601 - sqlalchemy.engine.Engine - INFO - [cached since 0.2437s ago] ()
2025-06-19 20:14:31,602 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:14:31,602 - sqlalchemy.engine.Engine - INFO - [cached since 0.2208s ago] ()
2025-06-19 20:14:31,603 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,603 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,604 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,604 - sqlalchemy.engine.Engine - INFO - [cached since 0.2468s ago] ()
2025-06-19 20:14:31,605 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,605 - sqlalchemy.engine.Engine - INFO - [cached since 0.2385s ago] ('Events', 'dbo')
2025-06-19 20:14:31,606 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,607 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,607 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,607 - sqlalchemy.engine.Engine - INFO - [cached since 0.2499s ago] ()
2025-06-19 20:14:31,608 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:14:31,608 - sqlalchemy.engine.Engine - INFO - [cached since 0.2195s ago] ()
2025-06-19 20:14:31,609 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,609 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,610 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,610 - sqlalchemy.engine.Engine - INFO - [cached since 0.2524s ago] ()
2025-06-19 20:14:31,610 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,611 - sqlalchemy.engine.Engine - INFO - [cached since 0.2439s ago] ('Alerts', 'dbo')
2025-06-19 20:14:31,611 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,612 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,612 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,613 - sqlalchemy.engine.Engine - INFO - [cached since 0.2553s ago] ()
2025-06-19 20:14:31,613 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:14:31,613 - sqlalchemy.engine.Engine - INFO - [cached since 0.2157s ago] ()
2025-06-19 20:14:31,614 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,615 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,615 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,615 - sqlalchemy.engine.Engine - INFO - [cached since 0.2579s ago] ()
2025-06-19 20:14:31,616 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,616 - sqlalchemy.engine.Engine - INFO - [cached since 0.2494s ago] ('Threats', 'dbo')
2025-06-19 20:14:31,617 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,618 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,618 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,618 - sqlalchemy.engine.Engine - INFO - [cached since 0.2608s ago] ()
2025-06-19 20:14:31,619 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:14:31,619 - sqlalchemy.engine.Engine - INFO - [cached since 0.204s ago] ()
2025-06-19 20:14:31,620 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,621 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,621 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,621 - sqlalchemy.engine.Engine - INFO - [cached since 0.2637s ago] ()
2025-06-19 20:14:31,622 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,622 - sqlalchemy.engine.Engine - INFO - [cached since 0.2553s ago] ('DetectionRules', 'dbo')
2025-06-19 20:14:31,623 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,623 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,624 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,624 - sqlalchemy.engine.Engine - INFO - [cached since 0.2667s ago] ()
2025-06-19 20:14:31,625 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:14:31,625 - sqlalchemy.engine.Engine - INFO - [cached since 0.1916s ago] ()
2025-06-19 20:14:31,625 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,626 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,626 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,626 - sqlalchemy.engine.Engine - INFO - [cached since 0.269s ago] ()
2025-06-19 20:14:31,627 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,627 - sqlalchemy.engine.Engine - INFO - [cached since 0.2605s ago] ('SystemConfig', 'dbo')
2025-06-19 20:14:31,628 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,629 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,629 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,629 - sqlalchemy.engine.Engine - INFO - [cached since 0.2719s ago] ()
2025-06-19 20:14:31,630 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:14:31,630 - sqlalchemy.engine.Engine - INFO - [cached since 0.1793s ago] ()
2025-06-19 20:14:31,631 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,632 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,632 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,632 - sqlalchemy.engine.Engine - INFO - [cached since 0.2747s ago] ()
2025-06-19 20:14:31,633 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:14:31,633 - sqlalchemy.engine.Engine - INFO - [cached since 0.2663s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:14:31,634 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,635 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,635 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,635 - sqlalchemy.engine.Engine - INFO - [cached since 0.2778s ago] ()
2025-06-19 20:14:31,636 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:14:31,636 - sqlalchemy.engine.Engine - INFO - [cached since 0.1771s ago] ()
2025-06-19 20:14:31,637 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,638 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,638 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,638 - sqlalchemy.engine.Engine - INFO - [cached since 0.2808s ago] ()
2025-06-19 20:14:31,639 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Agents 
                    WHERE LastHeartbeat >= DATEADD(minute, -10, GETDATE())
                    AND Status = 'Active'
                
2025-06-19 20:14:31,639 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] ()
2025-06-19 20:14:31,641 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Events 
                    WHERE CreatedAt >= DATEADD(hour, -1, GETDATE())
                
2025-06-19 20:14:31,641 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ()
2025-06-19 20:14:31,643 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                
2025-06-19 20:14:31,643 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] ()
2025-06-19 20:14:31,645 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                    AND Severity IN ('High', 'Critical')
                
2025-06-19 20:14:31,646 - sqlalchemy.engine.Engine - INFO - [generated in 0.00047s] ()
2025-06-19 20:14:31,649 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM DetectionRules 
                    WHERE IsActive = 1
                
2025-06-19 20:14:31,649 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ()
2025-06-19 20:14:31,651 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Threats 
                    WHERE IsActive = 1
                
2025-06-19 20:14:31,651 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] ()
2025-06-19 20:14:31,653 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,654 - app.database - INFO - ‚úÖ Database health check passed in 112ms
2025-06-19 20:14:31,654 - __main__ - INFO - ‚úÖ Database connected: EDR_System on Manh
2025-06-19 20:14:31,654 - __main__ - INFO - ‚è±Ô∏è Response time: 112ms
2025-06-19 20:14:31,654 - __main__ - INFO - üìä Agents: 0 records
2025-06-19 20:14:31,655 - __main__ - INFO - üìä Events: 0 records
2025-06-19 20:14:31,655 - __main__ - INFO - üìä Alerts: 0 records
2025-06-19 20:14:31,655 - __main__ - INFO - üìä Threats: 12 records
2025-06-19 20:14:31,655 - __main__ - INFO - üìä DetectionRules: 7 records
2025-06-19 20:14:31,655 - __main__ - INFO - üìä SystemConfig: 10 records
2025-06-19 20:14:31,655 - __main__ - INFO - üìä AgentConfigs: 0 records
2025-06-19 20:14:31,656 - __main__ - INFO - üîÑ Active agents (last 10min): 0
2025-06-19 20:14:31,656 - __main__ - INFO - üìà Events (last hour): 0
2025-06-19 20:14:31,656 - __main__ - INFO - üö® Open alerts: 0
2025-06-19 20:14:31,656 - __main__ - INFO - üõ°Ô∏è Active detection rules: 7
2025-06-19 20:14:31,656 - __main__ - INFO - üîç Active threat indicators: 12
2025-06-19 20:14:31,681 - __main__ - INFO - üß™ Testing database schema compliance...
2025-06-19 20:14:31,682 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,682 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:14:31,682 - sqlalchemy.engine.Engine - INFO - [cached since 0.325s ago] ()
2025-06-19 20:14:31,693 - sqlalchemy.engine.Engine - INFO - SELECT [Agents].[AgentID] AS [Agents_AgentID], [Agents].[HostName] AS [Agents_HostName], [Agents].[IPAddress] AS [Agents_IPAddress], [Agents].[MACAddress] AS [Agents_MACAddress], [Agents].[OperatingSystem] AS [Agents_OperatingSystem], [Agents].[OSVersion] AS [Agents_OSVersion], [Agents].[Architecture] AS [Agents_Architecture], [Agents].[Domain] AS [Agents_Domain], [Agents].[AgentVersion] AS [Agents_AgentVersion], [Agents].[InstallPath] AS [Agents_InstallPath], [Agents].[Status] AS [Agents_Status], [Agents].[LastHeartbeat] AS [Agents_LastHeartbeat], [Agents].[FirstSeen] AS [Agents_FirstSeen], [Agents].[CPUUsage] AS [Agents_CPUUsage], [Agents].[MemoryUsage] AS [Agents_MemoryUsage], [Agents].[DiskUsage] AS [Agents_DiskUsage], [Agents].[NetworkLatency] AS [Agents_NetworkLatency], [Agents].[MonitoringEnabled] AS [Agents_MonitoringEnabled], [Agents].[CreatedAt] AS [Agents_CreatedAt], [Agents].[UpdatedAt] AS [Agents_UpdatedAt] 
FROM [Agents] 
WHERE [Agents].[HostName] LIKE ?
2025-06-19 20:14:31,693 - sqlalchemy.engine.Engine - INFO - [generated in 0.00074s] ('TEST-SCHEMA-%',)
2025-06-19 20:14:31,699 - sqlalchemy.engine.Engine - INFO - INSERT INTO [Agents] ([AgentID], [HostName], [IPAddress], [MACAddress], [OperatingSystem], [OSVersion], [Architecture], [Domain], [AgentVersion], [InstallPath], [Status], [LastHeartbeat], [FirstSeen], [CPUUsage], [MemoryUsage], [DiskUsage], [NetworkLatency], [MonitoringEnabled], [CreatedAt], [UpdatedAt]) OUTPUT inserted.[LastHeartbeat], inserted.[FirstSeen], inserted.[CreatedAt], inserted.[UpdatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate(), getdate(), ?, ?, ?, ?, ?, getdate(), getdate())
2025-06-19 20:14:31,699 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (UUID('77b0d322-bfb2-4fd9-a36a-20937f074788'), 'TEST-SCHEMA-1750338871-fb9e699e', '192.168.20.200', None, 'Windows 11 Pro', None, None, None, '1.0.0', None, 'Active', 0.0, 0.0, 0.0, 0, 1)
2025-06-19 20:14:31,704 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,704 - __main__ - INFO - ‚úÖ Agent test successful: 77b0d322-bfb2-4fd9-a36a-20937f074788
2025-06-19 20:14:31,705 - __main__ - INFO - ‚úÖ Test hostname: TEST-SCHEMA-1750338871-fb9e699e
2025-06-19 20:14:31,705 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:14:31,707 - sqlalchemy.engine.Engine - INFO - DELETE FROM [Agents] WHERE [Agents].[AgentID] = ?
2025-06-19 20:14:31,707 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] (UUID('77b0d322-bfb2-4fd9-a36a-20937f074788'),)
2025-06-19 20:14:31,717 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:14:31,719 - __main__ - INFO - üßπ Test agent cleaned up
2025-06-19 20:14:31,719 - __main__ - INFO - ‚úÖ Database schema test completed successfully
2025-06-19 20:14:31,719 - __main__ - INFO - üéØ Final startup preparations...
2025-06-19 20:14:31,719 - __main__ - INFO - üåê Server will bind to: 192.168.20.85:5000
2025-06-19 20:14:31,720 - __main__ - INFO - üîÑ Reload mode: Enabled
2025-06-19 20:14:31,720 - __main__ - INFO - üêõ Debug mode: Enabled
2025-06-19 20:14:31,720 - __main__ - INFO - üîß LOCAL SQL SERVER MODE:
2025-06-19 20:14:31,720 - __main__ - INFO -    ‚Ä¢ Connected to local SQL Server instance
2025-06-19 20:14:31,720 - __main__ - INFO -    ‚Ä¢ Using Windows Authentication
2025-06-19 20:14:31,720 - __main__ - INFO -    ‚Ä¢ EDR_System database ready
2025-06-19 20:14:31,720 - __main__ - INFO -    ‚Ä¢ All services operational
2025-06-19 20:14:31,721 - __main__ - INFO - üöÄ Starting EDR Agent Communication Server...
2025-06-19 20:24:07,959 - app.database - INFO - üîÑ Shutting down database connections...
2025-06-19 20:24:07,961 - app.database - INFO - üßπ Database engine disposed successfully
2025-06-19 20:24:07,961 - app.database - INFO - üßπ Database cleanup completed
2025-06-19 20:24:07,962 - app.database - INFO - ‚úÖ Database shutdown completed
2025-06-19 20:44:31,413 - __main__ - INFO - üöÄ EDR Agent Communication Server - Local SQL Startup
2025-06-19 20:44:31,419 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 20:44:31,419 - __main__ - INFO - üîç Performing environment checks...
2025-06-19 20:44:31,420 - __main__ - INFO - üîç Checking SQL Server services...
2025-06-19 20:44:31,448 - __main__ - INFO - ‚úÖ MSSQLSERVER is running
2025-06-19 20:44:31,486 - __main__ - WARNING - ‚ö†Ô∏è SQLBrowser exists but not running
2025-06-19 20:44:31,486 - __main__ - INFO - ‚úÖ Found 1 running SQL Server service(s)
2025-06-19 20:44:31,487 - __main__ - INFO - üîç Testing local SQL Server connections...
2025-06-19 20:44:31,487 - __main__ - INFO - üîå Testing: localhost
2025-06-19 20:44:31,660 - __main__ - INFO - ‚úÖ SUCCESS! Connected to SQL Server via: localhost
2025-06-19 20:44:31,660 - __main__ - INFO -    SQL Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64) 
	Oct  8...
2025-06-19 20:44:31,660 - __main__ - INFO - ‚úÖ EDR_System database found
2025-06-19 20:44:31,661 - __main__ - INFO - üéØ Using SQL Server: localhost
2025-06-19 20:44:32,083 - app.database - INFO - üîó Initializing database connection to: MANH/EDR_System
2025-06-19 20:44:32,104 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-19 20:44:32,105 - __main__ - INFO - üóÑÔ∏è Initializing database...
2025-06-19 20:44:32,105 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-19 20:44:32,122 - sqlalchemy.engine.Engine - INFO - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-19 20:44:32,123 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-19 20:44:32,125 - sqlalchemy.engine.Engine - INFO - SELECT schema_name()
2025-06-19 20:44:32,125 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] ()
2025-06-19 20:44:32,145 - sqlalchemy.engine.Engine - INFO - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-19 20:44:32,146 - sqlalchemy.engine.Engine - INFO - [generated in 0.00102s] ()
2025-06-19 20:44:32,147 - sqlalchemy.engine.Engine - INFO - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-19 20:44:32,148 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] ()
2025-06-19 20:44:32,236 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,237 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            1 as test, 
                            GETDATE() as server_time,
                            @@VERSION as version,
                            @@SERVERNAME as server_name,
                            DB_NAME() as database_name
                    
2025-06-19 20:44:32,238 - sqlalchemy.engine.Engine - INFO - [generated in 0.00127s] ()
2025-06-19 20:44:32,239 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/5)
2025-06-19 20:44:32,239 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 20:44:32,240 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,241 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,241 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ()
2025-06-19 20:44:32,242 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name,
                        @@CONNECTIONS as total_connections,
                        @@CPU_BUSY as cpu_busy,
                        @@IDLE as idle_time
                
2025-06-19 20:44:32,243 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] ()
2025-06-19 20:44:32,254 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,255 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,256 - sqlalchemy.engine.Engine - INFO - [cached since 0.01473s ago] ()
2025-06-19 20:44:32,257 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,258 - sqlalchemy.engine.Engine - INFO - [generated in 0.00075s] ('Agents', 'dbo')
2025-06-19 20:44:32,277 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,279 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,279 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,280 - sqlalchemy.engine.Engine - INFO - [cached since 0.03905s ago] ()
2025-06-19 20:44:32,281 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:44:32,281 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] ()
2025-06-19 20:44:32,285 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,287 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,287 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,288 - sqlalchemy.engine.Engine - INFO - [cached since 0.04689s ago] ()
2025-06-19 20:44:32,289 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,289 - sqlalchemy.engine.Engine - INFO - [cached since 0.03218s ago] ('Events', 'dbo')
2025-06-19 20:44:32,290 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,292 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,292 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,292 - sqlalchemy.engine.Engine - INFO - [cached since 0.05156s ago] ()
2025-06-19 20:44:32,293 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:44:32,294 - sqlalchemy.engine.Engine - INFO - [generated in 0.00052s] ()
2025-06-19 20:44:32,300 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,301 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,301 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,302 - sqlalchemy.engine.Engine - INFO - [cached since 0.06099s ago] ()
2025-06-19 20:44:32,303 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,303 - sqlalchemy.engine.Engine - INFO - [cached since 0.04581s ago] ('Alerts', 'dbo')
2025-06-19 20:44:32,304 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,305 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,306 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,306 - sqlalchemy.engine.Engine - INFO - [cached since 0.06546s ago] ()
2025-06-19 20:44:32,307 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:44:32,308 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] ()
2025-06-19 20:44:32,312 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,313 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,314 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,314 - sqlalchemy.engine.Engine - INFO - [cached since 0.07335s ago] ()
2025-06-19 20:44:32,315 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,316 - sqlalchemy.engine.Engine - INFO - [cached since 0.0583s ago] ('Threats', 'dbo')
2025-06-19 20:44:32,328 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,329 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,330 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,330 - sqlalchemy.engine.Engine - INFO - [cached since 0.08935s ago] ()
2025-06-19 20:44:32,331 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:44:32,331 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ()
2025-06-19 20:44:32,334 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,336 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,336 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,336 - sqlalchemy.engine.Engine - INFO - [cached since 0.0957s ago] ()
2025-06-19 20:44:32,337 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,338 - sqlalchemy.engine.Engine - INFO - [cached since 0.08067s ago] ('DetectionRules', 'dbo')
2025-06-19 20:44:32,349 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,351 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,351 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,352 - sqlalchemy.engine.Engine - INFO - [cached since 0.1109s ago] ()
2025-06-19 20:44:32,353 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:44:32,353 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] ()
2025-06-19 20:44:32,356 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,358 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,359 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,359 - sqlalchemy.engine.Engine - INFO - [cached since 0.1182s ago] ()
2025-06-19 20:44:32,360 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,360 - sqlalchemy.engine.Engine - INFO - [cached since 0.1031s ago] ('SystemConfig', 'dbo')
2025-06-19 20:44:32,371 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,373 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,374 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,374 - sqlalchemy.engine.Engine - INFO - [cached since 0.1336s ago] ()
2025-06-19 20:44:32,375 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:44:32,376 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ()
2025-06-19 20:44:32,378 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,379 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,380 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,380 - sqlalchemy.engine.Engine - INFO - [cached since 0.1395s ago] ()
2025-06-19 20:44:32,381 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,382 - sqlalchemy.engine.Engine - INFO - [cached since 0.1247s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:44:32,383 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,384 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,384 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,385 - sqlalchemy.engine.Engine - INFO - [cached since 0.1439s ago] ()
2025-06-19 20:44:32,385 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:44:32,386 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] ()
2025-06-19 20:44:32,388 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,389 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 20:44:32,390 - sqlalchemy.engine.Engine - INFO - [generated in 0.00072s] ()
2025-06-19 20:44:32,399 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,400 - app.database - INFO - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-19 20:44:32,400 - app.database - INFO - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-19 20:44:32,401 - app.database - INFO - üë§ Connection User: Manh\manhh
2025-06-19 20:44:32,401 - app.database - INFO - üñ•Ô∏è Host: MANH
2025-06-19 20:44:32,402 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,402 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,403 - sqlalchemy.engine.Engine - INFO - [cached since 0.1617s ago] ()
2025-06-19 20:44:32,403 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,404 - sqlalchemy.engine.Engine - INFO - [cached since 0.1466s ago] ('Agents', 'dbo')
2025-06-19 20:44:32,405 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,407 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,407 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,408 - sqlalchemy.engine.Engine - INFO - [cached since 0.167s ago] ()
2025-06-19 20:44:32,409 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,409 - sqlalchemy.engine.Engine - INFO - [cached since 0.152s ago] ('Events', 'dbo')
2025-06-19 20:44:32,410 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,411 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,412 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,413 - sqlalchemy.engine.Engine - INFO - [cached since 0.1719s ago] ()
2025-06-19 20:44:32,414 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,414 - sqlalchemy.engine.Engine - INFO - [cached since 0.157s ago] ('Alerts', 'dbo')
2025-06-19 20:44:32,415 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,416 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,417 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,417 - sqlalchemy.engine.Engine - INFO - [cached since 0.1761s ago] ()
2025-06-19 20:44:32,418 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,418 - sqlalchemy.engine.Engine - INFO - [cached since 0.161s ago] ('Threats', 'dbo')
2025-06-19 20:44:32,419 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,421 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,421 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,422 - sqlalchemy.engine.Engine - INFO - [cached since 0.1808s ago] ()
2025-06-19 20:44:32,423 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,423 - sqlalchemy.engine.Engine - INFO - [cached since 0.1659s ago] ('DetectionRules', 'dbo')
2025-06-19 20:44:32,424 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,426 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,426 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,426 - sqlalchemy.engine.Engine - INFO - [cached since 0.1855s ago] ()
2025-06-19 20:44:32,427 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,428 - sqlalchemy.engine.Engine - INFO - [cached since 0.1707s ago] ('SystemConfig', 'dbo')
2025-06-19 20:44:32,429 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,430 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,431 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,431 - sqlalchemy.engine.Engine - INFO - [cached since 0.19s ago] ()
2025-06-19 20:44:32,432 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,432 - sqlalchemy.engine.Engine - INFO - [cached since 0.1747s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:44:32,433 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,434 - app.database - INFO - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-19 20:44:32,435 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,436 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,437 - sqlalchemy.engine.Engine - INFO - [cached since 0.196s ago] ()
2025-06-19 20:44:32,457 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:44:32,459 - sqlalchemy.engine.Engine - INFO - [cached since 0.1778s ago] ()
2025-06-19 20:44:32,461 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,466 - app.database - INFO - üìä Agents: 0 records
2025-06-19 20:44:32,467 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,469 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,470 - sqlalchemy.engine.Engine - INFO - [cached since 0.2292s ago] ()
2025-06-19 20:44:32,474 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:44:32,476 - sqlalchemy.engine.Engine - INFO - [cached since 0.1823s ago] ()
2025-06-19 20:44:32,480 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,483 - app.database - INFO - üìä Events: 0 records
2025-06-19 20:44:32,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,485 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,486 - sqlalchemy.engine.Engine - INFO - [cached since 0.245s ago] ()
2025-06-19 20:44:32,487 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:44:32,487 - sqlalchemy.engine.Engine - INFO - [cached since 0.1798s ago] ()
2025-06-19 20:44:32,488 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,491 - app.database - INFO - üìä Alerts: 0 records
2025-06-19 20:44:32,492 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,493 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,494 - sqlalchemy.engine.Engine - INFO - [cached since 0.2529s ago] ()
2025-06-19 20:44:32,495 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:44:32,496 - sqlalchemy.engine.Engine - INFO - [cached since 0.1652s ago] ()
2025-06-19 20:44:32,499 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,503 - app.database - INFO - üìä Threats: 12 records
2025-06-19 20:44:32,504 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,506 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,506 - sqlalchemy.engine.Engine - INFO - [cached since 0.2657s ago] ()
2025-06-19 20:44:32,508 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:44:32,508 - sqlalchemy.engine.Engine - INFO - [cached since 0.1557s ago] ()
2025-06-19 20:44:32,509 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,510 - app.database - INFO - üìä DetectionRules: 7 records
2025-06-19 20:44:32,511 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,511 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,512 - sqlalchemy.engine.Engine - INFO - [cached since 0.271s ago] ()
2025-06-19 20:44:32,513 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:44:32,513 - sqlalchemy.engine.Engine - INFO - [cached since 0.1378s ago] ()
2025-06-19 20:44:32,514 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,514 - app.database - INFO - üìä SystemConfig: 22 records
2025-06-19 20:44:32,515 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,516 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,516 - sqlalchemy.engine.Engine - INFO - [cached since 0.275s ago] ()
2025-06-19 20:44:32,517 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:44:32,517 - sqlalchemy.engine.Engine - INFO - [cached since 0.1317s ago] ()
2025-06-19 20:44:32,518 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,519 - app.database - INFO - üìä AgentConfigs: 0 records
2025-06-19 20:44:32,519 - app.database - INFO - üìà Total EDR records: 41
2025-06-19 20:44:32,519 - __main__ - INFO - ‚úÖ Database connection successful
2025-06-19 20:44:32,519 - __main__ - INFO - ‚úÖ Environment check completed successfully
2025-06-19 20:44:32,520 - __main__ - INFO - üìä Retrieving database information...
2025-06-19 20:44:32,521 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,521 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            1 as test, 
                            GETDATE() as server_time,
                            @@VERSION as version,
                            @@SERVERNAME as server_name,
                            DB_NAME() as database_name
                    
2025-06-19 20:44:32,522 - sqlalchemy.engine.Engine - INFO - [cached since 0.286s ago] ()
2025-06-19 20:44:32,524 - app.database - INFO - ‚úÖ Database connection test successful (attempt 1/5)
2025-06-19 20:44:32,524 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-19 20:44:32,526 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,527 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,528 - sqlalchemy.engine.Engine - INFO - [cached since 0.2874s ago] ()
2025-06-19 20:44:32,530 - sqlalchemy.engine.Engine - INFO - 
                    SELECT 
                        @@VERSION as version,
                        DB_NAME() as database_name,
                        @@SERVERNAME as server_name,
                        GETDATE() as current_datetime,
                        @@SPID as session_id,
                        HOST_NAME() as host_name,
                        SUSER_NAME() as user_name,
                        @@CONNECTIONS as total_connections,
                        @@CPU_BUSY as cpu_busy,
                        @@IDLE as idle_time
                
2025-06-19 20:44:32,530 - sqlalchemy.engine.Engine - INFO - [cached since 0.2881s ago] ()
2025-06-19 20:44:32,532 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,532 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,532 - sqlalchemy.engine.Engine - INFO - [cached since 0.2917s ago] ()
2025-06-19 20:44:32,533 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,534 - sqlalchemy.engine.Engine - INFO - [cached since 0.2766s ago] ('Agents', 'dbo')
2025-06-19 20:44:32,535 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,536 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,536 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,537 - sqlalchemy.engine.Engine - INFO - [cached since 0.2961s ago] ()
2025-06-19 20:44:32,538 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:44:32,538 - sqlalchemy.engine.Engine - INFO - [cached since 0.2574s ago] ()
2025-06-19 20:44:32,539 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,541 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,541 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,542 - sqlalchemy.engine.Engine - INFO - [cached since 0.3008s ago] ()
2025-06-19 20:44:32,543 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,543 - sqlalchemy.engine.Engine - INFO - [cached since 0.2861s ago] ('Events', 'dbo')
2025-06-19 20:44:32,544 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,545 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,546 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,546 - sqlalchemy.engine.Engine - INFO - [cached since 0.3055s ago] ()
2025-06-19 20:44:32,547 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:44:32,548 - sqlalchemy.engine.Engine - INFO - [cached since 0.2544s ago] ()
2025-06-19 20:44:32,549 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,550 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,550 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,550 - sqlalchemy.engine.Engine - INFO - [cached since 0.3095s ago] ()
2025-06-19 20:44:32,551 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,552 - sqlalchemy.engine.Engine - INFO - [cached since 0.2944s ago] ('Alerts', 'dbo')
2025-06-19 20:44:32,552 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,554 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,555 - sqlalchemy.engine.Engine - INFO - [cached since 0.314s ago] ()
2025-06-19 20:44:32,556 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:44:32,556 - sqlalchemy.engine.Engine - INFO - [cached since 0.2488s ago] ()
2025-06-19 20:44:32,557 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,559 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,559 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,560 - sqlalchemy.engine.Engine - INFO - [cached since 0.319s ago] ()
2025-06-19 20:44:32,561 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,561 - sqlalchemy.engine.Engine - INFO - [cached since 0.3039s ago] ('Threats', 'dbo')
2025-06-19 20:44:32,562 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,563 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,564 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,564 - sqlalchemy.engine.Engine - INFO - [cached since 0.3231s ago] ()
2025-06-19 20:44:32,565 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:44:32,565 - sqlalchemy.engine.Engine - INFO - [cached since 0.2345s ago] ()
2025-06-19 20:44:32,566 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,567 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,568 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,568 - sqlalchemy.engine.Engine - INFO - [cached since 0.3273s ago] ()
2025-06-19 20:44:32,569 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,569 - sqlalchemy.engine.Engine - INFO - [cached since 0.3121s ago] ('DetectionRules', 'dbo')
2025-06-19 20:44:32,570 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,572 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,572 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,573 - sqlalchemy.engine.Engine - INFO - [cached since 0.3318s ago] ()
2025-06-19 20:44:32,574 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:44:32,574 - sqlalchemy.engine.Engine - INFO - [cached since 0.2215s ago] ()
2025-06-19 20:44:32,575 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,576 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,577 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,577 - sqlalchemy.engine.Engine - INFO - [cached since 0.3362s ago] ()
2025-06-19 20:44:32,578 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,578 - sqlalchemy.engine.Engine - INFO - [cached since 0.3211s ago] ('SystemConfig', 'dbo')
2025-06-19 20:44:32,579 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,582 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,582 - sqlalchemy.engine.Engine - INFO - [cached since 0.3413s ago] ()
2025-06-19 20:44:32,583 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:44:32,583 - sqlalchemy.engine.Engine - INFO - [cached since 0.2081s ago] ()
2025-06-19 20:44:32,584 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,586 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,586 - sqlalchemy.engine.Engine - INFO - [cached since 0.3456s ago] ()
2025-06-19 20:44:32,588 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,588 - sqlalchemy.engine.Engine - INFO - [cached since 0.3309s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:44:32,591 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,593 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,594 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,594 - sqlalchemy.engine.Engine - INFO - [cached since 0.3534s ago] ()
2025-06-19 20:44:32,595 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:44:32,595 - sqlalchemy.engine.Engine - INFO - [cached since 0.2099s ago] ()
2025-06-19 20:44:32,596 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,597 - sqlalchemy.engine.Engine - INFO - 
                        SELECT 
                            SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                            SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                        FROM sys.database_files 
                        WHERE type_desc = 'ROWS'
                    
2025-06-19 20:44:32,598 - sqlalchemy.engine.Engine - INFO - [cached since 0.2084s ago] ()
2025-06-19 20:44:32,599 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,600 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,600 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,601 - sqlalchemy.engine.Engine - INFO - [cached since 0.36s ago] ()
2025-06-19 20:44:32,602 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,602 - sqlalchemy.engine.Engine - INFO - [cached since 0.345s ago] ('Agents', 'dbo')
2025-06-19 20:44:32,603 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,604 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,605 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,605 - sqlalchemy.engine.Engine - INFO - [cached since 0.3645s ago] ()
2025-06-19 20:44:32,606 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 20:44:32,607 - sqlalchemy.engine.Engine - INFO - [cached since 0.3262s ago] ()
2025-06-19 20:44:32,608 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,609 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,609 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,610 - sqlalchemy.engine.Engine - INFO - [cached since 0.369s ago] ()
2025-06-19 20:44:32,611 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,611 - sqlalchemy.engine.Engine - INFO - [cached since 0.3538s ago] ('Events', 'dbo')
2025-06-19 20:44:32,612 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,613 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,614 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,614 - sqlalchemy.engine.Engine - INFO - [cached since 0.3731s ago] ()
2025-06-19 20:44:32,615 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Events]
2025-06-19 20:44:32,615 - sqlalchemy.engine.Engine - INFO - [cached since 0.3218s ago] ()
2025-06-19 20:44:32,616 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,617 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,617 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,618 - sqlalchemy.engine.Engine - INFO - [cached since 0.377s ago] ()
2025-06-19 20:44:32,619 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,619 - sqlalchemy.engine.Engine - INFO - [cached since 0.3621s ago] ('Alerts', 'dbo')
2025-06-19 20:44:32,620 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,622 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,623 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,623 - sqlalchemy.engine.Engine - INFO - [cached since 0.3822s ago] ()
2025-06-19 20:44:32,624 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 20:44:32,624 - sqlalchemy.engine.Engine - INFO - [cached since 0.317s ago] ()
2025-06-19 20:44:32,625 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,626 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,627 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,627 - sqlalchemy.engine.Engine - INFO - [cached since 0.3865s ago] ()
2025-06-19 20:44:32,628 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,629 - sqlalchemy.engine.Engine - INFO - [cached since 0.3714s ago] ('Threats', 'dbo')
2025-06-19 20:44:32,630 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,631 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,631 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,632 - sqlalchemy.engine.Engine - INFO - [cached since 0.3909s ago] ()
2025-06-19 20:44:32,632 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 20:44:32,633 - sqlalchemy.engine.Engine - INFO - [cached since 0.3019s ago] ()
2025-06-19 20:44:32,633 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,634 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,635 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,635 - sqlalchemy.engine.Engine - INFO - [cached since 0.3946s ago] ()
2025-06-19 20:44:32,636 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,637 - sqlalchemy.engine.Engine - INFO - [cached since 0.3798s ago] ('DetectionRules', 'dbo')
2025-06-19 20:44:32,638 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,640 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,641 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,641 - sqlalchemy.engine.Engine - INFO - [cached since 0.4002s ago] ()
2025-06-19 20:44:32,642 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 20:44:32,643 - sqlalchemy.engine.Engine - INFO - [cached since 0.29s ago] ()
2025-06-19 20:44:32,643 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,644 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,645 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,645 - sqlalchemy.engine.Engine - INFO - [cached since 0.4046s ago] ()
2025-06-19 20:44:32,647 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,648 - sqlalchemy.engine.Engine - INFO - [cached since 0.3905s ago] ('SystemConfig', 'dbo')
2025-06-19 20:44:32,649 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,650 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,651 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,651 - sqlalchemy.engine.Engine - INFO - [cached since 0.4101s ago] ()
2025-06-19 20:44:32,652 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 20:44:32,652 - sqlalchemy.engine.Engine - INFO - [cached since 0.277s ago] ()
2025-06-19 20:44:32,653 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,655 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,655 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,655 - sqlalchemy.engine.Engine - INFO - [cached since 0.4146s ago] ()
2025-06-19 20:44:32,657 - sqlalchemy.engine.Engine - INFO - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 20:44:32,657 - sqlalchemy.engine.Engine - INFO - [cached since 0.4s ago] ('AgentConfigs', 'dbo')
2025-06-19 20:44:32,658 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,660 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,660 - sqlalchemy.engine.Engine - INFO - [cached since 0.4195s ago] ()
2025-06-19 20:44:32,661 - sqlalchemy.engine.Engine - INFO - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 20:44:32,662 - sqlalchemy.engine.Engine - INFO - [cached since 0.2761s ago] ()
2025-06-19 20:44:32,662 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,663 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,664 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,664 - sqlalchemy.engine.Engine - INFO - [cached since 0.4232s ago] ()
2025-06-19 20:44:32,665 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Agents 
                    WHERE LastHeartbeat >= DATEADD(minute, -10, GETDATE())
                    AND Status = 'Active'
                
2025-06-19 20:44:32,665 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] ()
2025-06-19 20:44:32,668 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Events 
                    WHERE CreatedAt >= DATEADD(hour, -1, GETDATE())
                
2025-06-19 20:44:32,669 - sqlalchemy.engine.Engine - INFO - [generated in 0.00058s] ()
2025-06-19 20:44:32,671 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                
2025-06-19 20:44:32,671 - sqlalchemy.engine.Engine - INFO - [generated in 0.00055s] ()
2025-06-19 20:44:32,674 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Alerts 
                    WHERE Status IN ('Open', 'Investigating')
                    AND Severity IN ('High', 'Critical')
                
2025-06-19 20:44:32,675 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] ()
2025-06-19 20:44:32,680 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM DetectionRules 
                    WHERE IsActive = 1
                
2025-06-19 20:44:32,680 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] ()
2025-06-19 20:44:32,687 - sqlalchemy.engine.Engine - INFO - 
                    SELECT COUNT(*) as count 
                    FROM Threats 
                    WHERE IsActive = 1
                
2025-06-19 20:44:32,688 - sqlalchemy.engine.Engine - INFO - [generated in 0.00082s] ()
2025-06-19 20:44:32,696 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,697 - app.database - INFO - ‚úÖ Database health check passed in 177ms
2025-06-19 20:44:32,698 - __main__ - INFO - ‚úÖ Database connected: EDR_System on Manh
2025-06-19 20:44:32,698 - __main__ - INFO - ‚è±Ô∏è Response time: 177ms
2025-06-19 20:44:32,699 - __main__ - INFO - üìä Agents: 0 records
2025-06-19 20:44:32,699 - __main__ - INFO - üìä Events: 0 records
2025-06-19 20:44:32,699 - __main__ - INFO - üìä Alerts: 0 records
2025-06-19 20:44:32,699 - __main__ - INFO - üìä Threats: 12 records
2025-06-19 20:44:32,699 - __main__ - INFO - üìä DetectionRules: 7 records
2025-06-19 20:44:32,700 - __main__ - INFO - üìä SystemConfig: 22 records
2025-06-19 20:44:32,700 - __main__ - INFO - üìä AgentConfigs: 0 records
2025-06-19 20:44:32,700 - __main__ - INFO - üîÑ Active agents (last 10min): 0
2025-06-19 20:44:32,700 - __main__ - INFO - üìà Events (last hour): 0
2025-06-19 20:44:32,700 - __main__ - INFO - üö® Open alerts: 0
2025-06-19 20:44:32,701 - __main__ - INFO - üõ°Ô∏è Active detection rules: 7
2025-06-19 20:44:32,701 - __main__ - INFO - üîç Active threat indicators: 12
2025-06-19 20:44:32,733 - __main__ - INFO - üß™ Testing database schema compliance...
2025-06-19 20:44:32,734 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,734 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-06-19 20:44:32,735 - sqlalchemy.engine.Engine - INFO - [cached since 0.494s ago] ()
2025-06-19 20:44:32,750 - sqlalchemy.engine.Engine - INFO - SELECT [Agents].[AgentID] AS [Agents_AgentID], [Agents].[HostName] AS [Agents_HostName], [Agents].[IPAddress] AS [Agents_IPAddress], [Agents].[MACAddress] AS [Agents_MACAddress], [Agents].[OperatingSystem] AS [Agents_OperatingSystem], [Agents].[OSVersion] AS [Agents_OSVersion], [Agents].[Architecture] AS [Agents_Architecture], [Agents].[Domain] AS [Agents_Domain], [Agents].[AgentVersion] AS [Agents_AgentVersion], [Agents].[InstallPath] AS [Agents_InstallPath], [Agents].[Status] AS [Agents_Status], [Agents].[LastHeartbeat] AS [Agents_LastHeartbeat], [Agents].[FirstSeen] AS [Agents_FirstSeen], [Agents].[CPUUsage] AS [Agents_CPUUsage], [Agents].[MemoryUsage] AS [Agents_MemoryUsage], [Agents].[DiskUsage] AS [Agents_DiskUsage], [Agents].[NetworkLatency] AS [Agents_NetworkLatency], [Agents].[MonitoringEnabled] AS [Agents_MonitoringEnabled], [Agents].[CreatedAt] AS [Agents_CreatedAt], [Agents].[UpdatedAt] AS [Agents_UpdatedAt] 
FROM [Agents] 
WHERE [Agents].[HostName] LIKE ?
2025-06-19 20:44:32,751 - sqlalchemy.engine.Engine - INFO - [generated in 0.00100s] ('TEST-SCHEMA-%',)
2025-06-19 20:44:32,761 - sqlalchemy.engine.Engine - INFO - INSERT INTO [Agents] ([AgentID], [HostName], [IPAddress], [MACAddress], [OperatingSystem], [OSVersion], [Architecture], [Domain], [AgentVersion], [InstallPath], [Status], [LastHeartbeat], [FirstSeen], [CPUUsage], [MemoryUsage], [DiskUsage], [NetworkLatency], [MonitoringEnabled], [CreatedAt], [UpdatedAt]) OUTPUT inserted.[LastHeartbeat], inserted.[FirstSeen], inserted.[CreatedAt], inserted.[UpdatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate(), getdate(), ?, ?, ?, ?, ?, getdate(), getdate())
2025-06-19 20:44:32,762 - sqlalchemy.engine.Engine - INFO - [generated in 0.00095s] (UUID('12498218-ad9f-4a04-a578-d8ef025625db'), 'TEST-SCHEMA-1750340672-0feb7250', '192.168.20.200', None, 'Windows 11 Pro', None, None, None, '1.0.0', None, 'Active', 0.0, 0.0, 0.0, 0, 1)
2025-06-19 20:44:32,771 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,774 - __main__ - INFO - ‚úÖ Agent test successful: 12498218-ad9f-4a04-a578-d8ef025625db
2025-06-19 20:44:32,774 - __main__ - INFO - ‚úÖ Test hostname: TEST-SCHEMA-1750340672-0feb7250
2025-06-19 20:44:32,775 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-19 20:44:32,777 - sqlalchemy.engine.Engine - INFO - DELETE FROM [Agents] WHERE [Agents].[AgentID] = ?
2025-06-19 20:44:32,777 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (UUID('12498218-ad9f-4a04-a578-d8ef025625db'),)
2025-06-19 20:44:32,799 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-19 20:44:32,800 - __main__ - INFO - üßπ Test agent cleaned up
2025-06-19 20:44:32,800 - __main__ - INFO - ‚úÖ Database schema test completed successfully
2025-06-19 20:44:32,800 - __main__ - INFO - üéØ Final startup preparations...
2025-06-19 20:44:32,800 - __main__ - INFO - üåê Server will bind to: 192.168.20.85:5000
2025-06-19 20:44:32,801 - __main__ - INFO - üîÑ Reload mode: Enabled
2025-06-19 20:44:32,801 - __main__ - INFO - üêõ Debug mode: Enabled
2025-06-19 20:44:32,801 - __main__ - INFO - üîß LOCAL SQL SERVER MODE:
2025-06-19 20:44:32,801 - __main__ - INFO -    ‚Ä¢ Connected to local SQL Server instance
2025-06-19 20:44:32,801 - __main__ - INFO -    ‚Ä¢ Using Windows Authentication
2025-06-19 20:44:32,802 - __main__ - INFO -    ‚Ä¢ EDR_System database ready
2025-06-19 20:44:32,802 - __main__ - INFO -    ‚Ä¢ All services operational
2025-06-19 20:44:32,802 - __main__ - INFO - üöÄ Starting EDR Agent Communication Server...
2025-06-20 08:46:24,994 - __main__ - INFO - üöÄ EDR Agent Communication Server - Local SQL Startup
2025-06-20 08:46:25,024 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-20 08:46:25,024 - __main__ - INFO - üîç Performing environment checks...
2025-06-20 08:46:25,025 - __main__ - INFO - üîç Checking SQL Server services...
2025-06-20 08:46:25,042 - __main__ - INFO - ‚úÖ MSSQLSERVER is running
2025-06-20 08:46:25,073 - __main__ - WARNING - ‚ö†Ô∏è SQLBrowser exists but not running
2025-06-20 08:46:25,073 - __main__ - INFO - ‚úÖ Found 1 running SQL Server service(s)
2025-06-20 08:46:25,073 - __main__ - INFO - üîç Testing local SQL Server connections...
2025-06-20 08:46:25,073 - __main__ - INFO - üîå Testing: localhost
2025-06-20 08:46:25,238 - __main__ - INFO - ‚úÖ SUCCESS! Connected to SQL Server via: localhost
2025-06-20 08:46:25,238 - __main__ - INFO -    SQL Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64) 
	Oct  8...
2025-06-20 08:46:25,239 - __main__ - INFO - ‚úÖ EDR_System database found
2025-06-20 08:46:25,239 - __main__ - INFO - üéØ Using SQL Server: localhost
2025-06-20 08:46:25,991 - app.database - INFO - üîó Initializing database connection to: 192.168.20.85,1433/EDR_System
2025-06-20 08:46:26,035 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-20 08:46:26,035 - __main__ - INFO - üóÑÔ∏è Initializing database...
2025-06-20 08:46:26,035 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-20 08:46:57,042 - app.database - ERROR - ‚ùå Database connection test failed (attempt 1/5): (pyodbc.OperationalError) ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: The wait operation timed out.\r\n (258) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Invalid connection string attribute (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (258)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-20 08:46:57,043 - app.database - INFO - ‚è≥ Waiting 1 seconds before retry...
2025-06-20 08:50:23,993 - __main__ - INFO - üöÄ EDR Agent Communication Server - IMPROVED Startup
2025-06-20 08:50:23,997 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting
2025-06-20 08:50:23,997 - __main__ - INFO - üîç Performing environment checks...
2025-06-20 08:50:23,997 - __main__ - INFO - üîç Checking SQL Server services...
2025-06-20 08:50:24,010 - __main__ - INFO - ‚úÖ MSSQLSERVER is running
2025-06-20 08:50:24,011 - __main__ - INFO - ‚úÖ SQL Server is running
2025-06-20 08:50:24,011 - __main__ - INFO - üîç Testing SQL Server connections (quick mode)...
2025-06-20 08:50:24,011 - __main__ - INFO - üîå Testing: localhost
2025-06-20 08:50:24,075 - __main__ - INFO - ‚úÖ SUCCESS! Connected via: localhost
2025-06-20 08:50:24,075 - __main__ - INFO -    Server: Manh
2025-06-20 08:50:24,075 - __main__ - INFO -    Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64) 
	Oct  8...
2025-06-20 08:50:24,103 - __main__ - INFO - ‚úÖ EDR_System database found
2025-06-20 08:50:24,104 - __main__ - INFO - üéØ Using detected server: localhost
2025-06-20 08:50:24,104 - __main__ - INFO - üì¶ Loading application configuration...
2025-06-20 08:50:24,331 - app.database - INFO - üîó Initializing database connection to: 192.168.20.85,1433/EDR_System
2025-06-20 08:54:53,501 - __main__ - INFO - üöÄ EDR Agent Communication Server - Local SQL Startup
2025-06-20 08:54:53,505 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-20 08:54:53,505 - __main__ - INFO - üîç Performing environment checks...
2025-06-20 08:54:53,505 - __main__ - INFO - üîç Checking SQL Server services...
2025-06-20 08:54:53,518 - __main__ - INFO - ‚úÖ MSSQLSERVER is running
2025-06-20 08:54:53,545 - __main__ - WARNING - ‚ö†Ô∏è SQLBrowser exists but not running
2025-06-20 08:54:53,545 - __main__ - INFO - ‚úÖ Found 1 running SQL Server service(s)
2025-06-20 08:54:53,546 - __main__ - INFO - üîç Testing local SQL Server connections...
2025-06-20 08:54:53,546 - __main__ - INFO - üîå Testing: localhost
2025-06-20 08:54:53,635 - __main__ - INFO - ‚úÖ SUCCESS! Connected to SQL Server via: localhost
2025-06-20 08:54:53,635 - __main__ - INFO -    SQL Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64) 
	Oct  8...
2025-06-20 08:54:53,636 - __main__ - INFO - ‚úÖ EDR_System database found
2025-06-20 08:54:53,636 - __main__ - INFO - üéØ Using SQL Server: localhost
2025-06-20 08:54:53,931 - app.database - INFO - üîó Initializing database connection to: 192.168.20.85,1433/EDR_System
2025-06-20 08:55:09,776 - app.database - WARNING - ‚ö†Ô∏è Original config failed: (pyodbc.OperationalError) ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: No connection could be made because the target machine actively refused it.\r\n (10061) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Invalid connection string attribute (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (10061)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-20 08:55:09,776 - app.database - INFO - üîÑ Attempting auto-detection...
2025-06-20 08:55:09,777 - app.database - INFO - üîç Auto-detecting SQL Server connection...
2025-06-20 08:55:16,190 - app.database - INFO - ‚úÖ Auto-detected working server: localhost
2025-06-20 08:55:16,191 - app.database - INFO - üìä Database: EDR_System
2025-06-20 08:55:16,192 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-20 08:55:16,193 - __main__ - INFO - üóÑÔ∏è Initializing database...
2025-06-20 08:55:16,193 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-20 08:55:16,208 - app.database - INFO - ‚úÖ Database connection verified (attempt 1/2)
2025-06-20 08:55:16,209 - app.database - INFO - üïê Server time: 2025-06-20 08:55:16.207000
2025-06-20 08:55:16,209 - app.database - INFO - üñ•Ô∏è Server: Manh, Database: EDR_System
2025-06-20 08:55:16,211 - app.database - INFO - ‚úÖ Database connection verified (attempt 1/1)
2025-06-20 08:55:16,211 - app.database - INFO - üïê Server time: 2025-06-20 08:55:16.210000
2025-06-20 08:55:16,211 - app.database - INFO - üñ•Ô∏è Server: Manh, Database: EDR_System
2025-06-20 08:55:16,254 - app.database - INFO - ‚úÖ Database health check passed in 43ms
2025-06-20 08:55:16,254 - app.database - INFO - üéØ Using auto-detected server: localhost
2025-06-20 08:55:16,254 - app.database - INFO - üìä Database ready - 7 tables, 41 total records
2025-06-20 08:55:16,255 - app.database - INFO - ‚ö° Response time: 43ms
2025-06-20 08:55:16,255 - app.database - INFO -    üìã Agents: 0 records
2025-06-20 08:55:16,255 - app.database - INFO -    üìã Events: 0 records
2025-06-20 08:55:16,255 - app.database - INFO -    üìã Alerts: 0 records
2025-06-20 08:55:16,256 - app.database - INFO -    üìã Threats: 12 records
2025-06-20 08:55:16,256 - app.database - INFO -    üìã DetectionRules: 7 records
2025-06-20 08:55:16,256 - app.database - INFO -    üìã SystemConfig: 22 records
2025-06-20 08:55:16,256 - app.database - INFO -    üìã AgentConfigs: 0 records
2025-06-20 08:55:16,256 - __main__ - INFO - ‚úÖ Database connection successful
2025-06-20 08:55:16,257 - __main__ - INFO - ‚úÖ Environment check completed successfully
2025-06-20 08:55:16,257 - __main__ - INFO - üìä Retrieving database information...
2025-06-20 08:55:16,258 - app.database - INFO - ‚úÖ Database connection verified (attempt 1/1)
2025-06-20 08:55:16,258 - app.database - INFO - üïê Server time: 2025-06-20 08:55:16.257000
2025-06-20 08:55:16,259 - app.database - INFO - üñ•Ô∏è Server: Manh, Database: EDR_System
2025-06-20 08:55:16,264 - app.database - INFO - ‚úÖ Database health check passed in 7ms
2025-06-20 08:55:16,265 - __main__ - INFO - ‚úÖ Database connected: None on None
2025-06-20 08:55:16,265 - __main__ - INFO - ‚è±Ô∏è Response time: 7ms
2025-06-20 08:55:16,265 - __main__ - INFO - üìä Agents: 0 records
2025-06-20 08:55:16,265 - __main__ - INFO - üìä Events: 0 records
2025-06-20 08:55:16,266 - __main__ - INFO - üìä Alerts: 0 records
2025-06-20 08:55:16,266 - __main__ - INFO - üìä Threats: 12 records
2025-06-20 08:55:16,266 - __main__ - INFO - üìä DetectionRules: 7 records
2025-06-20 08:55:16,266 - __main__ - INFO - üìä SystemConfig: 22 records
2025-06-20 08:55:16,267 - __main__ - INFO - üìä AgentConfigs: 0 records
2025-06-20 08:55:16,353 - __main__ - INFO - üß™ Testing database schema compliance...
2025-06-20 08:55:16,392 - __main__ - INFO - ‚úÖ Agent test successful: deb9ece9-7cca-49f0-82ce-8ae9ec221193
2025-06-20 08:55:16,392 - __main__ - INFO - ‚úÖ Test hostname: TEST-SCHEMA-1750384516-2f2e601d
2025-06-20 08:55:16,411 - __main__ - INFO - üßπ Test agent cleaned up
2025-06-20 08:55:16,412 - __main__ - INFO - ‚úÖ Database schema test completed successfully
2025-06-20 08:55:16,412 - __main__ - INFO - üéØ Final startup preparations...
2025-06-20 08:55:16,412 - __main__ - INFO - üåê Server will bind to: 192.168.20.85:5000
2025-06-20 08:55:16,412 - __main__ - INFO - üîÑ Reload mode: Disabled
2025-06-20 08:55:16,413 - __main__ - INFO - üêõ Debug mode: Disabled
2025-06-20 08:55:16,413 - __main__ - INFO - üîß LOCAL SQL SERVER MODE:
2025-06-20 08:55:16,413 - __main__ - INFO -    ‚Ä¢ Connected to local SQL Server instance
2025-06-20 08:55:16,413 - __main__ - INFO -    ‚Ä¢ Using Windows Authentication
2025-06-20 08:55:16,413 - __main__ - INFO -    ‚Ä¢ EDR_System database ready
2025-06-20 08:55:16,414 - __main__ - INFO -    ‚Ä¢ All services operational
2025-06-20 08:55:16,414 - __main__ - INFO - üöÄ Starting EDR Agent Communication Server...
2025-06-20 08:55:41,060 - __main__ - INFO - üöÄ EDR Agent Communication Server - Local SQL Startup
2025-06-20 08:55:41,064 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-20 08:55:41,064 - __main__ - INFO - üîç Performing environment checks...
2025-06-20 08:55:41,064 - __main__ - INFO - üîç Checking SQL Server services...
2025-06-20 08:55:41,079 - __main__ - INFO - ‚úÖ MSSQLSERVER is running
2025-06-20 08:55:41,105 - __main__ - WARNING - ‚ö†Ô∏è SQLBrowser exists but not running
2025-06-20 08:55:41,106 - __main__ - INFO - ‚úÖ Found 1 running SQL Server service(s)
2025-06-20 08:55:41,106 - __main__ - INFO - üîç Testing local SQL Server connections...
2025-06-20 08:55:41,106 - __main__ - INFO - üîå Testing: localhost
2025-06-20 08:55:41,154 - __main__ - INFO - ‚úÖ SUCCESS! Connected to SQL Server via: localhost
2025-06-20 08:55:41,154 - __main__ - INFO -    SQL Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64) 
	Oct  8...
2025-06-20 08:55:41,154 - __main__ - INFO - ‚úÖ EDR_System database found
2025-06-20 08:55:41,155 - __main__ - INFO - üéØ Using SQL Server: localhost
2025-06-20 08:55:41,384 - app.database - INFO - üîó Initializing database connection to: 192.168.20.85,1433/EDR_System
2025-06-20 08:55:41,396 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-20 08:55:41,396 - __main__ - INFO - üóÑÔ∏è Initializing database...
2025-06-20 08:55:41,397 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-20 08:58:47,281 - __main__ - INFO - üöÄ EDR Agent Communication Server - Enhanced Local SQL Startup
2025-06-20 08:58:47,285 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-20 08:58:47,285 - __main__ - INFO - üîç Performing comprehensive environment checks...
2025-06-20 08:58:47,286 - __main__ - INFO - üîç Checking ODBC Driver for SQL Server...
2025-06-20 08:58:47,293 - __main__ - INFO - ‚úÖ Found SQL Server ODBC drivers: ['SQL Server', 'SQL Server Native Client RDA 11.0', 'ODBC Driver 17 for SQL Server']
2025-06-20 08:58:47,293 - __main__ - INFO - üîç Testing local SQL Server connections...
2025-06-20 08:58:47,293 - __main__ - INFO - üîç Checking SQL Server services...
2025-06-20 08:58:47,309 - __main__ - INFO - ‚úÖ SQL Server (Default Instance) is running
2025-06-20 08:58:47,352 - __main__ - WARNING - ‚ö†Ô∏è SQL Browser Service exists but not running
2025-06-20 08:58:47,352 - __main__ - INFO - üîÑ Attempting to start SQL Browser Service...
2025-06-20 08:58:48,722 - __main__ - WARNING - ‚ö†Ô∏è Failed to start SQL Browser Service: System error 5 has occurred.

Access is denied.


2025-06-20 08:58:48,722 - __main__ - INFO - ‚úÖ Found 1 running SQL Server service(s)
2025-06-20 08:58:48,722 - __main__ - INFO - üîå Testing: localhost
2025-06-20 08:58:48,818 - __main__ - INFO - ‚úÖ SUCCESS! Connected to SQL Server via: localhost
2025-06-20 08:58:48,819 - __main__ - INFO -    Server Name: Manh
2025-06-20 08:58:48,819 - __main__ - INFO -    SQL Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64) 
	Oct  8 2022 05:58:25 
	Cop...
2025-06-20 08:58:48,866 - __main__ - INFO - ‚úÖ EDR_System database found
2025-06-20 08:58:48,866 - __main__ - INFO - üéØ Using SQL Server: localhost
2025-06-20 08:58:49,111 - app.database - INFO - üîó Initializing database connection to: 192.168.20.85,1433/EDR_System
2025-06-20 08:59:29,931 - __main__ - INFO - üöÄ EDR Agent Communication Server - Local SQL Startup
2025-06-20 08:59:29,942 - __main__ - INFO - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-20 08:59:29,942 - __main__ - INFO - üîç Performing environment checks...
2025-06-20 08:59:29,942 - __main__ - INFO - üîç Checking SQL Server services...
2025-06-20 08:59:29,957 - __main__ - INFO - ‚úÖ MSSQLSERVER is running
2025-06-20 08:59:29,981 - __main__ - WARNING - ‚ö†Ô∏è SQLBrowser exists but not running
2025-06-20 08:59:29,982 - __main__ - INFO - ‚úÖ Found 1 running SQL Server service(s)
2025-06-20 08:59:29,982 - __main__ - INFO - üîç Testing local SQL Server connections...
2025-06-20 08:59:29,982 - __main__ - INFO - üîå Testing: localhost
2025-06-20 08:59:30,109 - __main__ - INFO - ‚úÖ SUCCESS! Connected to SQL Server via: localhost
2025-06-20 08:59:30,109 - __main__ - INFO -    SQL Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64) 
	Oct  8...
2025-06-20 08:59:30,109 - __main__ - INFO - ‚úÖ EDR_System database found
2025-06-20 08:59:30,110 - __main__ - INFO - üéØ Using SQL Server: localhost
2025-06-20 08:59:30,349 - app.database - INFO - üîó Initializing database connection to: 192.168.20.85,1433/EDR_System
2025-06-20 08:59:30,361 - app.database - INFO - ‚úÖ Database engine initialized successfully
2025-06-20 08:59:30,361 - __main__ - INFO - üóÑÔ∏è Initializing database...
2025-06-20 08:59:30,362 - app.database - INFO - üîÑ Initializing EDR database connection...
2025-06-20 09:00:01,379 - app.database - ERROR - ‚ùå Database connection test failed (attempt 1/5): (pyodbc.OperationalError) ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]TCP Provider: The wait operation timed out.\r\n (258) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]Invalid connection string attribute (0); [08001] [Microsoft][ODBC Driver 17 for SQL Server]A network-related or instance-specific error has occurred while establishing a connection to SQL Server. Server is not found or not accessible. Check if instance name is correct and if SQL Server is configured to allow remote connections. For more information see SQL Server Books Online. (258)')
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-20 09:00:01,379 - app.database - INFO - ‚è≥ Waiting 1 seconds before retry...
