2025-06-22 15:50:37 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 15:50:37 - app.database - INFO - init_database:416 - ğŸ”— Initializing database connection...
2025-06-22 15:50:37 - app.database - INFO - test_connection_realtime:324 - âœ… REALTIME DB connected: Manh / EDR_System (1.0ms)
2025-06-22 15:50:37 - app.database - INFO - init_database:434 - âœ… Database initialized: 7 tables found
2025-06-22 15:50:37 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 15:50:37 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 15:50:37 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 15:50:37 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 15:50:37 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 15:52:55 - app.main - INFO - lifespan:53 - ğŸ‘‹ Shutting down EDR Agent Communication Server...
2025-06-22 15:53:15 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 15:53:15 - app.database - INFO - init_database:412 - ğŸ”— Initializing database connection...
2025-06-22 15:53:15 - app.database - INFO - test_connection_realtime:322 - âœ… REALTIME DB connected: Manh / EDR_System (1.4ms)
2025-06-22 15:53:15 - app.database - INFO - init_database:430 - âœ… Database initialized: 7 tables found
2025-06-22 15:53:15 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 15:53:15 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 15:53:15 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 15:53:15 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 15:53:15 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 15:54:28 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.077s - Client: 192.168.20.133
2025-06-22 16:08:10 - app.main - INFO - lifespan:53 - ğŸ‘‹ Shutting down EDR Agent Communication Server...
2025-06-22 16:14:44 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 16:14:44 - app.database - INFO - init_database:412 - ğŸ”— Initializing database connection...
2025-06-22 16:14:44 - app.database - INFO - test_connection_realtime:322 - âœ… REALTIME DB connected: Manh / EDR_System (1.3ms)
2025-06-22 16:14:44 - app.database - INFO - init_database:430 - âœ… Database initialized: 7 tables found
2025-06-22 16:14:44 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 16:14:44 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 16:14:44 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 16:14:44 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 16:14:44 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 16:35:15 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.045s - Client: 192.168.20.133
2025-06-22 16:37:24 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.046s - Client: 192.168.20.133
2025-06-22 16:39:54 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.040s - Client: 192.168.20.133
2025-06-22 16:46:03 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.037s - Client: 192.168.20.133
2025-06-22 16:48:02 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.046s - Client: 192.168.20.133
2025-06-22 16:52:09 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.038s - Client: 192.168.20.133
2025-06-22 17:00:23 - app.main - INFO - lifespan:53 - ğŸ‘‹ Shutting down EDR Agent Communication Server...
2025-06-22 17:00:45 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 17:00:45 - app.database - INFO - init_database:412 - ğŸ”— Initializing database connection...
2025-06-22 17:00:45 - app.database - INFO - test_connection_realtime:322 - âœ… REALTIME DB connected: Manh / EDR_System (1.0ms)
2025-06-22 17:00:45 - app.database - INFO - init_database:430 - âœ… Database initialized: 7 tables found
2025-06-22 17:00:45 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 17:00:45 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 17:00:45 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 17:00:45 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 17:00:45 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 17:01:39 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.042s - Client: 192.168.20.133
2025-06-22 17:42:03 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.054s - Client: 192.168.20.133
2025-06-22 17:50:56 - app.main - INFO - lifespan:53 - ğŸ‘‹ Shutting down EDR Agent Communication Server...
2025-06-22 17:51:16 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 17:51:16 - app.database - INFO - init_database:412 - ğŸ”— Initializing database connection...
2025-06-22 17:51:16 - app.database - INFO - test_connection_realtime:322 - âœ… REALTIME DB connected: Manh / EDR_System (1.4ms)
2025-06-22 17:51:16 - app.database - INFO - init_database:430 - âœ… Database initialized: 7 tables found
2025-06-22 17:51:16 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 17:51:16 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 17:51:16 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 17:51:16 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 17:51:16 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 17:51:47 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.019s - Client: 192.168.20.133
2025-06-22 17:51:54 - agent_communication - INFO - _update_existing_agent:148 - Existing agent updated: DESKTOP-O304IOJ (192.168.20.133)
2025-06-22 17:51:54 - agent_communication - INFO - register_agent:52 - Agent registered successfully: DESKTOP-O304IOJ from 192.168.20.133
2025-06-22 17:51:54 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/register - Status: 200 - Time: 0.082s - Client: 192.168.20.133
2025-06-22 17:51:54 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /api/v1/agents/f47fbd44-e250-42c4-b1ec-67bc2f23330f/pending-alerts - Status: 404 - Time: 0.000s - Client: 192.168.20.133
2025-06-22 17:52:35 - app.main - INFO - lifespan:53 - ğŸ‘‹ Shutting down EDR Agent Communication Server...
2025-06-22 17:52:59 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 17:52:59 - app.database - INFO - init_database:412 - ğŸ”— Initializing database connection...
2025-06-22 17:52:59 - app.database - INFO - test_connection_realtime:322 - âœ… REALTIME DB connected: Manh / EDR_System (1.2ms)
2025-06-22 17:52:59 - app.database - INFO - init_database:430 - âœ… Database initialized: 7 tables found
2025-06-22 17:52:59 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 17:52:59 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 17:52:59 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 17:52:59 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 17:52:59 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 17:53:15 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/heartbeat - Status: 200 - Time: 0.040s - Client: 192.168.20.133
2025-06-22 17:53:15 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.AUTHENTICATION, Action=Login, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 17:53:15 - event_processing - ERROR - submit_event:174 - Event submission failed after 0.037s: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]INSERT failed because the following SET options have incorrect settings: 'ANSI_WARNINGS'. Verify that SET options are correct for use with indexed views and/or indexes on computed columns and/or filtered indexes and/or query notifications and/or XML data type methods and/or spatial index operations. (1934) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
[SQL: INSERT INTO [Events] ([AgentID], [EventType], [EventAction], [EventTimestamp], [Severity], [ProcessID], [ProcessName], [ProcessPath], [CommandLine], [ParentPID], [ParentProcessName], [ProcessUser], [ProcessHash], [FilePath], [FileName], [FileSize], [FileHash], [FileExtension], [FileOperation], [SourceIP], [DestinationIP], [SourcePort], [DestinationPort], [Protocol], [Direction], [RegistryKey], [RegistryValueName], [RegistryValueData], [RegistryOperation], [LoginUser], [LoginType], [LoginResult], [ThreatLevel], [RiskScore], [Analyzed], [AnalyzedAt], [RawEventData], [CreatedAt]) OUTPUT inserted.[EventID], inserted.[CreatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate())]
[parameters: ('f47fbd44-e250-42c4-b1ec-67bc2f23330f', 'Authentication', 'Login', datetime.datetime(2025, 6, 22, 17, 53, 2, 461393), 'Info', None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, 'Manh', None, None, 'None', 0, 0, None, '{"event_source": "Test", "event_id": 4624, "event_time": "2025-06-22T17:53:02.461393", "username": "Manh", "login_type": "Interactive", "test_event": true}')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-22 17:53:15 - event_processing - WARNING - submit_event:68 - âŒ Event submission failed from 192.168.20.133: Event submission failed after 0.037s: (pyodbc.ProgrammingError) ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]INSERT failed because the following SET options have incorrect settings: 'ANSI_WARNINGS'. Verify that SET options are correct for use with indexed views and/or indexes on computed columns and/or filtered indexes and/or query notifications and/or XML data type methods and/or spatial index operations. (1934) (SQLExecDirectW); [42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
[SQL: INSERT INTO [Events] ([AgentID], [EventType], [EventAction], [EventTimestamp], [Severity], [ProcessID], [ProcessName], [ProcessPath], [CommandLine], [ParentPID], [ParentProcessName], [ProcessUser], [ProcessHash], [FilePath], [FileName], [FileSize], [FileHash], [FileExtension], [FileOperation], [SourceIP], [DestinationIP], [SourcePort], [DestinationPort], [Protocol], [Direction], [RegistryKey], [RegistryValueName], [RegistryValueData], [RegistryOperation], [LoginUser], [LoginType], [LoginResult], [ThreatLevel], [RiskScore], [Analyzed], [AnalyzedAt], [RawEventData], [CreatedAt]) OUTPUT inserted.[EventID], inserted.[CreatedAt] VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, getdate())]
[parameters: ('f47fbd44-e250-42c4-b1ec-67bc2f23330f', 'Authentication', 'Login', datetime.datetime(2025, 6, 22, 17, 53, 2, 461393), 'Info', None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, 'Manh', None, None, 'None', 0, 0, None, '{"event_source": "Test", "event_id": 4624, "event_time": "2025-06-22T17:53:02.461393", "username": "Manh", "login_type": "Interactive", "test_event": true}')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-22 17:53:15 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 400 - Time: 0.050s - Client: 192.168.20.133
2025-06-22 17:53:16 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/heartbeat - Status: 200 - Time: 0.010s - Client: 192.168.20.133
2025-06-22 17:57:53 - app.main - INFO - lifespan:53 - ğŸ‘‹ Shutting down EDR Agent Communication Server...
2025-06-22 17:59:45 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 17:59:45 - app.database - INFO - init_database:447 - ğŸ”— Initializing database connection with ANSI_WARNINGS fix...
2025-06-22 17:59:45 - app.database - INFO - test_connection_realtime:349 - âœ… REALTIME DB connected: Manh / EDR_System (1.1ms) ANSI_WARNINGS: ON
2025-06-22 17:59:45 - app.database - INFO - init_database:466 - âœ… Database initialized with ANSI fix: 7 tables found
2025-06-22 17:59:45 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 17:59:45 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 17:59:45 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 17:59:45 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 17:59:45 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 18:00:05 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.016s - Client: 192.168.20.133
2025-06-22 18:00:11 - agent_communication - INFO - _update_existing_agent:148 - Existing agent updated: DESKTOP-O304IOJ (192.168.20.133)
2025-06-22 18:00:11 - agent_communication - INFO - register_agent:52 - Agent registered successfully: DESKTOP-O304IOJ from 192.168.20.133
2025-06-22 18:00:11 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/register - Status: 200 - Time: 0.036s - Client: 192.168.20.133
2025-06-22 18:00:12 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /api/v1/agents/f47fbd44-e250-42c4-b1ec-67bc2f23330f/pending-alerts - Status: 404 - Time: 0.000s - Client: 192.168.20.133
2025-06-22 18:01:12 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/heartbeat - Status: 200 - Time: 0.024s - Client: 192.168.20.133
2025-06-22 18:01:37 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.NETWORK, Action=Create, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:01:37 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10002, Type=Network, Agent=DESKTOP-O304IOJ, Action=Create, Severity=Info, Timestamp=2025-06-22 18:01:08.058092
2025-06-22 18:01:37 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10002, Type=Network, Agent=DESKTOP-O304IOJ, Risk=90, Time=0.042s
2025-06-22 18:01:37 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10002, Risk=90, Client=192.168.20.133, Time=0.043s
2025-06-22 18:01:37 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:01:37 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.069s - Client: 192.168.20.133
2025-06-22 18:01:46 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.PROCESS, Action=Start, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:01:46 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10003, Type=Process, Agent=DESKTOP-O304IOJ, Action=Start, Severity=High, Timestamp=2025-06-22 18:00:19.207652
2025-06-22 18:01:46 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10003, Type=Process, Agent=DESKTOP-O304IOJ, Risk=100, Time=0.012s
2025-06-22 18:01:46 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10003, Risk=100, Client=192.168.20.133, Time=0.014s
2025-06-22 18:01:46 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:01:46 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.025s - Client: 192.168.20.133
2025-06-22 18:01:54 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.NETWORK, Action=Create, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:01:54 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10004, Type=Network, Agent=DESKTOP-O304IOJ, Action=Create, Severity=Info, Timestamp=2025-06-22 18:01:08.070934
2025-06-22 18:01:54 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10004, Type=Network, Agent=DESKTOP-O304IOJ, Risk=90, Time=0.020s
2025-06-22 18:01:54 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10004, Risk=90, Client=192.168.20.133, Time=0.021s
2025-06-22 18:01:54 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:01:54 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.033s - Client: 192.168.20.133
2025-06-22 18:02:02 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.AUTHENTICATION, Action=Login, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:02:02 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10005, Type=Authentication, Agent=DESKTOP-O304IOJ, Action=Login, Severity=Info, Timestamp=2025-06-22 18:01:45.957680
2025-06-22 18:02:02 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.021s - Client: 192.168.20.133
2025-06-22 18:02:12 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.PROCESS, Action=Start, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:02:12 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10006, Type=Process, Agent=DESKTOP-O304IOJ, Action=Start, Severity=High, Timestamp=2025-06-22 18:00:19.216490
2025-06-22 18:02:12 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10006, Type=Process, Agent=DESKTOP-O304IOJ, Risk=100, Time=0.014s
2025-06-22 18:02:12 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10006, Risk=100, Client=192.168.20.133, Time=0.015s
2025-06-22 18:02:12 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:02:12 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.027s - Client: 192.168.20.133
2025-06-22 18:02:20 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.NETWORK, Action=Create, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:02:20 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10007, Type=Network, Agent=DESKTOP-O304IOJ, Action=Create, Severity=Info, Timestamp=2025-06-22 18:01:08.125089
2025-06-22 18:02:20 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10007, Type=Network, Agent=DESKTOP-O304IOJ, Risk=90, Time=0.020s
2025-06-22 18:02:20 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10007, Risk=90, Client=192.168.20.133, Time=0.022s
2025-06-22 18:02:20 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:02:20 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.034s - Client: 192.168.20.133
2025-06-22 18:02:57 - app.main - INFO - lifespan:53 - ğŸ‘‹ Shutting down EDR Agent Communication Server...
2025-06-22 18:03:19 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 18:03:19 - app.database - INFO - init_database:447 - ğŸ”— Initializing database connection with ANSI_WARNINGS fix...
2025-06-22 18:03:19 - app.database - INFO - test_connection_realtime:349 - âœ… REALTIME DB connected: Manh / EDR_System (1.1ms) ANSI_WARNINGS: ON
2025-06-22 18:03:19 - app.database - INFO - init_database:466 - âœ… Database initialized with ANSI fix: 7 tables found
2025-06-22 18:03:19 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 18:03:19 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 18:03:19 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 18:03:19 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 18:03:19 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 18:08:54 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.044s - Client: 192.168.20.133
2025-06-22 18:08:56 - agent_communication - INFO - _update_existing_agent:148 - Existing agent updated: DESKTOP-O304IOJ (192.168.20.133)
2025-06-22 18:08:56 - agent_communication - INFO - register_agent:53 - Agent registered successfully: DESKTOP-O304IOJ from 192.168.20.133
2025-06-22 18:08:56 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/register - Status: 200 - Time: 0.055s - Client: 192.168.20.133
2025-06-22 18:08:56 - agent_communication - INFO - get_pending_alerts:124 - ğŸ“‹ Retrieved 0 pending alerts for agent DESKTOP-O304IOJ
2025-06-22 18:08:56 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /api/v1/agents/f47fbd44-e250-42c4-b1ec-67bc2f23330f/pending-alerts - Status: 200 - Time: 0.025s - Client: 192.168.20.133
2025-06-22 18:08:59 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.PROCESS, Action=Start, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:08:59 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10008, Type=Process, Agent=DESKTOP-O304IOJ, Action=Start, Severity=High, Timestamp=2025-06-22 18:08:59.357412
2025-06-22 18:08:59 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10008, Type=Process, Agent=DESKTOP-O304IOJ, Risk=100, Time=0.024s
2025-06-22 18:08:59 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10008, Risk=100, Client=192.168.20.133, Time=0.026s
2025-06-22 18:08:59 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:08:59 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.051s - Client: 192.168.20.133
2025-06-22 18:09:43 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/heartbeat - Status: 200 - Time: 0.027s - Client: 192.168.20.133
2025-06-22 18:09:43 - agent_communication - INFO - get_pending_alerts:124 - ğŸ“‹ Retrieved 0 pending alerts for agent DESKTOP-O304IOJ
2025-06-22 18:09:43 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.AUTHENTICATION, Action=Login, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:09:43 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10009, Type=Authentication, Agent=DESKTOP-O304IOJ, Action=Login, Severity=Info, Timestamp=2025-06-22 18:09:33.434023
2025-06-22 18:09:43 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /api/v1/agents/f47fbd44-e250-42c4-b1ec-67bc2f23330f/pending-alerts - Status: 200 - Time: 0.040s - Client: 192.168.20.133
2025-06-22 18:09:43 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.040s - Client: 192.168.20.133
2025-06-22 18:09:50 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.PROCESS, Action=Start, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:09:50 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10010, Type=Process, Agent=DESKTOP-O304IOJ, Action=Start, Severity=High, Timestamp=2025-06-22 18:08:59.372626
2025-06-22 18:09:50 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10010, Type=Process, Agent=DESKTOP-O304IOJ, Risk=100, Time=0.015s
2025-06-22 18:09:50 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10010, Risk=100, Client=192.168.20.133, Time=0.016s
2025-06-22 18:09:50 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:09:50 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.028s - Client: 192.168.20.133
2025-06-22 18:09:58 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.NETWORK, Action=Create, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:09:58 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10011, Type=Network, Agent=DESKTOP-O304IOJ, Action=Create, Severity=Info, Timestamp=2025-06-22 18:09:33.405635
2025-06-22 18:09:58 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10011, Type=Network, Agent=DESKTOP-O304IOJ, Risk=90, Time=0.011s
2025-06-22 18:09:58 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10011, Risk=90, Client=192.168.20.133, Time=0.012s
2025-06-22 18:09:58 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:09:58 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.023s - Client: 192.168.20.133
2025-06-22 18:10:18 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.PROCESS, Action=Start, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:10:18 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10012, Type=Process, Agent=DESKTOP-O304IOJ, Action=Start, Severity=High, Timestamp=2025-06-22 18:08:59.377826
2025-06-22 18:10:18 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10012, Type=Process, Agent=DESKTOP-O304IOJ, Risk=100, Time=0.019s
2025-06-22 18:10:18 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10012, Risk=100, Client=192.168.20.133, Time=0.020s
2025-06-22 18:10:18 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:10:18 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.034s - Client: 192.168.20.133
2025-06-22 18:10:35 - agent_communication - INFO - get_pending_alerts:124 - ğŸ“‹ Retrieved 0 pending alerts for agent DESKTOP-O304IOJ
2025-06-22 18:10:35 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.AUTHENTICATION, Action=Login, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:10:35 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10013, Type=Authentication, Agent=DESKTOP-O304IOJ, Action=Login, Severity=Info, Timestamp=2025-06-22 18:10:17.641018
2025-06-22 18:10:35 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /api/v1/agents/f47fbd44-e250-42c4-b1ec-67bc2f23330f/pending-alerts - Status: 200 - Time: 0.030s - Client: 192.168.20.133
2025-06-22 18:10:35 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.030s - Client: 192.168.20.133
2025-06-22 18:10:42 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.PROCESS, Action=Start, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:10:42 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10014, Type=Process, Agent=DESKTOP-O304IOJ, Action=Start, Severity=High, Timestamp=2025-06-22 18:08:59.389490
2025-06-22 18:10:42 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10014, Type=Process, Agent=DESKTOP-O304IOJ, Risk=100, Time=0.010s
2025-06-22 18:10:42 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10014, Risk=100, Client=192.168.20.133, Time=0.011s
2025-06-22 18:10:42 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:10:42 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.020s - Client: 192.168.20.133
2025-06-22 18:10:51 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.NETWORK, Action=Create, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:10:51 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10015, Type=Network, Agent=DESKTOP-O304IOJ, Action=Create, Severity=Info, Timestamp=2025-06-22 18:09:33.406411
2025-06-22 18:10:51 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10015, Type=Network, Agent=DESKTOP-O304IOJ, Risk=90, Time=0.016s
2025-06-22 18:10:51 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10015, Risk=90, Client=192.168.20.133, Time=0.018s
2025-06-22 18:10:51 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:10:51 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.032s - Client: 192.168.20.133
2025-06-22 18:31:08 - app.main - INFO - lifespan:53 - ğŸ‘‹ Shutting down EDR Agent Communication Server...
2025-06-22 18:31:33 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 18:31:33 - app.database - INFO - init_database:447 - ğŸ”— Initializing database connection with ANSI_WARNINGS fix...
2025-06-22 18:31:33 - app.database - INFO - test_connection_realtime:349 - âœ… REALTIME DB connected: Manh / EDR_System (1.0ms) ANSI_WARNINGS: ON
2025-06-22 18:31:33 - app.database - INFO - init_database:466 - âœ… Database initialized with ANSI fix: 7 tables found
2025-06-22 18:31:33 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 18:31:33 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 18:31:33 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 18:31:33 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 18:31:33 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 18:31:54 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.047s - Client: 192.168.20.133
2025-06-22 18:31:57 - agent_communication - INFO - _update_existing_agent:148 - Existing agent updated: DESKTOP-O304IOJ (192.168.20.133)
2025-06-22 18:31:57 - agent_communication - INFO - register_agent:53 - Agent registered successfully: DESKTOP-O304IOJ from 192.168.20.133
2025-06-22 18:31:57 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/register - Status: 200 - Time: 0.045s - Client: 192.168.20.133
2025-06-22 18:31:57 - agent_communication - INFO - get_pending_alerts:124 - ğŸ“‹ Retrieved 0 pending alerts for agent DESKTOP-O304IOJ
2025-06-22 18:31:57 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /api/v1/agents/f47fbd44-e250-42c4-b1ec-67bc2f23330f/pending-alerts - Status: 200 - Time: 0.018s - Client: 192.168.20.133
2025-06-22 18:31:57 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.PROCESS, Action=Start, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:31:57 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10016, Type=Process, Agent=DESKTOP-O304IOJ, Action=Start, Severity=High, Timestamp=2025-06-22 18:31:58.039595
2025-06-22 18:31:57 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10016, Type=Process, Agent=DESKTOP-O304IOJ, Risk=100, Time=0.024s
2025-06-22 18:31:57 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10016, Risk=100, Client=192.168.20.133, Time=0.025s
2025-06-22 18:31:57 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:31:57 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.048s - Client: 192.168.20.133
2025-06-22 18:32:38 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/heartbeat - Status: 200 - Time: 0.021s - Client: 192.168.20.133
2025-06-22 18:33:19 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.PROCESS, Action=Start, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:33:19 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10017, Type=Process, Agent=DESKTOP-O304IOJ, Action=Start, Severity=High, Timestamp=2025-06-22 18:31:58.053914
2025-06-22 18:33:19 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10017, Type=Process, Agent=DESKTOP-O304IOJ, Risk=100, Time=0.019s
2025-06-22 18:33:19 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10017, Risk=100, Client=192.168.20.133, Time=0.020s
2025-06-22 18:33:19 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:33:19 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.043s - Client: 192.168.20.133
2025-06-22 18:33:55 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/heartbeat - Status: 200 - Time: 0.087s - Client: 192.168.20.133
2025-06-22 18:34:04 - agent_communication - INFO - get_pending_alerts:124 - ğŸ“‹ Retrieved 0 pending alerts for agent DESKTOP-O304IOJ
2025-06-22 18:34:04 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /api/v1/agents/f47fbd44-e250-42c4-b1ec-67bc2f23330f/pending-alerts - Status: 200 - Time: 0.020s - Client: 192.168.20.133
2025-06-22 18:34:44 - app.main - INFO - lifespan:53 - ğŸ‘‹ Shutting down EDR Agent Communication Server...
2025-06-22 18:39:05 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 18:39:05 - app.database - INFO - init_database:447 - ğŸ”— Initializing database connection with ANSI_WARNINGS fix...
2025-06-22 18:39:05 - app.database - INFO - test_connection_realtime:349 - âœ… REALTIME DB connected: Manh / EDR_System (1.1ms) ANSI_WARNINGS: ON
2025-06-22 18:39:05 - app.database - INFO - init_database:466 - âœ… Database initialized with ANSI fix: 7 tables found
2025-06-22 18:39:05 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 18:39:05 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 18:39:05 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 18:39:05 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 18:39:05 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 18:43:04 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.067s - Client: 192.168.20.133
2025-06-22 18:43:06 - agent_communication - INFO - _update_existing_agent:148 - Existing agent updated: DESKTOP-O304IOJ (192.168.20.133)
2025-06-22 18:43:06 - agent_communication - INFO - register_agent:53 - Agent registered successfully: DESKTOP-O304IOJ from 192.168.20.133
2025-06-22 18:43:06 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/register - Status: 200 - Time: 0.057s - Client: 192.168.20.133
2025-06-22 18:43:06 - agent_communication - INFO - get_pending_alerts:124 - ğŸ“‹ Retrieved 0 pending alerts for agent DESKTOP-O304IOJ
2025-06-22 18:43:06 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /api/v1/agents/f47fbd44-e250-42c4-b1ec-67bc2f23330f/pending-alerts - Status: 200 - Time: 0.021s - Client: 192.168.20.133
2025-06-22 18:43:07 - event_processing - INFO - submit_event:57 - ğŸ“¥ EVENT RECEIVED: Type=EventType.PROCESS, Action=Start, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 18:43:07 - event_processing - INFO - submit_event:98 - ğŸ’¾ DATABASE INSERT: Event ID=10018, Type=Process, Agent=DESKTOP-O304IOJ, Action=Start, Severity=High, Timestamp=2025-06-22 18:43:07.032284
2025-06-22 18:43:07 - event_processing - WARNING - submit_event:153 - ğŸš¨ HIGH RISK Event stored: ID=10018, Type=Process, Agent=DESKTOP-O304IOJ, Risk=100, Time=0.036s
2025-06-22 18:43:07 - event_processing - WARNING - submit_event:77 - ğŸš¨ THREAT EVENT STORED: ID=10018, Risk=100, Client=192.168.20.133, Time=0.038s
2025-06-22 18:43:07 - event_processing - INFO - _send_notifications_async:613 - ğŸ“¤ Sent 1 notifications to DESKTOP-O304IOJ
2025-06-22 18:43:07 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.076s - Client: 192.168.20.133
2025-06-22 22:39:13 - app.main - INFO - lifespan:30 - ğŸš€ Starting EDR Agent Communication Server...
2025-06-22 22:39:13 - app.database - INFO - init_database:447 - ğŸ”— Initializing database connection with ANSI_WARNINGS fix...
2025-06-22 22:39:13 - app.database - INFO - test_connection_realtime:349 - âœ… REALTIME DB connected: Manh / EDR_System (5.3ms) ANSI_WARNINGS: ON
2025-06-22 22:39:13 - app.database - INFO - init_database:466 - âœ… Database initialized with ANSI fix: 7 tables found
2025-06-22 22:39:13 - app.main - INFO - lifespan:37 - âœ… Database initialized successfully
2025-06-22 22:39:13 - app.main - INFO - lifespan:41 - ğŸŒ Server binding to: 192.168.20.85:5000
2025-06-22 22:39:13 - app.main - INFO - lifespan:42 - ğŸ”’ Network access: 192.168.20.0/24
2025-06-22 22:39:13 - app.main - INFO - lifespan:43 - ğŸ›¡ï¸ Detection engine: Enabled
2025-06-22 22:39:13 - app.main - INFO - lifespan:44 - ğŸ“Š Threat intelligence: Enabled
2025-06-22 22:40:48 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /health - Status: 200 - Time: 0.043s - Client: 192.168.20.133
2025-06-22 22:40:50 - agent_communication - INFO - _update_existing_agent:148 - Existing agent updated: DESKTOP-O304IOJ (192.168.20.133)
2025-06-22 22:40:50 - agent_communication - INFO - register_agent:53 - Agent registered successfully: DESKTOP-O304IOJ from 192.168.20.133
2025-06-22 22:40:50 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/agents/register - Status: 200 - Time: 0.081s - Client: 192.168.20.133
2025-06-22 22:40:50 - agent_communication - INFO - get_pending_alerts:124 - ğŸ“‹ Retrieved 0 pending alerts for agent DESKTOP-O304IOJ
2025-06-22 22:40:50 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ GET /api/v1/agents/f47fbd44-e250-42c4-b1ec-67bc2f23330f/pending-alerts - Status: 200 - Time: 0.036s - Client: 192.168.20.133
2025-06-22 22:40:50 - event_processing - INFO - submit_event:60 - ğŸ“¥ EVENT RECEIVED: Type=EventType.PROCESS, Action=Start, Agent=f47fbd44-e250-42c4-b1ec-67bc2f23330f, Client=192.168.20.133
2025-06-22 22:40:50 - event_processing - INFO - submit_event:118 - ğŸ’¾ DATABASE INSERT SUCCESS:
2025-06-22 22:40:50 - event_processing - INFO - submit_event:119 -    Event ID: 20002
2025-06-22 22:40:50 - event_processing - INFO - submit_event:120 -    Type: Process
2025-06-22 22:40:50 - event_processing - INFO - submit_event:121 -    Action: Start
2025-06-22 22:40:50 - event_processing - INFO - submit_event:122 -    Agent: DESKTOP-O304IOJ (f47fbd44-e250-42c4-b1ec-67bc2f23330f)
2025-06-22 22:40:50 - event_processing - INFO - submit_event:123 -    Severity: High
2025-06-22 22:40:50 - event_processing - INFO - submit_event:124 -    Timestamp: 2025-06-22 22:40:51.051069
2025-06-22 22:40:50 - event_processing - INFO - submit_event:125 -    Client IP: 192.168.20.133
2025-06-22 22:40:50 - event_processing - INFO - submit_event:129 -    Process: cmd.exe (PID: 7524)
2025-06-22 22:40:50 - event_processing - INFO - submit_event:193 - âœ… EVENT COMMITTED: ID=20002
2025-06-22 22:40:50 - event_processing - WARNING - submit_event:207 - ğŸš¨ HIGH RISK Event stored successfully:
2025-06-22 22:40:50 - event_processing - WARNING - submit_event:208 -    ID=20002, Type=Process
2025-06-22 22:40:50 - event_processing - WARNING - submit_event:209 -    Agent=DESKTOP-O304IOJ, Risk=100
2025-06-22 22:40:50 - event_processing - WARNING - submit_event:210 -    Processing time: 0.060s
2025-06-22 22:40:50 - event_processing - WARNING - submit_event:80 - ğŸš¨ THREAT EVENT STORED: ID=20002, Risk=100, Client=192.168.20.133, Time=0.064s
2025-06-22 22:40:51 - event_processing - INFO - _send_notifications_async:698 - ğŸ”” Notification disabled: Process: cmd.exe
2025-06-22 22:40:51 - app.main - INFO - security_and_logging_middleware:103 - ğŸ“¡ POST /api/v1/events/submit - Status: 200 - Time: 0.093s - Client: 192.168.20.133
