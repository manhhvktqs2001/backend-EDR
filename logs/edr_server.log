2025-06-18 20:33:59 - __main__ - INFO - run_server.py:33 - setup_logging - ‚úÖ Logging configured successfully
2025-06-18 20:33:59 - __main__ - INFO - run_server.py:191 - main - üöÄ EDR Agent Communication Server - Startup Initiated
2025-06-18 20:33:59 - __main__ - INFO - run_server.py:110 - print_edr_banner - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-18 20:33:59 - __main__ - INFO - run_server.py:111 - print_edr_banner - üåê Binding to: 192.168.20.85:5000
2025-06-18 20:33:59 - __main__ - INFO - run_server.py:112 - print_edr_banner - üóÑÔ∏è Database: MANH/EDR_System
2025-06-18 20:33:59 - __main__ - INFO - run_server.py:113 - print_edr_banner - üõ°Ô∏è Detection Engine: Enabled
2025-06-18 20:33:59 - __main__ - INFO - run_server.py:114 - print_edr_banner - üìä Threat Intelligence: Enabled
2025-06-18 20:33:59 - __main__ - INFO - run_server.py:118 - check_environment - üîç Performing environment checks...
2025-06-18 20:33:59 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\logs
2025-06-18 20:33:59 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\static
2025-06-18 20:33:59 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\temp
2025-06-18 20:33:59 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\uploads
2025-06-18 20:33:59 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\exports
2025-06-18 20:33:59 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\data
2025-06-18 20:33:59 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\data\detection_rules
2025-06-18 20:33:59 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\data\threat_intelligence
2025-06-18 20:33:59 - __main__ - INFO - run_server.py:129 - check_environment - üóÑÔ∏è Testing database connection...
2025-06-18 20:33:59 - app.database - INFO - database.py:701 - init_database - üîÑ Initializing EDR database connection...
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [raw sql] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT schema_name()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00038s] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00058s] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00037s] ()
2025-06-18 20:33:59 - app.database - DEBUG - database.py:94 - receive_connect - üîó New database connection established
2025-06-18 20:33:59 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1 as test, GETDATE() as server_time
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00054s] ()
2025-06-18 20:33:59 - app.database - INFO - database.py:139 - test_connection - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-18 20:33:59 - app.database - DEBUG - database.py:140 - test_connection - üïê Server time: 2025-06-18 20:33:59.923000
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2701 - _connection_rollback_impl - ROLLBACK
2025-06-18 20:33:59 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:33:59 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00027s] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    @@VERSION as version,
                    DB_NAME() as database_name,
                    @@SERVERNAME as server_name,
                    GETDATE() as current_datetime,
                    @@SPID as session_id,
                    HOST_NAME() as host_name,
                    SUSER_NAME() as user_name
            
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00044s] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:33:59 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:33:59 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:33:59 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:33:59 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.004187s ago] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00033s] ('Agents', 'dbo')
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:33:59 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:33:59 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:33:59 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:33:59 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.02076s ago] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00061s] ('Agents', 'dbo')
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:33:59 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:33:59 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:33:59 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:33:59 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05697s ago] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00029s] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:33:59 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:33:59 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:33:59 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:33:59 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06274s ago] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05855s ago] ('Events', 'dbo')
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:33:59 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:33:59 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:33:59 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:33:59 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06554s ago] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.04481s ago] ('Events', 'dbo')
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:33:59 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:33:59 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:33:59 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:33:59 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07111s ago] ()
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-18 20:33:59 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00025s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07839s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07434s ago] ('Alerts', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08157s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06088s ago] ('Alerts', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08701s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00051s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09346s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08958s ago] ('Threats', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1078s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08719s ago] ('Threats', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1333s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00026s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1377s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1337s ago] ('DetectionRules', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1494s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1287s ago] ('DetectionRules', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1798s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00036s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.186s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1827s ago] ('SystemConfig', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1796s ago] ('SystemConfig', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2363s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00027s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2415s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2376s ago] ('AgentConfigs', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2448s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2243s ago] ('AgentConfigs', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2505s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00026s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2542s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                    SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                FROM sys.database_files 
                WHERE type_desc = 'ROWS'
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00039s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2675s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COUNT(*) as total_connections,
                    SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) as active_connections
                FROM sys.dm_exec_sessions 
                WHERE is_user_process = 1
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00034s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:714 - init_database - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-18 20:34:00 - app.database - INFO - database.py:715 - init_database - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2762s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2722s ago] ('Agents', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2798s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.276s ago] ('Events', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2835s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2798s ago] ('Alerts', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2877s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.284s ago] ('Threats', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2919s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.288s ago] ('DetectionRules', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2954s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2913s ago] ('SystemConfig', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2983s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2941s ago] ('AgentConfigs', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:734 - init_database - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3017s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2447s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:740 - init_database - üìä Agents: 0 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3047s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2339s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:740 - init_database - üìä Events: 0 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3082s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.221s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:740 - init_database - üìä Alerts: 0 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3115s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1784s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:740 - init_database - üìä Threats: 12 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3145s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1345s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:740 - init_database - üìä DetectionRules: 7 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3173s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08096s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:740 - init_database - üìä SystemConfig: 10 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3201s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06973s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:740 - init_database - üìä AgentConfigs: 0 records
2025-06-18 20:34:00 - app.database - INFO - database.py:744 - init_database - üìà Total EDR records: 29
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3239s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08788s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:753 - init_database - üèä Connection pool: 10 connections, 0.0% utilized
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:134 - check_environment - ‚úÖ Database connection successful
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:140 - check_environment - üéØ Checking feature configuration...
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:142 - check_environment - ‚úÖ 4 features enabled: agent_registration, event_collection, real_time_detection, threat_intelligence
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:144 - check_environment - ‚úÖ Environment check completed successfully
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:152 - get_database_info - üìä Retrieving database information...
2025-06-18 20:34:00 - app.database - DEBUG - database.py:431 - health_check - üîç Testing database connection...
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1 as test, GETDATE() as server_time
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3324s ago] ()
2025-06-18 20:34:00 - app.database - INFO - database.py:139 - test_connection - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-18 20:34:00 - app.database - DEBUG - database.py:140 - test_connection - üïê Server time: 2025-06-18 20:34:00.253000
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2701 - _connection_rollback_impl - ROLLBACK
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:437 - health_check - üîç Checking connection pool...
2025-06-18 20:34:00 - app.database - DEBUG - database.py:446 - health_check - üîç Retrieving database information...
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3309s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    @@VERSION as version,
                    DB_NAME() as database_name,
                    @@SERVERNAME as server_name,
                    GETDATE() as current_datetime,
                    @@SPID as session_id,
                    HOST_NAME() as host_name,
                    SUSER_NAME() as user_name
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3309s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3341s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.33s ago] ('Agents', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3372s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3166s ago] ('Agents', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3421s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2854s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3456s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3415s ago] ('Events', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3492s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3287s ago] ('Events', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.354s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2832s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.358s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3539s ago] ('Alerts', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3612s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3406s ago] ('Alerts', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3656s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2783s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3682s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3642s ago] ('Threats', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3715s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3509s ago] ('Threats', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.376s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.243s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3786s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3745s ago] ('DetectionRules', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3819s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3612s ago] ('DetectionRules', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3858s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2059s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3887s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3851s ago] ('SystemConfig', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3927s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3721s ago] ('SystemConfig', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3968s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1606s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3995s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3954s ago] ('AgentConfigs', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4025s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3818s ago] ('AgentConfigs', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4067s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1563s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4093s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                    SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                FROM sys.database_files 
                WHERE type_desc = 'ROWS'
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1554s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4126s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COUNT(*) as total_connections,
                    SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) as active_connections
                FROM sys.dm_exec_sessions 
                WHERE is_user_process = 1
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1454s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:451 - health_check - üîç Checking EDR tables...
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4156s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4116s ago] ('Agents', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4188s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3617s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:459 - health_check - üìä Table Agents: 0 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4217s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4178s ago] ('Events', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4249s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3539s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:459 - health_check - üìä Table Events: 0 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4276s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4235s ago] ('Alerts', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4306s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3433s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:459 - health_check - üìä Table Alerts: 0 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4331s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4289s ago] ('Threats', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.436s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3029s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:459 - health_check - üìä Table Threats: 12 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4395s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4356s ago] ('DetectionRules', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.443s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2637s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:459 - health_check - üìä Table DetectionRules: 7 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4468s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4427s ago] ('SystemConfig', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.45s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2143s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:459 - health_check - üìä Table SystemConfig: 10 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4541s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4504s ago] ('AgentConfigs', 'dbo')
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4586s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2082s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:459 - health_check - üìä Table AgentConfigs: 0 records
2025-06-18 20:34:00 - app.database - DEBUG - database.py:468 - health_check - üîç Checking EDR system health...
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.462s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Agents 
                WHERE LastHeartbeat >= DATEADD(minute, -10, GETDATE())
                AND Status = 'Active'
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00026s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4672s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Events 
                WHERE CreatedAt >= DATEADD(hour, -1, GETDATE())
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00026s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4711s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Alerts 
                WHERE Status IN ('Open', 'Investigating')
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00035s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4754s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Alerts 
                WHERE Status IN ('Open', 'Investigating')
                AND Severity IN ('High', 'Critical')
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00034s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4817s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM DetectionRules 
                WHERE IsActive = 1
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4891s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Threats 
                WHERE IsActive = 1
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4965s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Events 
                WHERE Analyzed = 0
                AND CreatedAt >= DATEADD(hour, -24, GETDATE())
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00028s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:473 - health_check - üîç Collecting performance metrics...
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5015s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    (SELECT COUNT(*) FROM sys.dm_exec_requests WHERE status = 'running') as active_queries,
                    (SELECT COUNT(*) FROM sys.dm_exec_requests WHERE status = 'suspended') as blocked_queries,
                    (SELECT COUNT(*) FROM sys.dm_tran_locks) as total_locks
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00026s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5582s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    (total_physical_memory_kb / 1024) as total_memory_mb,
                    (available_physical_memory_kb / 1024) as available_memory_mb
                FROM sys.dm_os_sys_memory
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.573s ago] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT TOP 5
                    wait_type,
                    waiting_tasks_count,
                    wait_time_ms
                FROM sys.dm_os_wait_stats
                WHERE wait_type NOT LIKE '%SLEEP%'
                AND wait_type NOT LIKE '%IDLE%'
                ORDER BY wait_time_ms DESC
            
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-18 20:34:00 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:00 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:00 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:00 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:00 - app.database - INFO - database.py:485 - health_check - ‚úÖ Database health check passed in 256ms
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:157 - get_database_info - ‚úÖ Database connected: EDR_System on Manh
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:158 - get_database_info - ‚è±Ô∏è Response time: 256ms
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:166 - get_database_info - üìä Agents: 0 records
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:166 - get_database_info - üìä Events: 0 records
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:166 - get_database_info - üìä Alerts: 0 records
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:166 - get_database_info - üìä Threats: 12 records
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:166 - get_database_info - üìä DetectionRules: 7 records
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:166 - get_database_info - üìä SystemConfig: 10 records
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:166 - get_database_info - üìä AgentConfigs: 0 records
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:171 - get_database_info - üîÑ Active agents (last 10min): 0
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:172 - get_database_info - üìà Events (last hour): 0
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:173 - get_database_info - üö® Open alerts: 0
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:174 - get_database_info - üõ°Ô∏è Active detection rules: 7
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:175 - get_database_info - üîç Active threat indicators: 12
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:208 - main - üéØ Final startup preparations...
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:209 - main - üåê Server will bind to: 192.168.20.85:5000
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:210 - main - üîÑ Reload mode: Enabled
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:211 - main - üêõ Debug mode: Enabled
2025-06-18 20:34:00 - __main__ - INFO - run_server.py:214 - main - üöÄ Starting EDR Agent Communication Server...
2025-06-18 20:34:02 - app.main - INFO - main.py:31 - lifespan - üöÄ Starting EDR Agent Communication Server...
2025-06-18 20:34:02 - app.database - INFO - database.py:701 - init_database - üîÑ Initializing EDR database connection...
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [raw sql] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT schema_name()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00025s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00030s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00025s] ()
2025-06-18 20:34:02 - app.database - DEBUG - database.py:94 - receive_connect - üîó New database connection established
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1 as test, GETDATE() as server_time
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00040s] ()
2025-06-18 20:34:02 - app.database - INFO - database.py:139 - test_connection - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-18 20:34:02 - app.database - DEBUG - database.py:140 - test_connection - üïê Server time: 2025-06-18 20:34:02.807000
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2701 - _connection_rollback_impl - ROLLBACK
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00040s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    @@VERSION as version,
                    DB_NAME() as database_name,
                    @@SERVERNAME as server_name,
                    GETDATE() as current_datetime,
                    @@SPID as session_id,
                    HOST_NAME() as host_name,
                    SUSER_NAME() as user_name
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00050s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.00414s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00031s] ('Agents', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.008318s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00052s] ('Agents', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.01263s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00022s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.01537s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.01139s ago] ('Events', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.01833s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.01037s ago] ('Events', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.02251s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.02577s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.02183s ago] ('Alerts', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.02912s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.02116s ago] ('Alerts', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.03308s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00024s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.03601s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.03198s ago] ('Threats', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.03904s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.03091s ago] ('Threats', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.0429s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00034s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.04616s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.04218s ago] ('DetectionRules', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.0493s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.04115s ago] ('DetectionRules', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05263s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00023s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05533s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05119s ago] ('SystemConfig', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05811s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05015s ago] ('SystemConfig', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06215s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00025s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06541s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06158s ago] ('AgentConfigs', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06887s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06089s ago] ('AgentConfigs', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07247s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00035s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.0759s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                    SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                FROM sys.database_files 
                WHERE type_desc = 'ROWS'
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00052s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07984s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COUNT(*) as total_connections,
                    SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) as active_connections
                FROM sys.dm_exec_sessions 
                WHERE is_user_process = 1
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - INFO - database.py:714 - init_database - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-18 20:34:02 - app.database - INFO - database.py:715 - init_database - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08291s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07893s ago] ('Agents', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.086s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.082s ago] ('Events', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08925s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.0853s ago] ('Alerts', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09277s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08904s ago] ('Threats', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09635s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09226s ago] ('DetectionRules', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09942s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09537s ago] ('SystemConfig', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1026s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09911s ago] ('AgentConfigs', 'dbo')
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - INFO - database.py:734 - init_database - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1063s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09397s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - INFO - database.py:740 - init_database - üìä Agents: 0 records
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1095s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08751s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - INFO - database.py:740 - init_database - üìä Events: 0 records
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1127s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07977s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - INFO - database.py:740 - init_database - üìä Alerts: 0 records
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1154s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07241s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - INFO - database.py:740 - init_database - üìä Threats: 12 records
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1182s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06572s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - INFO - database.py:740 - init_database - üìä DetectionRules: 7 records
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1207s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05868s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - INFO - database.py:740 - init_database - üìä SystemConfig: 10 records
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1239s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05174s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - INFO - database.py:740 - init_database - üìä AgentConfigs: 0 records
2025-06-18 20:34:02 - app.database - INFO - database.py:744 - init_database - üìà Total EDR records: 29
2025-06-18 20:34:02 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1275s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06563s ago] ()
2025-06-18 20:34:02 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-18 20:34:02 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-18 20:34:02 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-18 20:34:02 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-18 20:34:02 - app.database - INFO - database.py:753 - init_database - üèä Connection pool: 10 connections, 0.0% utilized
2025-06-18 20:34:02 - app.main - INFO - main.py:38 - lifespan - ‚úÖ Database initialized successfully
2025-06-18 20:34:02 - app.main - INFO - main.py:42 - lifespan - üåê Server binding to: 192.168.20.85:5000
2025-06-18 20:34:02 - app.main - INFO - main.py:43 - lifespan - üîí Network access: 192.168.20.0/24
2025-06-18 20:34:02 - app.main - INFO - main.py:44 - lifespan - üõ°Ô∏è Detection engine: Enabled
2025-06-18 20:34:02 - app.main - INFO - main.py:45 - lifespan - üìä Threat intelligence: Enabled
2025-06-19 03:15:19 - __main__ - INFO - run_server.py:33 - setup_logging - ‚úÖ Logging configured successfully
2025-06-19 03:15:19 - __main__ - INFO - run_server.py:191 - main - üöÄ EDR Agent Communication Server - Startup Initiated
2025-06-19 03:15:19 - __main__ - INFO - run_server.py:110 - print_edr_banner - üõ°Ô∏è EDR Agent Communication Server Starting Up
2025-06-19 03:15:19 - __main__ - INFO - run_server.py:111 - print_edr_banner - üåê Binding to: 192.168.20.85:5000
2025-06-19 03:15:19 - __main__ - INFO - run_server.py:112 - print_edr_banner - üóÑÔ∏è Database: MANH/EDR_System
2025-06-19 03:15:19 - __main__ - INFO - run_server.py:113 - print_edr_banner - üõ°Ô∏è Detection Engine: Enabled
2025-06-19 03:15:19 - __main__ - INFO - run_server.py:114 - print_edr_banner - üìä Threat Intelligence: Enabled
2025-06-19 03:15:19 - __main__ - INFO - run_server.py:118 - check_environment - üîç Performing environment checks...
2025-06-19 03:15:19 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\logs
2025-06-19 03:15:19 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\static
2025-06-19 03:15:19 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\temp
2025-06-19 03:15:19 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\uploads
2025-06-19 03:15:19 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\exports
2025-06-19 03:15:19 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\data
2025-06-19 03:15:19 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\data\detection_rules
2025-06-19 03:15:19 - __main__ - DEBUG - run_server.py:126 - check_environment - üìÅ Directory exists: C:\Users\manhh\Desktop\EDR_Project\backend\data\threat_intelligence
2025-06-19 03:15:19 - __main__ - INFO - run_server.py:129 - check_environment - üóÑÔ∏è Testing database connection...
2025-06-19 03:15:19 - app.database - INFO - database.py:701 - init_database - üîÑ Initializing EDR database connection...
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [raw sql] ()
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT schema_name()
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00035s] ()
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00112s] ()
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00035s] ()
2025-06-19 03:15:19 - app.database - DEBUG - database.py:94 - receive_connect - üîó New database connection established
2025-06-19 03:15:19 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1 as test, GETDATE() as server_time
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00054s] ()
2025-06-19 03:15:19 - app.database - INFO - database.py:139 - test_connection - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 03:15:19 - app.database - DEBUG - database.py:140 - test_connection - üïê Server time: 2025-06-19 03:15:19.983000
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:2701 - _connection_rollback_impl - ROLLBACK
2025-06-19 03:15:19 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:19 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00036s] ()
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    @@VERSION as version,
                    DB_NAME() as database_name,
                    @@SERVERNAME as server_name,
                    GETDATE() as current_datetime,
                    @@SPID as session_id,
                    HOST_NAME() as host_name,
                    SUSER_NAME() as user_name
            
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00052s] ()
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:19 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:19 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:19 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:19 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.004782s ago] ()
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:19 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00043s] ('Agents', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.02309s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00081s] ('Agents', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06556s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00030s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07036s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06587s ago] ('Events', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.0746s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05155s ago] ('Events', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08099s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00042s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08862s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08436s ago] ('Alerts', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09316s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.0701s ago] ('Alerts', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09888s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00028s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1039s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09922s ago] ('Threats', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1171s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09386s ago] ('Threats', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1456s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00027s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1495s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1448s ago] ('DetectionRules', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1616s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1386s ago] ('DetectionRules', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1898s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00029s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1948s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1904s ago] ('SystemConfig', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2081s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1853s ago] ('SystemConfig', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2345s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00026s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2384s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2342s ago] ('AgentConfigs', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2424s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2192s ago] ('AgentConfigs', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2464s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00031s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.251s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                    SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                FROM sys.database_files 
                WHERE type_desc = 'ROWS'
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2615s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COUNT(*) as total_connections,
                    SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) as active_connections
                FROM sys.dm_exec_sessions 
                WHERE is_user_process = 1
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00042s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:714 - init_database - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-19 03:15:20 - app.database - INFO - database.py:715 - init_database - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2684s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2636s ago] ('Agents', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2719s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2674s ago] ('Events', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2757s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2708s ago] ('Alerts', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2788s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2739s ago] ('Threats', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2817s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2769s ago] ('DetectionRules', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.285s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2802s ago] ('SystemConfig', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2889s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2847s ago] ('AgentConfigs', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:734 - init_database - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2935s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2281s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:740 - init_database - üìä Agents: 0 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2971s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2163s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:740 - init_database - üìä Events: 0 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3005s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2018s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:740 - init_database - üìä Alerts: 0 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.305s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.16s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:740 - init_database - üìä Threats: 12 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3088s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1192s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:740 - init_database - üìä DetectionRules: 7 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.312s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07766s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:740 - init_database - üìä SystemConfig: 10 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.315s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06872s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:740 - init_database - üìä AgentConfigs: 0 records
2025-06-19 03:15:20 - app.database - INFO - database.py:744 - init_database - üìà Total EDR records: 29
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3182s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08382s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:753 - init_database - üèä Connection pool: 10 connections, 0.0% utilized
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:134 - check_environment - ‚úÖ Database connection successful
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:140 - check_environment - üéØ Checking feature configuration...
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:142 - check_environment - ‚úÖ 4 features enabled: agent_registration, event_collection, real_time_detection, threat_intelligence
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:144 - check_environment - ‚úÖ Environment check completed successfully
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:152 - get_database_info - üìä Retrieving database information...
2025-06-19 03:15:20 - app.database - DEBUG - database.py:431 - health_check - üîç Testing database connection...
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1 as test, GETDATE() as server_time
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3268s ago] ()
2025-06-19 03:15:20 - app.database - INFO - database.py:139 - test_connection - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 03:15:20 - app.database - DEBUG - database.py:140 - test_connection - üïê Server time: 2025-06-19 03:15:20.310000
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2701 - _connection_rollback_impl - ROLLBACK
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:437 - health_check - üîç Checking connection pool...
2025-06-19 03:15:20 - app.database - DEBUG - database.py:446 - health_check - üîç Retrieving database information...
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3252s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    @@VERSION as version,
                    DB_NAME() as database_name,
                    @@SERVERNAME as server_name,
                    GETDATE() as current_datetime,
                    @@SPID as session_id,
                    HOST_NAME() as host_name,
                    SUSER_NAME() as user_name
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3249s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3282s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3233s ago] ('Agents', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3311s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3079s ago] ('Agents', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3356s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2702s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3393s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3347s ago] ('Events', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.343s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3198s ago] ('Events', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3478s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.267s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3511s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3464s ago] ('Alerts', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3545s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3317s ago] ('Alerts', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3595s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2607s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3623s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3575s ago] ('Threats', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3654s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3421s ago] ('Threats', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.369s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2236s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3722s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3675s ago] ('DetectionRules', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3754s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3523s ago] ('DetectionRules', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3803s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1907s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3833s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3786s ago] ('SystemConfig', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3866s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3637s ago] ('SystemConfig', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3913s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1571s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3946s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3898s ago] ('AgentConfigs', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3981s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3749s ago] ('AgentConfigs', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4017s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1555s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4492s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                    SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                FROM sys.database_files 
                WHERE type_desc = 'ROWS'
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1986s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.453s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COUNT(*) as total_connections,
                    SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) as active_connections
                FROM sys.dm_exec_sessions 
                WHERE is_user_process = 1
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1922s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:451 - health_check - üîç Checking EDR tables...
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4659s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4615s ago] ('Agents', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4699s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4047s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:459 - health_check - üìä Table Agents: 0 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4738s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.469s ago] ('Events', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.477s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3961s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:459 - health_check - üìä Table Events: 0 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4799s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4751s ago] ('Alerts', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4828s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3839s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:459 - health_check - üìä Table Alerts: 0 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4857s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4808s ago] ('Threats', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4892s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3439s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:459 - health_check - üìä Table Threats: 12 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4925s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4877s ago] ('DetectionRules', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4956s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.3062s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:459 - health_check - üìä Table DetectionRules: 7 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4987s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.4939s ago] ('SystemConfig', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5018s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2674s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:459 - health_check - üìä Table SystemConfig: 10 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5053s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5006s ago] ('AgentConfigs', 'dbo')
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5085s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.2622s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:459 - health_check - üìä Table AgentConfigs: 0 records
2025-06-19 03:15:20 - app.database - DEBUG - database.py:468 - health_check - üîç Checking EDR system health...
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5119s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Agents 
                WHERE LastHeartbeat >= DATEADD(minute, -10, GETDATE())
                AND Status = 'Active'
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00035s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5166s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Events 
                WHERE CreatedAt >= DATEADD(hour, -1, GETDATE())
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00034s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5209s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Alerts 
                WHERE Status IN ('Open', 'Investigating')
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00043s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5256s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Alerts 
                WHERE Status IN ('Open', 'Investigating')
                AND Severity IN ('High', 'Critical')
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00031s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5319s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM DetectionRules 
                WHERE IsActive = 1
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00034s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5391s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Threats 
                WHERE IsActive = 1
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00033s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5483s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as count 
                FROM Events 
                WHERE Analyzed = 0
                AND CreatedAt >= DATEADD(hour, -24, GETDATE())
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:473 - health_check - üîç Collecting performance metrics...
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.5538s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    (SELECT COUNT(*) FROM sys.dm_exec_requests WHERE status = 'running') as active_queries,
                    (SELECT COUNT(*) FROM sys.dm_exec_requests WHERE status = 'suspended') as blocked_queries,
                    (SELECT COUNT(*) FROM sys.dm_tran_locks) as total_locks
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00040s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.6057s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    (total_physical_memory_kb / 1024) as total_memory_mb,
                    (available_physical_memory_kb / 1024) as available_memory_mb
                FROM sys.dm_os_sys_memory
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00037s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.6177s ago] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT TOP 5
                    wait_type,
                    waiting_tasks_count,
                    wait_time_ms
                FROM sys.dm_os_wait_stats
                WHERE wait_type NOT LIKE '%SLEEP%'
                AND wait_type NOT LIKE '%IDLE%'
                ORDER BY wait_time_ms DESC
            
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00040s] ()
2025-06-19 03:15:20 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:20 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:20 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:20 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:20 - app.database - INFO - database.py:485 - health_check - ‚úÖ Database health check passed in 308ms
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:157 - get_database_info - ‚úÖ Database connected: EDR_System on Manh
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:158 - get_database_info - ‚è±Ô∏è Response time: 308ms
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:166 - get_database_info - üìä Agents: 0 records
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:166 - get_database_info - üìä Events: 0 records
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:166 - get_database_info - üìä Alerts: 0 records
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:166 - get_database_info - üìä Threats: 12 records
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:166 - get_database_info - üìä DetectionRules: 7 records
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:166 - get_database_info - üìä SystemConfig: 10 records
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:166 - get_database_info - üìä AgentConfigs: 0 records
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:171 - get_database_info - üîÑ Active agents (last 10min): 0
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:172 - get_database_info - üìà Events (last hour): 0
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:173 - get_database_info - üö® Open alerts: 0
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:174 - get_database_info - üõ°Ô∏è Active detection rules: 7
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:175 - get_database_info - üîç Active threat indicators: 12
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:208 - main - üéØ Final startup preparations...
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:209 - main - üåê Server will bind to: 192.168.20.85:5000
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:210 - main - üîÑ Reload mode: Enabled
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:211 - main - üêõ Debug mode: Enabled
2025-06-19 03:15:20 - __main__ - INFO - run_server.py:214 - main - üöÄ Starting EDR Agent Communication Server...
2025-06-19 03:15:23 - app.main - INFO - main.py:31 - lifespan - üöÄ Starting EDR Agent Communication Server...
2025-06-19 03:15:23 - app.database - INFO - database.py:701 - init_database - üîÑ Initializing EDR database connection...
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [raw sql] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT schema_name()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00034s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00038s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-19 03:15:23 - app.database - DEBUG - database.py:94 - receive_connect - üîó New database connection established
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1 as test, GETDATE() as server_time
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00055s] ()
2025-06-19 03:15:23 - app.database - INFO - database.py:139 - test_connection - ‚úÖ Database connection test successful (attempt 1/3)
2025-06-19 03:15:23 - app.database - DEBUG - database.py:140 - test_connection - üïê Server time: 2025-06-19 03:15:23.380000
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2701 - _connection_rollback_impl - ROLLBACK
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00033s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    @@VERSION as version,
                    DB_NAME() as database_name,
                    @@SERVERNAME as server_name,
                    GETDATE() as current_datetime,
                    @@SPID as session_id,
                    HOST_NAME() as host_name,
                    SUSER_NAME() as user_name
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00047s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.005103s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00047s] ('Agents', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.01007s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00059s] ('Agents', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.01636s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.02001s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.015s ago] ('Events', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.0236s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.01253s ago] ('Events', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.03025s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00031s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.03426s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.02935s ago] ('Alerts', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.03859s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.02738s ago] ('Alerts', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.04439s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00040s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.04834s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.0435s ago] ('Threats', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.052s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.04082s ago] ('Threats', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05643s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00028s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06086s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05613s ago] ('DetectionRules', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06474s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.05362s ago] ('DetectionRules', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06952s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00033s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07289s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06796s ago] ('SystemConfig', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07708s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.06617s ago] ('SystemConfig', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08207s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00035s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08555s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08057s ago] ('AgentConfigs', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08921s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COLUMN_NAME as column_name,
                    DATA_TYPE as data_type,
                    IS_NULLABLE as is_nullable,
                    COLUMN_DEFAULT as default_value,
                    CHARACTER_MAXIMUM_LENGTH as max_length,
                    NUMERIC_PRECISION as precision,
                    NUMERIC_SCALE as scale,
                    ORDINAL_POSITION as position
                FROM INFORMATION_SCHEMA.COLUMNS
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
                ORDER BY ORDINAL_POSITION
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07826s ago] ('AgentConfigs', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09478s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00032s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09828s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    SUM(CAST(FILEPROPERTY(name, 'SpaceUsed') AS bigint) * 8192.) / 1024 / 1024 as used_space_mb,
                    SUM(CAST(size AS bigint) * 8192.) / 1024 / 1024 as allocated_space_mb
                FROM sys.database_files 
                WHERE type_desc = 'ROWS'
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00039s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1023s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT 
                    COUNT(*) as total_connections,
                    SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) as active_connections
                FROM sys.dm_exec_sessions 
                WHERE is_user_process = 1
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [generated in 0.00055s] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - INFO - database.py:714 - init_database - üóÑÔ∏è Connected to: EDR_System on Manh
2025-06-19 03:15:23 - app.database - INFO - database.py:715 - init_database - üìä SQL Server Version: Microsoft SQL Server 2022 (RTM) - 16.0.1000.6 (X64...
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1077s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1032s ago] ('Agents', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1138s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1092s ago] ('Events', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1187s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1139s ago] ('Alerts', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1238s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.119s ago] ('Threats', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1289s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1243s ago] ('DetectionRules', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.133s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1281s ago] ('SystemConfig', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1373s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - 
                SELECT COUNT(*) as table_count
                FROM INFORMATION_SCHEMA.TABLES 
                WHERE TABLE_NAME = ?
                AND TABLE_SCHEMA = ?
            
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1324s ago] ('AgentConfigs', 'dbo')
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - INFO - database.py:734 - init_database - ‚úÖ All EDR tables verified: ['Agents', 'Events', 'Alerts', 'Threats', 'DetectionRules', 'SystemConfig', 'AgentConfigs']
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1409s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Agents]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1247s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - INFO - database.py:740 - init_database - üìä Agents: 0 records
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1451s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Events]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1151s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - INFO - database.py:740 - init_database - üìä Events: 0 records
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1489s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Alerts]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1043s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - INFO - database.py:740 - init_database - üìä Alerts: 0 records
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1533s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [Threats]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.09722s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - INFO - database.py:740 - init_database - üìä Threats: 12 records
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1568s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [DetectionRules]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.08748s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - INFO - database.py:740 - init_database - üìä DetectionRules: 7 records
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1614s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07965s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - INFO - database.py:740 - init_database - üìä SystemConfig: 10 records
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.165s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [AgentConfigs]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.07026s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - INFO - database.py:740 - init_database - üìä AgentConfigs: 0 records
2025-06-19 03:15:23 - app.database - INFO - database.py:744 - init_database - üìà Total EDR records: 29
2025-06-19 03:15:23 - app.database - DEBUG - database.py:106 - receive_checkout - üì§ Database connection checked out from pool
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2698 - _connection_begin_impl - BEGIN (implicit)
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT 1
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.1688s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - SELECT COUNT(*) as count FROM [SystemConfig]
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:1842 - _execute_context - [cached since 0.087s ago] ()
2025-06-19 03:15:23 - sqlalchemy.engine.Engine - INFO - base.py:2704 - _connection_commit_impl - COMMIT
2025-06-19 03:15:23 - app.database - DEBUG - database.py:110 - receive_checkin - üì• Database connection returned to pool
2025-06-19 03:15:23 - app.database - DEBUG - database.py:175 - get_db_session - ‚úÖ Database session committed successfully
2025-06-19 03:15:23 - app.database - DEBUG - database.py:204 - get_db_session - üîê Database session closed
2025-06-19 03:15:23 - app.database - INFO - database.py:753 - init_database - üèä Connection pool: 10 connections, 0.0% utilized
2025-06-19 03:15:23 - app.main - INFO - main.py:38 - lifespan - ‚úÖ Database initialized successfully
2025-06-19 03:15:23 - app.main - INFO - main.py:42 - lifespan - üåê Server binding to: 192.168.20.85:5000
2025-06-19 03:15:23 - app.main - INFO - main.py:43 - lifespan - üîí Network access: 192.168.20.0/24
2025-06-19 03:15:23 - app.main - INFO - main.py:44 - lifespan - üõ°Ô∏è Detection engine: Enabled
2025-06-19 03:15:23 - app.main - INFO - main.py:45 - lifespan - üìä Threat intelligence: Enabled
